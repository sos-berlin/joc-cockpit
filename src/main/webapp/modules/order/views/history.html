<div class="white box-shadow sub-header">
    <div class="row">
        <div class="col-md-12">
            <div class="padding">
                <div class="text-right ">
                    <div class="pull-left">
                        <span class="text-md text-orange _600 p-t-xs" ncy-breadcrumb></span>
                    </div>
                    <div class="hide" ng-class="{'show-block':historyFilters.type == 'jobChain'}">
                       <div class="btn-group m-l-sm hidden-btn-group">
                            <button ng-disabled="savedHistoryFilter.selected" class="btn btn-grey btn-sm" ng-model="order.filter.historyStates" uib-btn-radio="'all'" ng-click="loadHistory()"
                                    ng-class="{'btn-primary': order.filter.historyStates=='all'}" translate>button.allStatus
                            </button>
                            <button ng-disabled="savedHistoryFilter.selected" class="btn btn-grey btn-sm" ng-model="order.filter.historyStates" uib-btn-radio="'SUCCESSFUL'" ng-click="loadHistory()"
                                    ng-class="{'btn-primary': order.filter.historyStates=='SUCCESSFUL'}" translate>button.successful
                            </button>
                            <button ng-disabled="savedHistoryFilter.selected" class="btn btn-grey btn-sm" ng-model="order.filter.historyStates" uib-btn-radio="'FAILED'" ng-click="loadHistory()"
                                    ng-class="{'btn-primary': order.filter.historyStates=='FAILED'}" translate>button.failed
                            </button>
                            <button ng-disabled="savedHistoryFilter.selected" class="btn btn-grey btn-sm" ng-model="order.filter.historyStates" uib-btn-radio="'INCOMPLETE'" ng-click="loadHistory()"
                                    ng-class="{'btn-primary': order.filter.historyStates=='INCOMPLETE'}" translate>button.incomplete
                            </button>
                        </div>
                        <div class="btn-group dropdown hidden-dropdown">
                            <button class="btn btn-grey btn-sm m-l-sm dropdown-toggle" data-toggle="dropdown" translate>label.state</button>
                            <div class="dropdown-menu dropdown-menu-scale dropdown-ac dropdown-more pull-right">
                                <a class="dropdown-item " ng-model="order.filter.historyStates" uib-btn-radio="'all'"
                                   ng-class="{'btn-primary': order.filter.historyStates=='all', 'disable-link':savedHistoryFilter.selected}" translate>button.allStatus
                                </a>
                                <a class="dropdown-item" ng-model="order.filter.historyStates" uib-btn-radio="'SUCCESSFUL'"
                                   ng-class="{'btn-primary': order.filter.historyStates=='SUCCESSFUL', 'disable-link':savedHistoryFilter.selected}" translate>button.successful
                                </a>
                                <a class="dropdown-item" ng-model="order.filter.historyStates" uib-btn-radio="'FAILED'"
                                   ng-class="{'btn-primary': order.filter.historyStates=='FAILED', 'disable-link':savedHistoryFilter.selected}" translate>button.failed
                                </a>
                                <a class="dropdown-item" ng-model="order.filter.historyStates" uib-btn-radio="'INCOMPLETE'"
                                   ng-class="{'btn-primary': order.filter.historyStates=='INCOMPLETE', 'disable-link':savedHistoryFilter.selected}" translate>button.incomplete
                                </a>
                            </div>
                        </div>
                        <div class="btn-group m-l-sm hidden-btn-group">
                            <button ng-disabled="savedHistoryFilter.selected" class="btn btn-grey btn-sm" ng-model="order.filter.date" uib-btn-radio="'all'" ng-click="loadHistory()"
                                    ng-class="{'btn-primary': order.filter.date=='all'}" translate>button.all
                            </button>
                            <button ng-disabled="savedHistoryFilter.selected" class="btn btn-grey btn-sm" ng-model="order.filter.date" uib-btn-radio="'today'" ng-click="loadHistory()"
                                    ng-class="{'btn-primary': order.filter.date=='today'}" translate>button.today
                            </button>
                            <button ng-disabled="savedHistoryFilter.selected" class="btn btn-grey btn-sm" ng-model="order.filter.date" ng-click="loadHistory()" uib-btn-radio="'-1h'"
                                    ng-class="{'btn-primary': order.filter.date=='-1h'}" translate>button.last1
                            </button>
                            <button ng-disabled="savedHistoryFilter.selected" class="btn btn-grey btn-sm" ng-model="order.filter.date" uib-btn-radio="'-12h'" ng-click="loadHistory()"
                                    ng-class="{'btn-primary': order.filter.date=='-12h'}" translate>button.last12
                            </button>
                            <button ng-disabled="savedHistoryFilter.selected" class="btn btn-grey btn-sm" ng-model="order.filter.date" ng-click="loadHistory()" uib-btn-radio="'-1d'"
                                    ng-class="{'btn-primary': order.filter.date=='-1d'}" translate>button.last24
                            </button>
                             <button ng-disabled="savedHistoryFilter.selected" class="btn btn-grey btn-sm" ng-model="order.filter.date" ng-click="loadHistory()" uib-btn-radio="'-1w'"
                                    ng-class="{'btn-primary': order.filter.date=='-1w'}" translate>button.lastWeak
                            </button>
                        </div>
                        <div class="btn-group dropdown hidden-dropdown">
                            <button class="btn btn-grey btn-sm m-l-sm dropdown-toggle" data-toggle="dropdown" translate>label.anyDate</button>
                            <div class="dropdown-menu dropdown-menu-scale dropdown-ac dropdown-more pull-right">
                                <a class="dropdown-item" ng-model="order.filter.date" uib-btn-radio="'all'" ng-click="loadHistory()"
                                        ng-class="{'btn-primary': order.filter.date=='all', 'disable-link':savedHistoryFilter.selected}" translate>button.all
                                </a>
                                <a class="dropdown-item" ng-model="order.filter.date" ng-click="loadHistory()" uib-btn-radio="'today'"
                                        ng-class="{'btn-primary': order.filter.date=='today', 'disable-link':savedHistoryFilter.selected}" translate>button.today
                                </a>
                                <a class="dropdown-item" ng-model="order.filter.date" ng-click="loadHistory()" uib-btn-radio="'-1h'"
                                        ng-class="{'btn-primary': order.filter.date=='-1h', 'disable-link':savedHistoryFilter.selected}" translate>button.last1
                                </a>
                                <a class="dropdown-item" ng-model="order.filter.date" uib-btn-radio="'-12h'" ng-click="loadHistory()"
                                        ng-class="{'btn-primary': order.filter.date=='-12h', 'disable-link':savedHistoryFilter.selected}" translate>button.last12
                                </a>
                                <a class="dropdown-item" ng-model="order.filter.date" ng-click="loadHistory()" uib-btn-radio="'-1d'"
                                        ng-class="{'btn-primary': order.filter.date=='-1d', 'disable-link':savedHistoryFilter.selected}" translate>button.last24
                                </a>
                                <a class="dropdown-item" ng-model="order.filter.date" ng-click="loadHistory()" uib-btn-radio="'-1w'"
                                        ng-class="{'btn-primary': order.filter.date=='-1w', 'disable-link':savedHistoryFilter.selected}" translate>button.lastWeak
                                </a>
                            </div>
                        </div>
                        <div class="btn-group dropdown m-r-sm">
                            <button class="btn btn-grey btn-sm m-l-sm dropdown-toggle" data-toggle="dropdown">{{'label.filters' | translate}} <span class="text-primary" ng-bind="savedHistoryFilter.selected"></span></button>
                            <div class="dropdown-menu dropdown-ac dropdown-more pull-right">
                                <a class="dropdown-item" href ng-click="advanceFilter()" translate>label.createFilter</a>
                                <a class="dropdown-item" href ng-click="editFilters()" ng-if="savedHistoryFilter.list.length>0" translate>label.editExistingFilters</a>
                                <div class="dropdown-divider" ng-if="savedHistoryFilter.list.length>0"></div>
                                <a class="dropdown-item" ng-class="{orange: savedHistoryFilter.selected == filter.name}" ng-click="changeFilter(filter)" ng-repeat="filter in savedHistoryFilter.list track by $index">
                                    {{filter.name}} <i ng-click="changeFilter();$event.stopPropagation();" ng-if="savedHistoryFilter.selected == filter.name" class="fa fa-times-circle-o remove" uib-tooltip="{{'tooltip.deactivateCustomization' | translate}}" tooltip-placement="right"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hide" ng-class="{'show-block':historyFilters.type == 'job'}">
                        <div class="btn-group m-l-sm hidden-btn-group">
                            <button ng-disabled="savedJobHistoryFilter.selected" class="btn btn-grey btn-sm" ng-model="task.filter.historyStates" uib-btn-radio="'all'" ng-click="loadHistory()"
                                    ng-class="{'btn-primary': task.filter.historyStates=='all'}" translate>button.allStatus
                            </button>
                            <button ng-disabled="savedJobHistoryFilter.selected" class="btn btn-grey btn-sm" ng-model="task.filter.historyStates" uib-btn-radio="'SUCCESSFUL'" ng-click="loadHistory()"
                                    ng-class="{'btn-primary': task.filter.historyStates=='SUCCESSFUL'}" translate>button.successful
                            </button>
                            <button ng-disabled="savedJobHistoryFilter.selected" class="btn btn-grey btn-sm" ng-model="task.filter.historyStates" uib-btn-radio="'FAILED'" ng-click="loadHistory()"
                                    ng-class="{'btn-primary': task.filter.historyStates=='FAILED'}" translate>button.failed
                            </button>
                            <button ng-disabled="savedJobHistoryFilter.selected" class="btn btn-grey btn-sm" ng-model="task.filter.historyStates" uib-btn-radio="'INCOMPLETE'" ng-click="loadHistory()"
                                    ng-class="{'btn-primary': task.filter.historyStates=='INCOMPLETE'}" translate>button.incomplete
                            </button>
                        </div>
                        <div class="btn-group dropdown hidden-dropdown">
                            <button class="btn btn-grey btn-sm m-l-sm dropdown-toggle" data-toggle="dropdown" translate>label.state</button>
                            <div class="dropdown-menu dropdown-menu-scale dropdown-ac dropdown-more pull-right">
                                <a class="dropdown-item " ng-model="task.filter.historyStates" uib-btn-radio="'all'"
                                   ng-class="{'btn-primary': task.filter.historyStates=='all', 'disable-link':savedJobHistoryFilter.selected}" translate>button.allStatus
                                </a>
                                <a class="dropdown-item" ng-model="task.filter.historyStates" uib-btn-radio="'SUCCESSFUL'"
                                   ng-class="{'btn-primary': task.filter.historyStates=='SUCCESSFUL', 'disable-link':savedJobHistoryFilter.selected}" translate>button.successful
                                </a>
                                <a class="dropdown-item" ng-model="task.filter.historyStates" uib-btn-radio="'FAILED'"
                                   ng-class="{'btn-primary': task.filter.historyStates=='FAILED', 'disable-link':savedJobHistoryFilter.selected}" translate>button.failed
                                </a>
                                <a class="dropdown-item" ng-model="task.filter.historyStates" uib-btn-radio="'INCOMPLETE'"
                                   ng-class="{'btn-primary': task.filter.historyStates=='INCOMPLETE', 'disable-link':savedJobHistoryFilter.selected}" translate>button.incomplete
                                </a>
                            </div>
                        </div>
                        <div class="btn-group m-l-sm hidden-btn-group">
                            <button ng-disabled="savedJobHistoryFilter.selected" class="btn btn-grey btn-sm" ng-model="task.filter.date" uib-btn-radio="'all'" ng-click="loadHistory()"
                                    ng-class="{'btn-primary': task.filter.date=='all'}" translate>button.all
                            </button>
                            <button ng-disabled="savedJobHistoryFilter.selected" class="btn btn-grey btn-sm" ng-model="task.filter.date" ng-click="loadHistory()" uib-btn-radio="'today'"
                                    ng-class="{'btn-primary': task.filter.date=='today'}" translate>button.today
                            </button>
                            <button ng-disabled="savedJobHistoryFilter.selected" class="btn btn-grey btn-sm" ng-model="task.filter.date" ng-click="loadHistory()" uib-btn-radio="'-1h'"
                                    ng-class="{'btn-primary': task.filter.date=='-1h'}" translate>button.last1
                            </button>
                            <button ng-disabled="savedJobHistoryFilter.selected" class="btn btn-grey btn-sm" ng-model="task.filter.date" ng-click="loadHistory()" uib-btn-radio="'-12h'"
                                    ng-class="{'btn-primary': task.filter.date=='-12h'}" translate>button.last12
                            </button>
                            <button ng-disabled="savedJobHistoryFilter.selected" class="btn btn-grey btn-sm" ng-model="task.filter.date" ng-click="loadHistory()" uib-btn-radio="'-1d'"
                                    ng-class="{'btn-primary': task.filter.date=='-1d'}" translate>button.last24
                            </button>
                             <button ng-disabled="savedJobHistoryFilter.selected" class="btn btn-grey btn-sm" ng-model="task.filter.date" ng-click="loadHistory()" uib-btn-radio="'-1w'"
                                    ng-class="{'btn-primary': task.filter.date=='-1w'}" translate>button.lastWeak
                            </button>
                        </div>
                        <div class="btn-group dropdown hidden-dropdown">
                            <button class="btn btn-grey btn-sm m-l-sm dropdown-toggle" data-toggle="dropdown" translate>label.anyDate</button>
                            <div class="dropdown-menu dropdown-menu-scale dropdown-ac dropdown-more pull-right">
                                <a class="dropdown-item" ng-model="task.filter.date" uib-btn-radio="'all'" ng-click="loadHistory()"
                                        ng-class="{'btn-primary': task.filter.date=='all', 'disable-link':savedJobHistoryFilter.selected}" translate>button.all
                                </a>
                                <a class="dropdown-item" ng-model="task.filter.date" ng-click="loadHistory()" uib-btn-radio="'today'"
                                   ng-class="{'btn-primary': task.filter.date=='today', 'disable-link':savedJobHistoryFilter.selected}" translate>button.today
                                </a>
                                <a class="dropdown-item" ng-model="task.filter.date" ng-click="loadHistory()" uib-btn-radio="'-1h'"
                                        ng-class="{'btn-primary': task.filter.date=='-1h', 'disable-link':savedJobHistoryFilter.selected}" translate>button.last1
                                </a>
                                <a class="dropdown-item" ng-model="task.filter.date" uib-btn-radio="'-12h'" ng-click="loadHistory()"
                                        ng-class="{'btn-primary': task.filter.date=='-12h', 'disable-link':savedJobHistoryFilter.selected}" translate>button.last12
                                </a>
                                <a class="dropdown-item" ng-model="task.filter.date" ng-click="loadHistory()" uib-btn-radio="'-1d'"
                                        ng-class="{'btn-primary': task.filter.date=='-1d', 'disable-link':savedJobHistoryFilter.selected}" translate>button.last24
                                </a>
                                <a class="dropdown-item" ng-model="task.order.filter.date" ng-click="loadHistory()" uib-btn-radio="'-1w'"
                                        ng-class="{'btn-primary': task.filter.date=='-1w', 'disable-link':savedJobHistoryFilter.selected}" translate>button.lastWeak
                                </a>
                            </div>
                        </div>
                        <div class="btn-group dropdown m-r-sm">
                            <button class="btn btn-grey btn-sm m-l-sm dropdown-toggle" data-toggle="dropdown">{{'label.filters' | translate}} <span class="text-primary" ng-bind="savedJobHistoryFilter.selected"></span></button>
                            <div class="dropdown-menu dropdown-ac dropdown-more pull-right">
                                <a class="dropdown-item" href ng-click="advanceFilter()" translate>label.createFilter</a>
                                <a class="dropdown-item" href ng-click="editFilters()" ng-if="savedJobHistoryFilter.list.length>0" translate>label.editExistingFilters</a>
                                <div class="dropdown-divider" ng-if="savedJobHistoryFilter.list.length>0"></div>
                                <a class="dropdown-item" ng-class="{orange: savedJobHistoryFilter.selected == filter.name}" ng-click="changeFilter(filter)" ng-repeat="filter in savedJobHistoryFilter.list track by $index">
                                    {{filter.name}} <i ng-click="changeFilter();$event.stopPropagation();" ng-if="savedJobHistoryFilter.selected == filter.name" class="fa fa-times-circle-o remove" uib-tooltip="{{'tooltip.deactivateCustomization' | translate}}" tooltip-placement="right"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="btn-group dropdown m-r-sm">
                        <button class="btn btn-grey btn-sm dropdown-toggle" data-toggle="dropdown">{{'label.ignoreList' | translate}} <span class="text-primary" ng-if="savedIgnoreList.isEnable" ng-bind="'label.active' | translate"></span></button>
                        <div class="dropdown-menu dropdown-ac dropdown-more pull-right">
                            <a class="dropdown-item" ng-if="(savedIgnoreList.jobChains.length > 0 || savedIgnoreList.orders.length > 0) && historyFilters.type == 'jobChain'" href ng-click="editIgnoreList()" translate>button.editIgnoreList</a>
                            <a class="dropdown-item" ng-if="savedIgnoreList.jobs.length > 0 && historyFilters.type == 'job'" href ng-click="editIgnoreList()" translate>button.editIgnoreList</a>
                            <a class="dropdown-item" href ng-click="enableDisableIgnoreList()" ng-if="!savedIgnoreList.isEnable" translate>button.enableIgnoreList</a>
                            <a class="dropdown-item" href ng-click="enableDisableIgnoreList()" ng-if="savedIgnoreList.isEnable" translate>button.disableIgnoreList</a>
                            <a class="dropdown-item" href ng-click="resetIgnoreList()" translate>button.resetIgnoreList</a>

                        </div>
                    </div>
                    <button class="btn btn-grey btn-sm " id="exportToExcelBtn" ng-click="exportToExcel()"><img src="images/share.png" class="p-b-xs"> </button>
                </div>
            </div>
        </div>
    </div>
</div>
<div class="scroll-y max-ht">
    <div class="padding p-b-0" >
        <div class="row m-b">
            <div class="col-md-6 col-sm-4">
                <ul class="nav navbar-nav navbar-nav-inline nav-active-border nav-active-border2 b-primary">
                    <li class="nav-item">
                        <a class="nav-link" ng-class="{'active': historyFilters.type=='jobChain'}" ng-model="historyFilters.type"
                           uib-btn-radio="'jobChain'">
                            <span class="nav-text text-dark p-b-sm"><span class="text" translate>button.order</span></span>
                        </a>
                    </li>
                    <li class="nav-item dropdown-separator">
                        <span class="separator"></span>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" ng-class="{'active': historyFilters.type=='job'}" ng-model="historyFilters.type"
                           uib-btn-radio="'job'" ng-click="jobHistory()">
                            <span class="nav-text text-dark p-b-sm"><span class="text" translate>button.task</span></span>
                        </a>
                    </li>
                </ul>
            </div>
            <div class="col-md-6 col-sm-8">
                <div class="btn btn-sm inline pull-right m-l" ng-click="showSearchPanel=true" ng-show="!showSearchPanel">
                    <span translate>button.advancedSearch</span> <i class="fa fa-angle-down p-l-xs"></i>
                </div>
                <div class="btn btn-sm inline pull-right m-l btn-grey" ng-click="cancel()" ng-if="showSearchPanel">
                    <span translate>button.advancedSearch</span> <i class="fa fa-angle-down p-l-xs"></i>
                </div>
                <input type="search" class="pull-right" placeholder="{{'placeholder.search' | translate}}" ng-model="filterString" style="width: 180px">
            </div>
        </div>
        <div class="row m-b hide" ng-class="{'show':showSearchPanel}">

            <div class="col-md-12" ng-show="historyFilters.type == 'jobChain'">
                <div class="box p-a m-b-xs">
                    <form name="form" ng-submit="search()">
                        <div class="form-group row m-t">
                            <label class="col-sm-2 form-control-label" translate>label.from</label>
                            <div class="col-sm-6">
                                <input class="form-control input-date" style="width: 225px;background-position: 200px" ng-model="jobChainSearch.from"
                                       data-date-format="{{dataFormat}}" data-autoclose="1" placeholder="{{'placeholder.setStartDate' | translate}} ({{dataFormat | uppercase}})" data-min-date="{{jobChainSearch.to}}" data-max-date="{{currentTime}}"
                                       bs-datepicker type="text">
                                <input ng-disabled="savedDailyPlanFilter.selected" class="form-control input-time m-l" ng-model="jobChainSearch.fromTime" data-time-format="HH:mm:ss"
                                       data-length="1" data-autoclose="1" placeholder="{{'placeholder.startTime' | translate}} (HH:MM:SS)" bs-timepicker type="text" style="width: 175px;background-position: 150px">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-sm-2 form-control-label" translate>label.to</label>
                            <div class="col-sm-6">
                                <input class="form-control input-date" style="width: 225px;background-position: 200px"
                                       ng-model="jobChainSearch.to" data-date-format="{{dataFormat}}" data-autoclose="1" placeholder="{{'placeholder.setEndDate' | translate}} ({{dataFormat | uppercase}})" data-min-date="{{jobChainSearch.from}}" data-max-date="{{currentTime}}"
                                       bs-datepicker type="text">
                                <input class="form-control input-time m-l" ng-model="jobChainSearch.toTime" data-time-format="HH:mm:ss" data-length="1"
                                       data-autoclose="1" placeholder="{{'placeholder.endTime' | translate}} (HH:MM:SS)" bs-timepicker type="text" style="width: 175px;background-position: 150px">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-sm-2 " translate>label.status</label>

                            <div class="col-sm-9">
                                <label class="md-check w">
                                    <input type="checkbox" data-checklist-model="jobChainSearch.states" data-checklist-value="'INCOMPLETE'">
                                    <i class="primary"></i><span translate>label.incomplete</span>
                                </label>
                                <label class="md-check w">
                                    <input type="checkbox" data-checklist-model="jobChainSearch.states" data-checklist-value="'SUCCESSFUL'">
                                    <i class="primary"></i><span translate>label.successful</span>
                                </label>
                                <label class="md-check w">
                                    <input type="checkbox" data-checklist-model="jobChainSearch.states" data-checklist-value="'FAILED'">
                                    <i class="primary"></i><span translate>label.failed</span>
                                </label>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-sm-2 form-control-label" translate>label.jobChain</label>
                            <div class="col-sm-6">
                                    <input type="text" class="form-control" placeholder="{{'placeholder.enterJobChainPath' | translate}}" ng-model="jobChainSearch.jobChain">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-sm-2 form-control-label" translate>label.orderIds</label>
                            <div class="col-sm-6">
                                 <input type="text" class="form-control" placeholder="{{'placeholder.enterOrderIds' | translate}}" ng-model="jobChainSearch.orderIds">
                            </div>
                        </div>
                        <div class="form-group m-t m-b-xs">
                            <button type="submit" class="btn btn-primary btn-sm" translate>button.search</button>
                            <button type="button" class="btn btn-grey btn-sm m-l-sm" ng-click="cancel()" translate>button.cancel</button>
                        </div>
                    </form>
                </div>
            </div>
            <div class="col-md-12" ng-show="historyFilters.type == 'job'">
                <div class="box p-a m-b-xs">
                    <form name="form" ng-submit="search()">
                        <div class="form-group row m-t">
                            <label class="col-sm-2 form-control-label" translate>label.from</label>
                            <div class="col-sm-6">
                                <input class="form-control input-date" style="width: 225px;background-position: 200px" ng-model="jobSearch.from"
                                       data-date-format="{{dataFormat}}" data-autoclose="1" placeholder="{{'placeholder.setStartDate' | translate}} ({{dataFormat | uppercase}})" data-min-date="{{jobSearch.to}}" data-max-date="{{currentTime}}"
                                       bs-datepicker type="text">
                                <input ng-disabled="savedDailyPlanFilter.selected" class="form-control input-time m-l" ng-model="jobSearch.fromTime" data-time-format="HH:mm:ss"
                                       data-length="1" data-autoclose="1" placeholder="{{'placeholder.startTime' | translate}} (HH:MM:SS)" bs-timepicker type="text" style="width: 175px;background-position: 150px">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-sm-2 form-control-label" translate>label.to</label>
                            <div class="col-sm-6">
                                <input class="form-control input-date" style="width: 225px;background-position: 200px"
                                       ng-model="jobSearch.to" data-date-format="{{dataFormat}}" data-autoclose="1" placeholder="{{'placeholder.setEndDate' | translate}} ({{dataFormat | uppercase}})" data-min-date="{{jobSearch.from}}" data-max-date="{{currentTime}}"
                                       bs-datepicker type="text">
                                <input class="form-control input-time m-l" ng-model="jobSearch.toTime" data-time-format="HH:mm:ss" data-length="1"
                                       data-autoclose="1" placeholder="{{'placeholder.endTime' | translate}} (HH:MM:SS)" bs-timepicker type="text" style="width: 175px;background-position: 150px">
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-sm-2 " translate>label.status</label>

                            <div class="col-sm-9">
                                <label class="md-check w">
                                    <input type="checkbox" data-checklist-model="jobSearch.states" data-checklist-value="'INCOMPLETE'">
                                    <i class="primary"></i><span translate>label.incomplete</span>
                                </label>
                                <label class="md-check w">
                                    <input type="checkbox" data-checklist-model="jobSearch.states" data-checklist-value="'SUCCESSFUL'">
                                    <i class="primary"></i><span translate>label.successful</span>
                                </label>
                                <label class="md-check w">
                                    <input type="checkbox" data-checklist-model="jobSearch.states" data-checklist-value="'FAILED'">
                                    <i class="primary"></i><span translate>label.failed</span>
                                </label>
                            </div>
                        </div>
                        <div class="form-group row">
                            <label class="col-sm-2 form-control-label" translate>label.job</label>
                            <div class="col-sm-6">
                                    <input type="text" class="form-control" placeholder="{{'placeholder.enterJobs' | translate}}" ng-model="jobSearch.job">
                            </div>
                        </div>

                        <div class="form-group m-t m-b-xs">
                            <button type="submit" class="btn btn-primary btn-sm" translate>button.search</button>
                            <button type="button" class="btn btn-grey btn-sm m-l-sm" ng-click="cancel()" translate>button.cancel</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <div class="hide"  ng-class="{'show': isLoading}">
            <div class="m-t-sm box p-a" ng-if="historyFilters.type == 'jobChain'" >
                <div class="table-responsive">
                    <table class="table table-hover table-bordered " id="jobChain" >
                        <thead>
                            <tr>
                                <th ng-click="sortBy('orderId')"><a><span translate>label.orderId</span>
                                    <i ng-show="order.filter.sortBy == 'orderId' && !order.sortReverse"
                                       class="fa fa-caret-up "></i>
                                    <i ng-show="order.filter.sortBy == 'orderId' && order.sortReverse"
                                       class="fa fa-caret-down "></i></a>
                                </th>
                                <th ng-click="sortBy('jobChain')"><a><span translate>label.jobChain</span>
                                    <i ng-show="order.filter.sortBy == 'jobChain' && !order.sortReverse"
                                       class="fa fa-caret-up "></i>
                                    <i ng-show="order.filter.sortBy == 'jobChain' && order.sortReverse"
                                       class="fa fa-caret-down "></i></a>
                                </th>
                                <th ng-click="sortBy('state._text')"><a><span translate>label.status</span>
                                    <i ng-show="order.filter.sortBy == 'state._text' && !order.sortReverse"
                                       class="fa fa-caret-up "></i>
                                    <i ng-show="order.filter.sortBy == 'state._text' && order.sortReverse"
                                       class="fa fa-caret-down "></i></a>
                                </th>
                                <th ng-click="sortBy('startTime')"><a><span translate>label.startTime</span>
                                    <i ng-show="order.filter.sortBy == 'startTime' && !order.sortReverse"
                                       class="fa fa-caret-up "></i>
                                    <i ng-show="order.filter.sortBy == 'startTime' && order.sortReverse"
                                       class="fa fa-caret-down "></i></a>
                                </th>
                                <th ng-click="sortBy('endTime')"><a><span translate>label.endTime</span>
                                    <i ng-show="order.filter.sortBy == 'endTime' && !order.sortReverse"
                                       class="fa fa-caret-up "></i>
                                    <i ng-show="order.filter.sortBy == 'endTime' && order.sortReverse"
                                       class="fa fa-caret-down "></i></a>
                                </th>
                                <th ng-click="sortBy('duration')">
                                    <a><span translate>label.duration</span>
                                    <i ng-show="order.filter.sortBy == 'duration' && !order.sortReverse"
                                       class="fa fa-caret-up "></i>
                                    <i ng-show="order.filter.sortBy == 'duration' && order.sortReverse"
                                       class="fa fa-caret-down "></i></a>
                                </th>
                                <th ng-click="sortBy('node')"><a><span translate>label.endNode</span>
                                    <i ng-show="order.filter.sortBy == 'node' && !order.sortReverse"
                                       class="fa fa-caret-up "></i>
                                    <i ng-show="order.filter.sortBy == 'node' && order.sortReverse"
                                       class="fa fa-caret-down "></i></a>
                                </th>
                                <th class="noExl"></th>
                            </tr>
                        </thead>
                        <tbody ng-repeat="history in filtered = (historys | filter: filterString:strict) | startFrom:(order.currentPage - 1) * order.pageSize | limitTo: order.pageSize | orderBy:order.filter.sortBy:order.sortReverse" ng-class="{'light-bg':showPanel.historyId == history.historyId}">
                        <tr  class="cursor">
                            <td class="nowrap" ng-click="showLogWindow(history,null)">
                                <i class="cursor fa fa-caret-down fa-lg noExl" ng-if="showPanel.historyId != history.historyId" ng-click="showPanelFuc(history);$event.stopPropagation()"></i>
                                <i class="cursor fa fa-caret-up fa-lg noExl" ng-if="hidePanel && showPanel.historyId == history.historyId" ng-click="hidePanelFuc();$event.stopPropagation()"></i>
                                <span ng-bind="history.orderId"></span>
                            </td>
                            <td ng-click="showLogWindow(history,null)">
                                <span ng-click="showJobChain(history.jobChain);$event.stopPropagation()" class="text-hover-primary" ng-bind="history.jobChain"></span>
                            </td>
                            <td ng-click="showLogWindow(history,null)"><span uib-tooltip="{{history.error.message}}" class="label" ng-class="bgColorFunction(history.state.severity)" ng-bind="history.state._text | translate"></span></td>
                            <td ng-click="showLogWindow(history,null)" ng-bind="history.startTime | stringToDate"></td>
                            <td ng-click="showLogWindow(history,null)" ng-bind="history.endTime | stringToDate"></td>
                            <td ng-click="showLogWindow(history,null)" ng-bind="history.startTime | duration:history.endTime"></td>
                            <td ng-click="showLogWindow(history,null)" ng-bind="history.node || '-' "></td>
                            <td class="noExl">
                                <div class="btn-group dropdown"  >
                                    <button type="button" class="btn-drop more-option-h"  data-toggle="dropdown" ><i
                                            class="fa fa-ellipsis-h"></i></button>
                                    <div class="dropdown-menu dropdown-ac dropdown-more pull-left m-r-28" role="menu">
                                        <a class="dropdown-item" ng-click="addOrderToIgnoreList(history.orderId)" translate>button.addOrderToIgnoreList</a>
                                        <a class="dropdown-item" ng-click="addJobChainToIgnoreList(history.jobChain)" translate>button.addJobChainToIgnoreList</a>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        <tr class="noExl" ng-show="showPanel.historyId == history.historyId">
                         <td colspan="8">
                             <table class="table m-a-0">
                                 <thead>
                                 <tr>
                                     <th translate>label.step</th>
                                     <th translate>label.state</th>
                                     <th translate>label.job</th>
                                     <th translate>label.start</th>
                                     <th translate>label.end</th>
                                     <th translate>label.duration</th>
                                     <th translate>label.exitCode</th>
                                     <th translate>label.errorCode</th>
                                     <th translate>label.errorText</th>
                                 </tr>
                                 </thead>
                                 <tbody>
                                 <tr ng-repeat="order in steps">
                                     <td>{{order.step}}</td>
                                     <td>{{order.node}}</td>
                                     <td>{{order.job}}</td>
                                     <td>{{order.startTime | stringToDate}}</td>
                                     <td>{{order.endTime  | stringToDate}}</td>
                                     <td>{{order.startTime | duration:order.endTime}}</td>
                                     <td>{{order.exitCode}}</td>
                                     <td>{{order.error.code}}</td>
                                     <td class="text-danger">{{order.error.message}}</td>
                                 </tr>
                                 </tbody>
                             </table>
                             <div ng-if="steps.length==0" translate>message.noDataMatched</div>
                         </td>
                     </tr>
                        </tbody>
                    </table>
                    <div class="inline text-sm m-l-xs m-b-sm" ng-class="{'m-t-xs m-l-sm': filtered.length > 10}" ng-if="filtered.length >0"><span translate>label.total</span> {{filtered.length}}
                        <span translate ng-if="filtered.length >1">label.historiesFound</span>
                        <span translate ng-if="filtered.length ==1">label.historyFound</span>
                    </div>
                    <ul ng-show="filtered.length > order.pageSize" uib-pagination total-items="filtered.length" ng-model="order.currentPage" items-per-page='order.pageSize' class="pagination-sm text-sm m-t-0 pull-right" max-size="5" boundary-link-numbers="true" rotate="false" previous-text="{{'button.prev' | translate}}" next-text="{{'button.next' | translate}}"></ul>
                    <div class="pull-left" ng-show="filtered.length > 10">
                            <div class="btn-group m-r-xxs">
                                <button class="btn btn-default white btn-sm" ng-model="order.pageSize" uib-btn-radio="'10'"
                                        ng-class="{'primary': order.pageSize=='10'}" >10
                                </button>
                                <button class="btn btn-default white btn-sm" ng-model="order.pageSize" uib-btn-radio="'25'"
                                        ng-class="{'primary': order.pageSize=='25'}" >25
                                </button>
                                <button class="btn btn-default white btn-sm" ng-model="order.pageSize" uib-btn-radio="'50'"
                                        ng-class="{'primary': order.pageSize=='50'}" >50
                                </button>
                                <button class="btn btn-default white btn-sm" ng-model="order.pageSize" uib-btn-radio="'100'"
                                        ng-class="{'primary': order.pageSize=='100'}">100
                                </button>
                                <button class="btn btn-default white btn-sm" ng-model="order.pageSize" uib-btn-radio="'1000'"
                                        ng-class="{'primary': order.pageSize=='1000'}">1000
                                </button>
                            </div>
                    </div>
                    <div ng-if="isLoading && historys.length==0" class="text-center m-t-md h6 text-uppercase" translate>message.noOrderHistoryFound</div>
                    <div class="text-center m-t text-uppercase hide text-orange" ng-class="{'show': (filtered.length===0 && historys.length !==0)}" translate>message.noDataMatched</div>
                </div>
            </div>
            <div class="m-t-sm box p-a" ng-if="historyFilters.type == 'job'">
                <div class="table-responsive">
                    <table class="table table-hover table-bordered " id="job">
                        <thead>
                            <tr>
                                <th ng-click="sortBy1('taskId')"><a><span translate>label.taskId</span>
                                    <i ng-show="task.filter.sortBy == 'taskId' && !task.sortReverse"
                                       class="fa fa-caret-up "></i>
                                    <i ng-show="task.filter.sortBy == 'taskId' && task.sortReverse"
                                       class="fa fa-caret-down "></i></a>
                                </th>
                                <th ng-click="sortBy1('job')"><a><span translate>label.job</span>
                                    <i ng-show="task.filter.sortBy == 'job' && !task.sortReverse"
                                       class="fa fa-caret-up "></i>
                                    <i ng-show="task.filter.sortBy == 'job' && task.sortReverse"
                                       class="fa fa-caret-down "></i></a>
                                </th>
                                <th ng-click="sortBy1('state._text')"><a><span translate>label.status</span>
                                    <i ng-show="task.filter.sortBy == 'state._text' && !task.sortReverse"
                                       class="fa fa-caret-up "></i>
                                    <i ng-show="task.filter.sortBy == 'state._text' && task.sortReverse"
                                       class="fa fa-caret-down "></i></a>
                                </th>
                                <th ng-click="sortBy1('startTime')"><a><span translate>label.startTime</span>
                                    <i ng-show="task.filter.sortBy == 'startTime' && !task.sortReverse"
                                       class="fa fa-caret-up "></i>
                                    <i ng-show="task.filter.sortBy == 'startTime' && task.sortReverse"
                                       class="fa fa-caret-down "></i></a>
                                </th>
                                <th ng-click="sortBy1('endTime')"><a><span translate>label.endTime</span>
                                    <i ng-show="task.filter.sortBy == 'endTime' && !task.sortReverse"
                                       class="fa fa-caret-up "></i>
                                    <i ng-show="task.filter.sortBy == 'endTime' && task.sortReverse"
                                       class="fa fa-caret-down "></i></a>
                                </th>
                                <th ng-click="sortBy1('duration')">
                                    <a><span translate>label.duration</span>
                                    <i ng-show="task.filter.sortBy == 'duration' && !task.sortReverse"
                                       class="fa fa-caret-up "></i>
                                    <i ng-show="task.filter.sortBy == 'duration' && task.sortReverse"
                                       class="fa fa-caret-down "></i></a>
                                </th>
                                <th ng-click="sortBy1('exitCode')"><a><span translate>label.exitCode</span>
                                    <i ng-show="task.filter.sortBy == 'exitCode' && !task.sortReverse"
                                       class="fa fa-caret-up "></i>
                                    <i ng-show="task.filter.sortBy == 'exitCode' && task.sortReverse"
                                       class="fa fa-caret-down "></i></a>
                                </th>
                                <th class="noExl"></th>
                            </tr>
                        </thead>
                        <tbody >
                        <tr ng-repeat="jobHistory in jobFiltered = (jobHistorys | filter: filterString:strict) | startFrom:(task.currentPage - 1) * task.pageSize | limitTo: task.pageSize | orderBy:task.filter.sortBy:task.sortReverse" class="cursor">
                            <td ng-click="showLogWindow(null,jobHistory)">
                                <span ng-bind="jobHistory.taskId"></span>
                            </td>
                            <td ng-click="showLogWindow(null,jobHistory)">
                                <span ng-click="showJob(jobHistory.job);$event.stopPropagation()" class="text-hover-primary" ng-bind="jobHistory.job"></span>
                            </td>
                            <td ng-click="showLogWindow(null,jobHistory)"><span uib-tooltip="{{history.error.message}}" class="label" ng-class="bgColorFunction(jobHistory.state.severity)" ng-bind="jobHistory.state._text | translate"></span></td>
                            <td ng-click="showLogWindow(null,jobHistory)" ng-bind="jobHistory.startTime | stringToDate"></td>
                            <td ng-click="showLogWindow(null,jobHistory)" ng-bind="jobHistory.endTime | stringToDate"></td>
                            <td ng-click="showLogWindow(null,jobHistory)" ng-bind="jobHistory.startTime | duration:jobHistory.endTime"></td>
                            <td ng-click="showLogWindow(null,jobHistory)" ng-bind="jobHistory.exitCode"></td>
                            <td class="noExl">
                                <div class="btn-group dropdown">
                                    <button type="button" class="btn-drop more-option-h"  data-toggle="dropdown" ><i
                                            class="fa fa-ellipsis-h"></i></button>
                                    <div class="dropdown-menu dropdown-ac dropdown-more pull-left m-r-28" role="menu">
                                        <a class="dropdown-item" ng-click="addJobToIgnoreList(jobHistory.job)" translate>button.addJobToIgnoreList</a>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        </tbody>
                    </table>
                    <div class="inline text-sm m-l-xs m-b-sm" ng-class="{'m-t-xs m-l-sm': jobFiltered.length > 10}" ng-if="jobFiltered.length >0"><span translate>label.total</span> {{jobFiltered.length}}
                        <span translate ng-if="jobFiltered.length >1">label.historiesFound</span>
                        <span translate ng-if="jobFiltered.length ==1">label.historyFound</span>
                    </div>
                     <ul ng-show="jobFiltered.length > task.pageSize" uib-pagination total-items="jobFiltered.length" ng-model="task.currentPage" items-per-page='task.pageSize' class="pagination-sm text-sm m-t-0 pull-right" max-size="5" boundary-link-numbers="true" rotate="false" previous-text="{{'button.prev' | translate}}" next-text="{{'button.next' | translate}}"></ul>
                    <div class="pull-left" ng-show="jobFiltered.length > 10">
                            <div class="btn-group m-r-xxs">
                                <button class="btn btn-default white btn-sm" ng-model="task.pageSize" uib-btn-radio="'10'"
                                        ng-class="{'primary': task.pageSize=='10'}" >10
                                </button>
                                <button class="btn btn-default white btn-sm" ng-model="task.pageSize" uib-btn-radio="'25'"
                                        ng-class="{'primary': task.pageSize=='25'}" >25
                                </button>
                                <button class="btn btn-default white btn-sm" ng-model="task.pageSize" uib-btn-radio="'50'"
                                        ng-class="{'primary': task.pageSize=='50'}" >50
                                </button>
                                <button class="btn btn-default white btn-sm" ng-model="task.pageSize" uib-btn-radio="'100'"
                                        ng-class="{'primary': task.pageSize=='100'}">100
                                </button>
                                <button class="btn btn-default white btn-sm" ng-model="task.pageSize" uib-btn-radio="'1000'"
                                        ng-class="{'primary': task.pageSize=='1000'}">1000
                                </button>
                            </div>
                    </div>
                    <div ng-if="isLoading && jobHistorys.length==0" class="text-center m-t-md h6 text-uppercase" translate>message.noTaskHistoryFound</div>
                    <div class="text-center m-t text-uppercase hide text-orange" ng-class="{'show': (jobFiltered.length===0 && jobHistorys.length !==0)}" translate>message.noDataMatched</div>
                </div>
            </div>
        </div>
        <div  ng-if="!isLoading" class="text-center m-t-lg" >
            <div class="cssload-loading">{{'label.loading' | translate}}...</div>
        </div>
    </div>
</div>
<div ng-if="loading" class="loading-img1"></div>

<div class="modal fade" id="treeModal" tabindex="-1" role="dialog" aria-labelledby="user" data-backdrop="static">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-body p-a" style="min-height: 400px;max-height: 550px; overflow: auto">
                <div class="b-b p-b-sm m-b-sm">
                    <span ng-if="historyFilters.type == 'jobChain'" translate>message.selectFoldersOrJobChains/Orders</span>
                    <span ng-if="historyFilters.type != 'jobChain'" translate>message.selectFoldersOrJobs</span>
                </div>
                <div>
                    <a class="text" ng-click="filter_tree.expand_all();" uib-tooltip="{{'tooltip.expandAll' | translate}}">
                        <i class="fa fa-angle-double-down fa-lg"></i>
                    </a>
                    <a class="text m-l-xs" ng-click="filter_tree.collapse_all();" uib-tooltip="{{'tooltip.collapseAll' | translate}}">
                       <i class="fa fa-angle-double-up fa-lg"></i>
                    </a>
                    <tree
                            tree-data="tree"
                            tree-control="filter_tree"
                            object="object"
                            icon-leaf     = "fa fa-folder"
                            icon-expand   = "fa fa-folder"
                            icon-collapse = "fa fa-folder-open"
                            expand-on="expanding_property"
                            on-select="treeHandler1(branch)"
                            on-click="treeHandler(branch)"
                            template-url="modules/core/template/tree-filter-structure.html">
                    </tree>
                </div>
            </div>
            <div class="modal-footer ">
                <button type="button" class="btn btn-primary btn-sm pull-left" ng-click="addJobChainPaths()" data-dismiss="modal" translate>button.done</button>
                <button type="button" class="btn btn-grey btn-sm pull-left" data-dismiss="modal" translate>button.cancel</button>
            </div>
        </div>
    </div>
</div>

<script>
$('.table-responsive').on('shown.bs.dropdown', function (e) {
    var $table = $(this),
        $menu = $(e.target).find('.dropdown-menu'),
        tableOffsetHeight = $table.offset().top + $table.height(),
        menuOffsetHeight = $menu.offset().top + $menu.outerHeight(true);

    if (menuOffsetHeight > tableOffsetHeight)
      $table.css("padding-bottom", menuOffsetHeight - tableOffsetHeight +10);
  });

  $('.table-responsive').on('hide.bs.dropdown', function () {
    $(this).css("padding-bottom", 0);
  });

</script>
