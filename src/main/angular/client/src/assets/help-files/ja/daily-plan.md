# 実行計画

*実行計画* 画面では、今後実行予定のオーダーの概要が表示され、[実行計画] を管理できます。 

[デイリープランサービス](/service-daily-plan) が、実行計画のオーダーを作成し、コントローラーに送信します。このサービスはバックグラウンドで実行され、毎日、数日先のオーダーの作成と登録を行います。

実行計画は、[クリーンアップサービス](/service-cleanup) による、データベースの削除の対象となります。

*カレンダー* パネルに関する操作については、[実行計画 - カレンダー](/daily-plan-calendar) を参照してください。

## オーダーステート

実行計画には、以下のいずれかの状態を保持するオーダーが含まれます：

- **予定** は、オーダーは作成されましたが、コントローラーとエージェントに *登録* されていません。
- **登録済** は、オーダーがコントローラーとエージェントに送信され、自律的にオー ダーが開始されます。このステータスは、今後実行予定のオーダーと実行中のオーダーに適用されます。
- **完了** は、完了したオーダーです。[オーダー履歴](/history-orders) 画面で、実行が成功したか失敗したかを確認できます。

## オーダーステートの遷移

実行計画には以下の状態遷移があります：

<pre>
      ┌──────────────────┐
      ▼                  ▲
   　 作成                │
      │                  │
      ▼                  │
  ┌───├──────┐      削除  ▲
  │ 予定      │───────────┘
  | オーダー   │──────────┐
  ┖───┌──────┘           ▲
      │                  │
     登録                 │
      │                  │
      ▼                  │
  ┌───├───────┐          │
  │ 登録済     │          │
  | オーダー   │          │
  ┖───┌───────┘          │
      │                  │
      ▼     キャンセル     ▲
      ├──────────────────┘
      │                  ▲
     実行                │
      │                  │
      ▼                  │
  ┌───├───────┐          │
  │ 完了       │          │
  | オーダー    │          │
  ┖───┌───────┘          │
      │                  │
      ▼     キャンセル     ▲
      ┖──────────────────┘
</pre>

## 実行計画

### オーダーステート

オペレーションは、オーダーのアクションメニューから個別に、または一括して利用できます。

以下のボタンは、操作の範囲を制限します： 

- **全て** は、どのステータスのオーダーにも適用されます。
- **予定** は、*登録済* および *削除* は、コントローラーに　*登録* されていない *予定* のオーダーに適用できます。
- **登録済** は、*実行* および *キャンセル* は、コントローラーおよびエージェントに *登録* された *オーダー*に適用できます。
- **完了** は、*キャンセル* 操作は、完了したオーダーに適用できます。
- **遅延** は、オーダーが予定より遅れて開始されたことを示すステートです。

#### ライフサイクルオペレーション

- **オーダー即時実行**。
  - *登録済* オーダーに適用されると、オーダーは直ちに実行されます。一括操作の範囲内のオーダーは同時に開始されます。
- **オーダー登録**
  - *予定* オーダーに適用されると、*登録* ステータスに設定され、コントローラーとエージェントに登録されます。
- **キャンセル**
  - *登録済* オーダーに適用された場合、オーダーはコントローラーとエージェントから削除され、*予定* ステータスに設定されます。
- **オーダー削除**
  - *予定* オーダーに適用されると、オーダーは実行計画から削除されます。後に実行されるデイリープランサービスでは、指定された日付にオーダーが追加されることはありません。
- **オーダーコピー**
  - **開始時間**：オーダーを将来の実行計画にコピーします。日付/時間の入力は、オーダーの開始時間の変更と同様です。
  - **実行計画の割り当てを保持持**：通知ボードのカレンダーベースの依存関係は、元の日次計画の日付で解決されます。
  - **許可時間を無視**：ジョブは特定の日やタイムスロットで実行するように許可時間で制限することができます。到着したオーダーは次の利用可能なタイムスロットを待たなければなりません。このオプションにより、ジョブはそのような制限から独立して開始されます。

#### 開始時刻編集

- **現在**：オーダーはすぐに開始されます。
- **特定日付**：指定の日時にオーダーが開始されます。カレンダーベースの依存関係を解決する場合、オーダーには関連する実行計画の日付が割り当てられます。
- **相対時刻**：例えば、*15* で 15 秒後に開始、*01:30:15* で 1 時間 30 分 15 秒後に開始します。
- **現在の開始時刻からの相対時間**：元の開始時刻に対して秒単位または時間単位で正または負のオフセット値を指定します。
例えば、*-04:00:00* は4時間早く、*+12:00:00* は12時間遅く開始します。カレンダーベースの依存関係を解決する場合、オーダーは実行計画の日付に割り当てられます。

#### オーダー変数編集

変数を指定するワークフローでは、値を変更できます。一括処理で使用する場合、すべてのオーダーに同じ変数値が適用されます。

- **変数の変更** 
  - ワークフローがデフォルト値のない変数を指定している場合、オーダーは値を指定する必要があります。
  - ワークフローがデフォルト値を持つ変数を指定した場合、オーダーからの指定は任意です。

オーダーがワークフローの最初のノードからではなく、後のノードから開始される場合は、位置を指定することができます。

- **ブロック位置**：*Try/Catch*、*Resource Lock*、*Fork/Join* 命令などのブロック命令を保持するワークフ ローでは、関連する命令を選択できます。
- **開始ノード**：*開始ノード* が指定されていない場合、オーダーはワークフローまたは *ブロック位置* の最初のノードから開始されます。
  - *ブロック位置* が指定されない場合、ワークフロー内の最上位命令からオーダーを開始します。
  - *ブロック位置* が指定された場合、開始位置はブロック内の同じレベルのノードとなります。
- **終了ノード**：
  - *ブロック位置* が指定されていない場合、オーダーが終了するワークフロー内のトップレベル命令を選択することができます。
  - *ブロック位置* が指定された場合、オーダーが終了する前に、ブロック内の任意の同レベルノードを指定することができます。
  - 複数の *終了ノード* を指定することができます。

#### 優先度変更

- **優先度**：
  - オーダーがワークフローで並列処理を制限する *リソースロック* 命令に適合する場合、その *優先度* は待機中の *オーダー* のキュー内の位置を決定します。
  - *優先度* は負、0、正の整数、または提供されるショートカットから指定します。*優先度* は高い方が優先されます。ショートカットには以下の値があります：
    - **低**： -20000
    - **中低**以下： -10000
    - **中**：0
    - **中高** ：10000
    - **高**：20000

## 参照

### コンテキストヘルプ

- [クリーンアップサービス](/service-cleanup)
- [実行計画 - カレンダー](/daily-plan-calendar)
- [デイリープランサービス](/service-daily-plan)
- [オーダー履歴](/history-orders)
- [設定 - Daily Plan](/settings-daily-plan)

###Product Knowledge Base

- [JS7 - Daily Plan](https://kb.sos-berlin.com/display/JS7/JS7+-+Daily+Plan)

