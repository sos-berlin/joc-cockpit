# ♪ワークフロー

ワークフロー*ビューはワークフローのモニタリングとコントロールを提供します。

- 特定のワークフローで処理中のオーダーを確認できます。
- ユーザーは必要に応じて、ワークフローにオーダーを追加することができます。このようなオーダーは[Daily Plan](/daily-plan) には追加されず、アドホックに追加されます。

## ナビゲーションパネル

左側のパネルは、ワークフローやオーダーをフォルダからナビゲートしたり、タグで絞り込 んだりするためのタブで構成されています。

- **フォルダ**ナビゲーションでは、フォルダ名にカーソルを合わせると、シェブロンダウンアイコンが表示されます。これにより、現在のフォルダとサブフォルダのワークフローが表示されます。シェブロンアップアイコンを使用すると、現在のフォルダに選択がリセットされます。
- タグフィルタリングは以下のタブで行います：
  - **ワークフロータグ**は[Configuration - Inventory - Workflows](/configuration-inventory-workflows) ビューから割り当てられます。
  - **オーダータグ**は[Configuration - Inventory - Schedules](/configuration-inventory-schedules) ビューから割り当てられます。

タグは + と - アイコンで選択され、クイック検索アイコンで検索できます。タグの表示は[Settings - JOC Cockpit](/settings-joc) ページから有効にする必要があります。

## ワークフローパネル

### オーダーサマリー

ウィンドウ上部には、[Dashboard - Orders](/dashboard-orders) と同様のオーダーサマリーが表示されます。 指定された状態のオーダー数をクリックすると、ポップアップウィンドウが表示され、オーダーのリストが表示されます。

オーダーサマリーは、選択されたフォルダまたはタグに表示されたワークフローに関連するオー ダーについて表示されます。

### ワークフローの表示

- **ワークフロー名**はワークフローに割り当てられた固有の名前です。
  - ワークフロー名」をクリックすると、ウィンドウ下部に「履歴」パネルが表示さ れ、ワークフローの最近の実行履歴が表示されます。
  - 大きな矢印アイコンをクリックすると、全てのジョブおよびワークフロー指示 が表示されます。
  - 小さな矢印アイコンをクリックすると、トップレベルのジョブおよびワークフロー指 示が表示されます。
  - 鉛筆アイコンをクリックすると[Configuration - Inventory - Workflows](/configuration-inventory-workflows) ビューに移動します。
  - アイコンをクリックすると、[Add Orders](/workflows-orders-add) のポップアップウィンドウが表示されます。
- ワークフローを表形式で表示するには、**Tabular View**, **Graphical View** アイコンを使用します。
  - 表形式では、簡潔な構造を重視し、ウィンドウのスペースを節約します。
  - を、多くのユーザーに分かりやすいグラフィカル形式で表示することができます。
- **展開日**はワークフローが展開された日付です。
- **Deployment Status** は、ワークフローがコントローラやエージェントにデプロイされているかどうかを示します。
  - **同期済み*** ワークフローはデプロイされ、コントローラおよびエージェントで利用可能です。
  - **Not Synchronized** ワークフローはコントローラとエージェントにデプロイされておらず、インベントリからのみ利用可能です。
  - **一時停止中** ワークフローは凍結され、オーダーを受け付けますが、ワークフローが再開されるまでオーダーの開始を許可しません。
  - **ワークフローは、ワークフローが中断または再開されたことを1つ以上のエージェントが確認するまで待機します。
- **オーダー数**は、ワークフローに割り当てられているオーダーの数を示します。 
  - 最大3つのオーダーがワークフローに直接表示されます。オーダー操作のためのアクションメニューが表示されます。
    - オーダー ID をクリックすると、そのオーダーのログが[Order Log View](/order-log) から表示されます。
  - No. of Orders*をクリックすると、ポップアップウィンドウが表示され、関連するオー ダーがすべて表示されます。

### ジョブおよびワークフロー指示の表示

ワークフローを矢印アイコンで展開すると、ワークフローのジョブや手順が表示されま す。

## 履歴パネル

ワークフロー名をクリック、またはオーダーを追加すると、ウィンドウ下部に表示さ れます。

### オーダー履歴

- **オーダーID**は、オーダーに割り当てられた一意の識別子です。矢印アイコンをクリックすると、オーダーの変数とオーダーによって渡されたジョブが表示されます。 
- **ラベル**は、ワークフローにおけるオーダーの最新位置を示します。ユーザーはワークフロー指示書に **ラベル** を割り当てることができ、そのラベル** が表示されます。
- **履歴ステータス(History Status)**は、オーダーにおける最新の結果を示します。
  - オーダーが完了した場合、*履歴ステータス**は*成功*または*失敗*となります。
  - オーダーが完了していない場合、*履歴ステータス**は*進行中**となります。
- **オーダー状態**は、オーダーの最新の状態を示します。[Order States](/order-states) を参照してください。
  - オーダーが完了している場合、*Order State*は*successful*または*failed*になります。
  - オーダーが完了していない場合、*Order State*は*processing*となります。

ログ出力には以下のオプションがあります：

- **オーダーID**：*オーダーID*をクリックすると、[Order Log View](/order-log) からそのオーダーのログ出力が表示されます。 ログには、ワークフローで実行されたすべてのジョブによって作成された出力が含まれます。
- **アイコンをクリックすると、オーダーのログをファイルにダウンロードします。

デフォルトでは、オーダーログの表示は 10MB に制限されています。ユーザーは[Settings - JOC Cockpit](/settings-joc) ページから制限を調整できます。

### タスク履歴

- **Job**はジョブの名前を示します。
- **Label**はワークフローにおけるジョブの位置を示します。
- **Status**はジョブの実行結果で、*in progress*、*successful*、*failed*のいずれかです。
- **Start Time**、End Time**はジョブ実行の開始と終了を示します。
- クリティカリティ(**Criticality**)は[Configuration - Inventory - Workflows - Job Options](/configuration-inventory-workflow-job-options) で指定され、ジョブの関連性を示します：
  - *マイナー
  - *マイナー
  - *マイナー
  - *クリティカル
- **リターンコード** はシェルジョブの終了コードか JVM ジョブのリターンコードです。[Configuration - Inventory - Workflows - Job Properties](/configuration-inventory-workflow-job-properties) パネルでは、ジョブの実行が成功した場合と失敗した場合のリターンコードを設定できます。

ログ出力へのアクセスには以下のアクションが利用可能です：

- **Job**: *Job Name*をクリックすると、[Task Log View](/task-log) からジョブのログ出力が表示されます。 

デフォルトでは、タスクログの表示は10 MBのログサイズに制限されています。ユーザーは[Settings - JOC Cockpit](/settings-joc) ページから制限を調整できます。

### 監査ログ

このパネルには、現在のワークフローに焦点を当てた[Audit Log](/audit-log) と同じ情報が表示されます。

表示されるAudit Logエントリ数は、ユーザー[Profile - Preferences](/profile-preferences) の*Max.number of Audit Log entries per object*設定で変更できます。

## 操作

### ワークフローに関する操作

ウィンドウ上部には、ワークフロー操作のための以下のボタンがあります：

- 全停止**」は「緊急停止**」として機能し、現在表示されているワークフ ローの選択に関わらず、すべてのワークフローを一時停止します。中断されたワークフローは凍結され、オーダーは受け付けますが、ワークフ ローが再開されない限りオーダーは開始されません。実行中のオーダーは、中断される前のジョブまたはその他の指示を継続します。
- **現在表示されているワークフローの選択に関係なく、中断されたワークフロー をすべて再開します。

### ジョブおよびワークフロー指示に対する操作

ジョブのアクションメニューから以下の操作が可能です：

- **Skip Job*** オーダーが関連するジョブを実行しないようにし、次のワークフロー指示に進ませます。
- **Unskip Job** はスキップされたジョブを元に戻します。
- **Stop Job** ジョブに到着したオーダーを中断します。オーダーは **Resume* オペレーションにより、別のワークフローノードから処理を続行したり、停止したジョ ブの処理を強制することができます。
- **Unstop Job** は停止したジョブを元に戻します。

### オーダーに対するオペレーション

オーダーごとにアクションメニューがあり、以下の操作が可能です：

- **キャンセル** オーダーを終了します。 *実行中* オーダーは現在のジョブまたはワークフロー命令を完了し、ワークフローに *失敗* *履歴ステータス* を残します。
- **タスクのキャンセル/終了**」は、ジョブを実行中のオーダーを強制的に終了します。オーダーは *失敗* *履歴ステータス* でワークフローから離脱します。
- **サスペンド**はオーダーを一時停止します。実行中のオーダーは、現在のジョブまたはワークフロー命令を完了した後に中断されます。
- **実行中のオーダーを強制的に終了し、オーダーを一時停止します。
- **Suspend/reset**は、現在のワークフロー命令を即座にリセットし、オーダーを*サスペンド*状態にします。このオプションは、実行中のオーダーのタスクの強制終了と組み合わせることができます。
- **再開**は、*中断*または*失敗*した再開可能なオーダーを継続します。

オーダーの状態に応じて、追加の操作が可能です。

## フィルター

ユーザーはワークフローの表示を制限するためにフィルターを適用できます。フィルターボタンはウィンドウ上部にあります：

- **Agents(エージェント)**は、選択した1つ以上のエージェントに割り当てられたジョブ を保持するワークフローをフィルタリングします。
- **同期済み** ワークフローはデプロイされ、コントローラとエージェントで利用可能です。
- **同期されていない** ワークフローは、コントローラとエージェントにデプロイされず、インベントリからのみ利用可能です。
- **一時停止中** ワークフローは凍結され、オーダーを受け付けますが、ワークフローが再開されるまでオーダーの開始を許可しません。
- **ワークフローは、ワークフローが一時停止していることを1つ以上のエージェントが確認するまで待機します。
- **オーダーフィルター**は、選択されたワークフローに表示される*スケジュール*オーダーの日付範囲を指定することができます。

アドバンスフィルタ**では、ワークフローをフィルタリングするための、より詳細な条件を指定することができます。

## 検索

[Workflows - Search](/workflows-search) は依存関係からワークフローを検索するための条件を提供します。例えば、特定のジョブ名を含むワークフローを検索したり、特定の通知ボードを使用したりすることができます。

## 参照

### コンテキストヘルプ

-[Configuration - Inventory - Schedules](/configuration-inventory-schedules)
-[Configuration - Inventory - Workflows](/configuration-inventory-workflows)
  -[Configuration - Inventory - Workflows - Job Properties](/configuration-inventory-workflow-job-properties)
  -[Configuration - Inventory - Workflows - Job Options](/configuration-inventory-workflow-job-options)
-[Daily Plan](/daily-plan)
-[Order Log View](/order-log)
-[Order States](/order-states)
-[Profile - Preferences](/profile-preferences)
-[Settings - JOC Cockpit](/settings-joc)
-[Workflows - Add Orders](/workflows-orders-add)
-[Workflows - Search](/workflows-search)

###Product Knowledge Base

-[JS7 - Schedules](https://kb.sos-berlin.com/display/JS7/JS7+-+Schedules)
-[JS7 - Workflows](https://kb.sos-berlin.com/display/JS7/JS7+-+Workflows)

