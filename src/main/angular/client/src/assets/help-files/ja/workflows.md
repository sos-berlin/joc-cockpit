# ワークフロー

*ワークフロー*ビューはワークフローのモニタリングとコントロールを提供します。

- 特定のワークフローで処理中のオーダーを確認できます。
- ユーザーは必要に応じて、ワークフローにオーダーを追加することができます。このようなオーダーは[実行計画](/daily-plan) には追加されず、アドホックに追加されます。

## ナビゲーションパネル

左側のパネルは、ワークフローやオーダーをフォルダー間の移動や、タグで絞り込んだりするためのタブで構成されています。

- **フォルダー**タブでは、フォルダー名にカーソルを合わせると、下向き三角アイコンが表示されます。これにより、現在のフォルダーとサブフォルダーのワークフローが表示されます。上向き三角アイコンを選択すると、現在のフォルダーに選択がリセットされます。
- タグフィルタリングは以下のタブで行います：
  - **ワークフロータグ**は[ジョブ定義 - インベントリー - ワークフロー](/configuration-inventory-workflows) ビューから割り当てられます。
  - **オーダータグ**は[ジョブ定義 - インベントリー - 実行計画](/configuration-inventory-schedules) ビューから割り当てられます。

タグは + と - アイコンで選択され、クイック検索アイコンで検索できます。タグの表示は[設定 - JOC](/settings-joc) ページから有効にする必要があります。

## ワークフローパネル

### オーダーサマリー

ウィンドウ上部には、[ダッシュボード - オーダー](/dashboard-orders) と同様のオーダーサマリーが表示されます。 指定された状態のオーダー数をクリックすると、ポップアップウィンドウが表示され、オーダーのリストが表示されます。

オーダーサマリーは、選択されたフォルダーまたはタグに表示されたワークフローに関連するオーダーについて表示されます。

### ワークフローの表示
- **ワークフロー名**はワークフローに割り当てられた固有の名称です。
  - ワークフロー名をクリックすると、ウィンドウ下部に「履歴」パネルが表示され、ワークフローの最近の実行履歴が表示されます。
  - 大きな三角アイコンをクリックすると、全てのジョブおよびワークフロー指示が表示されます。
  - 小さな三角アイコンをクリックすると、トップレベルのジョブおよびワークフロー指示が表示されます。
  - 鉛筆アイコンをクリックすると[ジョブ定義 - インベントリー - ワークフロー](/configuration-inventory-workflows) ビューに移動します。
  - ＋アイコンをクリックすると、[新規オーダー追加](/workflows-orders-add) のポップアップウィンドウが表示されます。
- ワークフローを表形式で表示するには、**表形式表示**, **カード形式表示** アイコンを使用します。
  - 表形式では、簡潔な構造を重視し、ウィンドウのスペースを節約します。
  - を、多くのユーザーに分かりやすいグラフィカル形式で表示することができます。
- **配置日**はワークフローが配置された日時です。
- **ステータス** は、ワークフローがコントローラやエージェントに配置されているかどうかを示します。
  - **同期済み*** ワークフローは配置され、コントローラおよびエージェントで利用可能です。
  - **未同期** ワークフローはコントローラとエージェントに配置されておらず、インベントリからのみ利用可能です。
  - **一時停止中** ワークフローは一時停止され、オーダーを受け付けますが、ワークフローが再開されるまでオーダーの開始を許可しません。
  - **未処理**ワークフローは、ワークフローが中断または再開されたことを1つ以上のエージェントが確認するまで待機します。
- **オーダー数**は、ワークフローに割り当てられているオーダーの数を示します。
  - 最大3つのオーダーがワークフローに直接表示されます。オーダー操作のためのアクションメニューが表示されます。
    - オーダー ID をクリックすると、そのオーダーのログが[オーダー履歴](/order-log) から表示されます。
  - **オーダー数**をクリックすると、ポップアップウィンドウが表示され、関連するオーダーがすべて表示されます。

### ジョブおよびワークフロー指示の表示

ワークフローを三角アイコンで展開すると、ワークフローのジョブや手順が表示されます。

## 履歴パネル

ワークフロー名をクリック、またはオーダーを追加すると、ウィンドウ下部に表示されます。

### オーダー履歴タブ

- **オーダーID**は、オーダーに割り当てられた一意の識別子です。三角アイコンをクリックすると、オーダーの変数とオーダーによって渡されたジョブが表示されます。
- **ラベル**は、ワークフローにおけるオーダーの最新位置を示します。ユーザーはジョブ定義で **ラベル** を割り当てることができ、そのラベル が表示されます。
- **ステータス**は、オーダーにおける最新の結果を示します。
  - オーダーが完了した場合、*ステータス*は*成功*または*失敗*となります。
  - オーダーが完了していない場合、*ステータス*は*処理中*となります。
- **オーダーステート**は、オーダーの最新の状態を示します。[オーダーステート](/order-states) を参照してください。
  - オーダーが完了している場合、*オーダーステート*は*完了オーダー*または*失敗オーダー*になります。
  - オーダーが完了していない場合、*オーダーステート*は*処理中*となります。

ログを出力するには以下の方法があります：

- **オーダーID**：*オーダーID*をクリックすると、[オーダーログ](/order-log) からそのオーダーのログ出力が表示されます。 ログには、ワークフローで実行されたすべてのジョブによって作成された出力が含まれます。
- **ダウンロード**アイコンをクリックすると、オーダーログをファイルにダウンロードできます。

デフォルトでは、オーダーログの表示は10MBに制限されています。ユーザーは[設定 - JOC](/settings-joc) ページから調整できます。

### タスク履歴タブ

- **ジョブ**はジョブ名称を表示します。
- **ラベル**はジョブ定義で設定したジョブのラベルを表示します。
- **ステータス**はジョブの実行結果で、*処理中*、*完了*、*失敗*のいずれかです。
- **開始時間**、**終了時間**はジョブ実行の開始時刻と終了時刻を示します。
- **重大度**は[ジョブ定義 - インベントリー - ワークフロー - ジョブオプション](/configuration-inventory-workflow-job-options) で指定でき、ジョブの重要性を示します：
  - *マイナー*
  - *ノーマル*
  - *メジャー*
  - *重大*
- **リターンコード** はShellジョブの終了コードか、JVMジョブのリターンコードです。[ジョブ定義 - インベントリー - ワークフロー - ジョブプロパティ](/configuration-inventory-workflow-job-properties) パネルでは、ジョブ実行が成功した場合と失敗した場合のリターンコードを設定できます。

ログを出力するには以下の方法があります：

- **ジョブ**: *ジョブの名称*をクリックすると、[タスクログ](/task-log) からそのジョブのログ出力が表示されます。

デフォルトでは、タスクログの表示は10MBのログサイズに制限されています。ユーザーは[設定 - JOC](/settings-joc) ページから調整できます。

### 操作ログパネル

このパネルには、JobSchedulerの操作履歴[Audit Log](/audit-log) と同じ情報が表示されます。

表示される操作履歴の数は、ユーザー設定の[プロファイル - 設定値](/profile-preferences) の*最大操作ログ表示数*設定で変更できます。

## 操作

### ワークフローパネル

ウィンドウ上部には、ワークフロー操作のための以下のボタンがあります：

-**全て一時停止**は*緊急停止*として機能し、現在表示されているワークフローの選択に関わらず、すべてのワークフローを一時停止します。一時停止されたワークフローは凍結状態となり、オーダーは受け付けますが、ワークフローが回復されない限りオーダーは開始されません。実行中のオーダーは、中断される前のジョブまたはその他の指示を継続します。
- **全て回復**現在表示されているワークフローの選択に関係なく、一時停止されたワークフローをすべて再開します。

### ジョブおよびワークフロー命令に対する操作

ジョブのアクションメニューから以下の操作が可能です：

- **スキップ*** オーダーが指定したジョブを実行せず、次のワークフロー命令に進ませます。
- **スキップ解除** はスキップされたジョブを元に戻します。
- **停止** ジョブに到着したオーダーを中断します。オーダーは **回復** 操作により、別のワークフローノードから処理を続行したり、停止したジョブの処理を強制することができます。
- **停止解除** は停止したジョブを元に戻します。
=
### オーダーに対する操作

オーダーごとにアクションメニューがあり、以下の操作が可能です：

- **キャンセル** オーダーをキャンセルします。 *実行中* オーダーは現在のジョブまたはワークフロー命令で完了し、ワークフローに *失敗* *履歴ステータス* を残します。
- **強制キャンセル**は、実行中のジョブタスクをkillし、オーダーを強制的に終了します。オーダーは *失敗* *履歴ステータス* でワークフローを終了します。
- **一時停止／ノーマル**はオーダーを一時停止します。実行中のオーダーは、現在のジョブまたはワークフロー命令を完了した後に中断されます。
- **一時停止／強制**実行中のジョブタスクをkillし、オーダーを一時停止します。
- **一時停止／リセット**は、現在のワークフロー命令を即座にリセットし、オーダーを*一時停止*状態にします。このオプションは、実行中のオーダーのタスクの強制終了と組み合わせることができます。
- **回復**は、*一時停止*または*失敗*した再開可能なオーダーを継続します。

オーダーの状態に応じて、追加の操作が可能です。

## フィルター表示

ユーザーはワークフローの表示をフィルターできます。フィルターボタンはウィンドウ上部にあります：

- **エージェント**は、選択した1つ以上のエージェントに割り当てられたジョブ を保持するワークフローをフィルタリングします。
- **同期済** 配置され、コントローラとエージェントで利用可能なワークフローを表示します。
- **未同期** コントローラとエージェントに配置されず、インベントリからのみ利用可能なワークフローを表示します。
- **一時停止** 一時停止されたワークフローを表示し、オーダーを受け付けますが、ワークフローが回復されるまでオーダーの開始を許可しません。
- **保留**ワークフローは、ワークフローが一時停止していることを1つ以上のエージェントが確認するまで待機します。
- **オーダー検索**は、選択されたワークフローに表示される*スケジュール*オーダーの日付範囲を指定することができます。

*詳細検索*では、ワークフローをフィルタリングするための、より詳細な条件を指定することができます。

## 検索機能

[ワークフロー - 検索](/workflows-search) はワークフローを条件指定検索できます。例えば、特定のジョブ名を含むワークフローを検索したり、特定の通知ボードを使用したりすることができます。

##  参照

### コンテキストヘルプ

- [ジョブ定義 - インベントリー - スケジュール](/configuration-inventory-schedules)
- [ジョブ定義 - インベントリー - ワークフロー](/configuration-inventory-workflows)
  - [ジョブ定義 - インベントリー - ワークフロー - ジョブプロパティ](/configuration-inventory-workflow-job-properties)
  - [ジョブ定義 - インベントリー - ワークフロー - ジョブオプション](/configuration-inventory-workflow-job-options)
- [実行計画](/daily-plan)
- [オーダー履歴](/order-log)
- [オーダーステート](/order-states)
- [プロファイル - 設定値](/profile-preferences)
- [設定 - JOC Cockpit](/settings-joc)
- [ワークフロー - オーダー追加](/workflows-orders-add)
- [ワークフロー - 検索](/workflows-search)

###Product Knowledge Base

- [JS7 - Schedules](https://kb.sos-berlin.com/display/JS7/JS7+-+Schedules)
- [JS7 - Workflows](https://kb.sos-berlin.com/display/JS7/JS7+-+Workflows)
