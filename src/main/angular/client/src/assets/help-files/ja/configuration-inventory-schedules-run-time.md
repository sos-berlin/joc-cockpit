# コンフィギュレーション - インベントリ - スケジュール - ランタイム

スケジュールパネル*では、[Daily Plan](/daily-plan) からオーダーを作成するためのルールを指定することができます。

ランタイム*ボタンを押すと、ポップアップウィンドウからオーダーの開始時間を指定することができます。

## タイムゾーン

実行時間は、ユーザーの[Profile - Preferences](/profile-preferences) から入力された **タイムゾーン** から指定されます。入力には、*UTC*、*Europe/London*などのタイムゾーン識別子が使用できます。タイムゾーン識別子の完全なリストについては、[List of tz database time zones](https://en.wikipedia.org/wiki/List_of_tz_database_time_zones) を参照してください。

- オーダーの開始時間は、指定されたタイムゾーンで考慮されます。
- [Settings - Daily Plan](/settings-daily-plan) と異なるタイムゾーンをオーダー実行時間に使用することも可能です。ユーザーは以下の点を考慮する必要があります。 
  - オーダーには実行計画日が割り当てられます。
  - 開始時間はスケジュールのタイムゾーンから計算されます。
- その結果、実行計画では、前日または後日と重複する日付のオーダーを保持することができます。例えば
  - 実行計画のタイムゾーンをUTCとします、
  - スケジュールのタイムゾーンがアジア/カルカッタ(UTC+05:30)で、開始時間が*23:00*であるとします、
  - 火曜日の実行計画でオーダーが作成された場合、開始時刻は水曜日の*04:30* UTCとなります。この結果は正しいのですが、タイムゾーンに迷うユーザーにとっては混乱を招く可能性があります。

驚くことに、1日は24時間ではなく、最大50時間です。地球の自転に依存しているため、1日の長さは常に24時間です。しかし、任意のタイムゾーンでは、地球上のすべての可能な時間を含むように50時間の範囲があります。

## カレンダー割り当て

まず、カレンダーを割り当てます：

- **営業日カレンダー**は同じ名前のボタンから使用でき、オーダーを作成する日を指定します。繰り返し使用される場合、稼働日カレンダーごとに期間付きのランタイムエントリーが追加されます。
- **非稼働日カレンダー**は同じ名前のボタンから利用可能で、オーダーを作成しない日を指定することができます。非稼働日カレンダーはいくつでも追加でき、統合されます。

##期間

次に、開始時刻の期間を1つ以上指定します。繰り返し間隔]には以下のオプションがあります：

- **Single Start**は1つの時点です。
  - **開始時間**は構文*HH:MM:SS*を使用して指定します。
  - **On Non-working Day**は、ある期間がNon-working Day Calendarによって示される日に合致する場合に何が起こるかを指定します。
    - **suppress execution**は、オーダーを作成しないデフォルトの動作です。
    - **非稼働日を無視する**は、非稼働日カレンダーを上書きし、オーダーを作成します。
    - **非稼働日の前***は、非稼働日の前の営業日にオーダーを追加します。例えば
      - 営業日カレンダーは月～木を営業日とします。 
      - 非稼働日カレンダーは、その年の特定の月曜日を非稼働日とします。
      - 非稼働日の次の日は前の日曜日になります。週末を除外して非稼働日カレンダーに追加した場合、その日は前日の金曜日になります。
    - **非稼働日の次の日**は、非稼働日の次の営業日にオーダーを追加します。例えば
      - 例：営業日カレンダーは、営業日を火～金で指定します。 
      - 非稼働日カレンダーは、その年の特定の金曜日を非稼働日とします。
      - その翌日は次の土曜日となります。週末を除外して非稼働日カレンダーに追加した場合、その翌日は次の月曜日となります。        
- **繰り返し**は、周期オーダーの繰り返し期間を指定します。入力には次の構文を使用します： *HH:MM:SS*。
  - **繰り返し時間**は、2時間ごとのサイクルでは*02:00*のように、サイクル間の間隔です。
  - **開始時間**は最初のサイクルの開始時間です。
  - **End**は最後のサイクルの終了時刻です。
  - **On Non-working Day**は、ある期間がNon-working Day Calendarによって示される日に合致する場合にどうするかを指定します。設定は*Single Start*期間と同じです。

## 制限事項

*オーダーが作成される日を制限します：

- 割り当てられた営業日カレンダーと非営業日カレンダーがマージされ、オー ダーによるワークフロー実行日が決定されます。
- さらに、[Configuration - Inventory - Calendars](/configuration-inventory-calendars) と同様のルールを適用し、保持します：
  - **平日**は曜日を指定します。
  - **特定の平日**は、月の最初または最後の月曜日のような相対的な平日を指定します。
  - **特定の日**は、その年の曜日を指定します。
  - **月日**は、月の最初の日や最後の日など、月の相対的な日を指定します。
  - **Every**は、2日ごと、1週間ごと、3ヶ月ごとなどの定期的な期間を指定します。この場合、日数のカウントを開始する *有効な開始日* を指定する必要があります。
  - **祝祭日**は既知の祝祭日を指定します。祝祭日**は既知の祝祭日を指定します。
  - **非稼働日カレンダー**は、現在のカレンダーの非稼働日カレンダーから関連する日を除外します。

*使用するカレンダーの数を制限することができます。月の初日などの特定のルールのために個別のカレンダーを作成する代わりに、ユーザーは1年のすべての日をカバーする標準カレンダーを適用し、希望の*制限*を適用することができます。

非稼働日カレンダーの使用は、*ランタイム*を割り当てた場合と*制限*を割り当てた場合で異なります：

- 例
  - 例：月～金の営業日カレンダーを想定。
  - 例：営業日カレンダーを月～金と仮定します。
  - 結果としての日数は、営業日カレンダーと結果としての日数リストの4日目から計算されます。
- スケジュールは非稼働日カレンダーの参照も保持できます。
  - 非稼働日カレンダーは各スケジュールの*制限*の計算後*に適用されます。
  - もしユーザーが特定の非稼働日をカレンダーから除外したい場合、*月の*4日*の*制限*が適用される前に、オプションがあります。
    - 営業日カレンダーの*除外頻度*から非営業日を指定します。
    - 制限*が追加されたカレンダーから非稼働日を指定するには

## サイクリックオーダーとサイクリックワークフローの比較

サイクリックオーダーは、サイクルごとに個別のオーダーインスタンスを作成します。繰り返し間隔を使用するスケジュールで作成される周期的オーダーに代わるものとして、[JS7 - Cycle Instruction](https://kb.sos-berlin.com/display/JS7/JS7+-+Cycle+Instruction) が周期的ワークフローで使用できます。

- 実行
  - サイクル命令*は、スケジュールからサイクルオーダーを使用するのと同じように、完全なワークフローを生成します。
  - サイクル命令*はワークフローの一部をサイクルで実行するために使用できます。
- 効率性
  - スケジュールは、周期的オーダーの各期間ごとに多数のオーダーインスタンスを作成します。30秒ごとに1つのワークフローを実行すると、1日あたり2880のオーダーが作成されます。
  - *サイクル命令*は、1つのオーダーからワークフローを周期的に実行します。
  - 周期的なワークフローの処理は、周期的なオーダーの処理よりもはるかに効率的です。
- エラー処理
  - 失敗
    - ワークフロー内のジョブが失敗した場合、各オーダーのインスタンスごとに発生します。
    - サイクル命令*内のジョブが失敗した場合、エラー処理によっては、オーダーが*失敗*状態にある間に発生するサイクルがスキップされます。
  - 通知
    - 失敗した各サイクルオーダーのインスタンスに対して、通知が作成されます。
    - サイクリックワークフローの1つのオーダーに対して、1つのNotificationが作成されます。
  - 介入
    - 周期的オーダーの操作は、すべてのオーダーインスタンスに適用されます。この結果、以前にスケジュールされたオーダーの並列実行が、インターバルで実行されます。
    - サイクリック ワークフローでは、1つのオーダーがユーザーの介入を待ちます。
- ロギング
  - サイクリック・オーダーの各オーダーインスタンスについて、[Order History](/history-orders) と[Task History](/history-tasks) に個別のエントリが作成されます。
  - サイクリック ワークフローでは、オーダー履歴に各サイクルのログ出力が追加されます。ジョブ実行ごとの個別のエントリは、タスク履歴に追加されます。

## 参考文献

### コンテキストヘルプ

-[Configuration - Inventory - Calendars](/configuration-inventory-calendars)
-[Configuration - Inventory - Schedules](/configuration-inventory-schedules)
-[Configuration - Inventory - Workflows](/configuration-inventory-workflows)
-[Daily Plan](/daily-plan)
-[Daily Plan Service](/service-daily-plan)
-[Object Naming Rules](/object-naming-rules)
-[Order History](/history-orders)
-[Profile - Preferences](/profile-preferences)
-[Settings - Daily Plan](/settings-daily-plan)
-[Task History](/history-tasks)

###Product Knowledge Base

-[JS7 - Calendars](https://kb.sos-berlin.com/display/JS7/JS7+-+Calendars)
-[JS7 - Cycle Instruction](https://kb.sos-berlin.com/display/JS7/JS7+-+Cycle+Instruction)
-[JS7 - Schedules](https://kb.sos-berlin.com/display/JS7/JS7+-+Schedules)
- [tzデータベースのタイムゾーン一覧](https://en.wikipedia.org/wiki/List_of_tz_database_time_zones)

