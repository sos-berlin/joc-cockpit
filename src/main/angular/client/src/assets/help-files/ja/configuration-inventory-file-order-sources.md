# ジョブ定義 - インベントリー - ファイルオーダーソース

*ファイルオーダーソース* では、ワークフローで[JS7 - File Watching](https://kb.sos-berlin.com/display/JS7/JS7+-+File+Watching) を指定することができます：

- ディレクトリは、受信ファイルに対してエージェントによって監視されます。
- 各入力ファイルに対して、そのファイルを表すオーダーが作成されます。 
  - ワークフローが完了する前にファイルがジョブによって移動または削除された場合、オー ダーはワークフローを続行し、完了時にワークフローから離脱します。
  - ワークフローが完了してもファイルが残っている場合、オーダーは *完了* の状態で利用可能です。オーダーをワークフローから離脱させるには、入力されたファイルを移動または削除する必要があります。
- オーダーは、入力ファイルへのパスを保持する*file*変数を保持します。file*変数はワークフローが宣言し、ジョブが使用することができます。

ファイルオーダーソースにはワークフローが割り当てられ、受信ファイルごとにオーダーが追加されます。

ファイルオーダーソースは以下のパネルで管理されます：

- ウィンドウの左側にある[ジョブ定義 - インベントリー - ナビゲーションパネル](/configuration-inventory-navigation) では、ファイルオーダーソースのフォルダーごとにナビゲーションができます。さらに、このパネルではファイルオーダーソースの操作が可能です。
- ウィンドウ右側の *ファイルオーダーソースパネル* は、ファイルオーダーソース設定の詳細を表示します。

## ファイルオーダーソースパネル

ファイルオーダーソースでは、以下の入力が可能です：

- **名称** は、ファイルオーダーソースの一意の識別子で、[オブジェクト命名規則](/object-naming-rules) を参照してください。
- **タイトル** は、ファイルオーダーソースの目的などの説明です。
- **タグ名** は、受信ファイルに対して作成されるオーダーに割り当てられるタグを指定します。
- **ワークフロー名** は、受信ファイルのオーダーが追加されるワークフロー名を指定します。
- **エージェント** ワークフローを実行するエージェントを指定します。  エージェントクラスターを使用する場合、ファイル監視は、高可用性のために ディレクターエージェントによって実行されます。
- **ディレクトリー** は、受信ファイルを監視するディレクトリーを指定します。エージェントのランタイムアカウントには、*ディレクトリー* からの受信ファイルの読み取りと書き込み (移動、削除) のパーミッションが割り当てられている必要があります。
- **パターン** は、受信ファイル名にマッチする Java [正規表現](https://en.wikipedia.org/wiki/Regular_expression) を指定します。正規表現は、ワイルドカードの使用とは異なります。例えば 
  - **.\*** は、任意のファイル名に一致します。
  - **.\*\\.csv$** は、拡張子が .csv のファイル名に一致します。
- **タイムゾーン** は、受信ファイルからのオーダーを実行計画の日付に割り当てるために適用されるタイムゾーンを指定します ([実行計画](/daily-plan) を参照)。入力には、*UTC*、*Asia/Tokyo* などのタイム ゾーン識別子を使用できます。タイムゾーン識別子の完全なリストについては、[tzデータベースのタイムゾーン一覧](https://en.wikipedia.org/wiki/List_of_tz_database_time_zones) を参照してください。
- **遅延** は、入力されたファイルが書き込み完了とみなされるまでエージェントが待機する秒数を指定します。
  - Unixでは、エージェントがファイルを読み込むと同時にファイルを書き込むことができます。Windows 環境では、デフォルトでファイルの読み込みと書き込みを同時に行うことはできません。
  - 最初のステップで、エージェントはファイルサイズと変更タイムスタンプをチェックします。次のステップでは、エージェントは *遅延* を待ち、確認を繰り返します。ファイルサイズと変更タイムスタンプに変更がない場合、エージェントはオーダーを作成し、そうでない場合は2番目のステップを繰り返します。
- **優先度**
  - オーダーが並列処理を制限するワークフローの *ロック命令* に適合する場合、その *優先度* は、*待機中* オーダーのキュー内の位置を決定します。
  - *優先度* は負、0、正の整数、または提供されるショートカットから指定します。 *優先度* は高い方が優先されます。ショートカットには以下の値があります：
    - **低**： -20000
    - **中低**： -10000
    - **中**：0
    - **中高**：10000
    - **高**：20000

### ファイルオーダーソースに対するオーダー

利用可能な操作については、[ジョブ定義 - インベントリー - ナビゲーションパネル](/configuration-inventory-navigation) を参照してください。

## 参照

### コンテキストヘルプ

- [ジョブ定義 - インベントリー - ナビゲーションパネル]](/configuration-inventory-navigation)
- [実行計画](/daily-plan)
- [オブジェクト命名規則](/object-naming-rules)
- [正規表現](https://en.wikipedia.org/wiki/Regular_expression)

###Product Knowledge Base

- [JS7 - File Watching](https://kb.sos-berlin.com/display/JS7/JS7+-+File+Watching)
- [tzデータベースのタイムゾーン一覧](https://en.wikipedia.org/wiki/List_of_tz_database_time_zones)

