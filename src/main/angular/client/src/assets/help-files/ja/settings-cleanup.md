# 設定 - クリーンアップ

以下の設定が[Cleanup Service](/service-cleanup) に適用されます. 変更は即座に有効になります.

メニューバーの ![wheel icon](assets/images/wheel.png) アイコンから *設定* ページにアクセスできます。

## 開始時間の設定

### 設定： *time_zone*, デフォルト： *UTC

クリーンアップ・サービスの開始時間と期間に適用されるタイム・ゾーンを指定します。

### 設定します： *期間

クリーンアップサービスを実行する平日を指定します。週の初めは月曜日とします。JS7の初期インストール時のデフォルト値は1,2,3,4,5,6,7を指定します。平日が指定されていない場合、クリーンアップサービスは開始されません。

ほとんどの場合、クリーンアップ・サービスを毎日実行することをお勧めします。毎日のジョブ実行が24時間非常に集中する場合や、週末にオフピーク時間帯がある場合などは例外となります。

### 設定 *period_begin*、デフォルト： *01:00:00*

関連する*タイムゾーン*でのクリーンアップ・サービスの開始時刻を指定します。

### 設定します： *period_end*、デフォルト *04:00:00*

関連する *タイムゾーン* でクリーンアップ・サービスの実行が許可される期間の終了時刻を指定します。ほとんどの場合、クリーンアップ・サービスは指定された時間前にデータベースのパージを完了します。ただし、*履歴サービス*からのアクティビティを検出すると、クリーンアップ サービスは停止し、後で再起動します。クリーンアップ サービスは、指示された *期間終了* を超えて実行し続けることはありません。

### 設定： *force_cleanup*, Default： *false*。

true*に設定すると、指定された*Period Begin*時にクリーンアップ・サービスが強制的に実行されます。既定では、履歴サービスのアクティビティを検出すると、クリーンアップ・サービスは停止します。この設定により、Cleanup Service は設定可能な期間、履歴サービスを一時停止できます。

true*に設定すると、次の設定が考慮されます：

- **履歴サービスを一時停止する期間。
- **history_pause\_delay**: 履歴サービスが一時停止から再開された後、クリーンアップ・ サービスが再開するまで待つ遅延。

クリーンアップ・サービスがアクティブになるのに十分な履歴サービスのアイドル時間がない状態で24時間365日ジョブを実行しているユーザは、クリーンアップ・サービスを強制的に実行する設定を有効にしてください。データベースのパージが行われない場合、パフォーマンスが低下し、データベースのリソース消費量が増加します。

### 設定 *history_pause_duration*, Default： *60*s

force_cleanup*設定が*true*に設定されている場合、履歴サービスは指定された期間またはクリーンアップの完了のどちらか早い方の期間、一時停止されます。履歴サービスが一時停止している間、JOCコックピットではオーダーとタスクの実行に関する新しい履歴エントリは利用できません。履歴サービスの一時停止が完了すると、保留中の履歴はすべて処理されます。

### 設定 *設定：history_pause_delay*、デフォルト： *30*s

force_cleanup*設定が*true*に設定され、履歴サービスの一時停止が完了すると、クリーンアップ・サービスは指定された遅延時間待機し、さらにデータベースのパージが必要な場合は再起動します。

## データベース接続設定

### 設定 *batch_size*, デフォルト： *1000*

単一トランザクション内でパージされるレコード数を指定します。この値を大きくするとパフォーマンスが向上しますが、同時に、サービスがデータベース上で並行して動作している場合、同時実行トランザクションとの競合のリスクが高まります。

### 設定： *max_pool_size*、デフォルト： *8*

サービスが使用する並列データベース接続の最大数を指定します。

## 保持期間の設定

### 設定 *order_history_age*, オーダー： *90*d

[Order History](/history-orders) および[Task History](/history-tasks) の保存期間を指定します。指定された値より古い履歴エントリはすべて削除されます。

### 設定： *order_history_logs_age*, Default： *90*d

オーダーとタスクのログの保存期間を指定します。指定された値より古いログはすべて削除されます。この値が*cleanup_order_history\_age*設定の値を超えないと、JOCコックピットGUIでログへのナビゲーションを提供できないことに注意してください。

### 設定： *file_transfer_history_age*、デフォルト： *90*d

[File Transfer History](/history-file-transfers) の保存期間を指定します。指定された値より古いエントリは消去されます。

### 設定 *audit_log_age*, Default： *90*d

[Audit Log](/audit-log) の保存期間を指定します。 指定された値より古い監査ログ・エントリはパージされます。

### 設定： *daily_plan_history_age*、デフォルト： *30*d

[Daily Plan](/daily-plan) を持つ提出履歴の保存期間を指定します。 指定された値より古い履歴エントリはパージされます。

### 設定： *monitoring_history_age*, Default： *1*d

Monitor*ビューのエントリの保持期間を指定します。これは戦術的なビューであることを示唆するため、これより長い保持期間は推奨されません。

### 設定 *notification_history_age*、デフォルト： *1*d

ジョブ・エラーや警告などに関する通知の保存期間を指定します。通知は通常その日のうちに処理されるため、これより長い保存期間は推奨されません。

### 設定： *profile_age*、デフォルト： *365*d

未使用の[Profiles](/profile) 、つまり指定された期間にログインしなかったユーザ・アカウントのプロファイルの保持期間を指定します。

### 設定： *設定: failed_login_history*, Default： *90*d

失敗したログインの履歴の保存期間を指定します。指定された期間より前に発生した失敗したログインはパージされます。

### 設定 *reporting_age*, Default： *365*d

[Reports](/reports) の保存期間を指定します。

### 設定： *deployment_history_versions*、デフォルト： *10*

デプロイされたオブジェクトごとに保持するバージョン数を指定します。バージョンは、以前の状態からオブジェクトを再デプロイするために使用できます。デプロイ済みオブジェクトの以前のデプロイ済みバージョンは削除されます。

## 参照

### コンテキストヘルプ

-[Audit Log](/audit-log)
-[Daily Plan](/daily-plan)
-[Daily Plan - Projections](/daily-plan-projections)
-[Profile](/profile)
-[Reports](/reports)
-[Resources - Notice Boards](/resources-notice-boards)
-[Cleanup Service](/service-cleanup)
-[Settings](/settings)

###Product Knowledge Base

-[JS7 - Settings](https://kb.sos-berlin.com/display/JS7/JS7+-+Settings)

