# 設定 - Cleanup

以下の設定が[クリーンアップサービス](/service-cleanup) に適用されます. 変更は即座に有効になります。

メニューバーのホイールアイコンから *設定* ページにアクセスできます。

## 開始時間の設定

### 設定： *time_zone*, Default： *UTC*

クリーンアップサービスの開始時間と期間に適用されるタイム・ゾーンを指定します。日本時間では *Asia/Tokyo* を指定します。

### 設定： *Period*

クリーンアップサービスを実行する平日を指定します。週の初めは月曜日とします。JS7の初期インストール時のデフォルト値は1,2,3,4,5,6,7を指定します。平日が指定されていない場合、クリーンアップサービスは開始されません。

ほとんどの場合、クリーンアップ・サービスを毎日実行することをお勧めします。毎日のジョブ実行が24時間非常に集中する場合や、週末にオフピーク時間帯がある場合などは例外となります。

### 設定： *period_begin*, Default： *01:00:00*

関連する*タイムゾーン*でのクリーンアップサービスの実行開始時刻を指定します。

### 設定： *period_end*, Default： *04:00:00*

関連する *タイムゾーン* でクリーンアップサービスの実行が許可される期間の終了時刻を指定します。ほとんどの場合、クリーンアップサービスは指定された時間前にデータベースのパージを完了します。ただし、*Historyサービス*の実行を検出すると、クリーンアップサービスは停止し、後で再起動します。クリーンアップサービスは、指示された *期間終了* を超えて実行し続けることはありません。

### 設定： *force_cleanup*, Default： *false*

*true*に設定すると、指定された*Period Begin*時にクリーンアップサービスが強制的に実行されます。デフォルトでは、Historyサービスの実行を検出すると、クリーンアップサービスは停止します。この設定により、クリーンアップサービスは設定可能な期間、Historyサービスを一時停止できます。

*true*に設定すると、次の設定が考慮されます：

- **history_pause_duration**：Historyサービスが一時停止する期間。
- **history_pause_delay**: Historyサービスが一時停止から再開された後、クリーンアップ・サービスが再開するまでの待ち時間。

クリーンアップサービスがアクティブになるのに十分なHistoryサービスのアイドル時間がない状態で24時間365日ジョブを実行しているユーザーは、クリーンアップサービスを強制的に実行する設定を有効にしてください。データベースのパージが行われない場合、パフォーマンスが低下し、データベースのリソース消費量が増加します。

### 設定 *history_pause_duration*, Default： *60*s

*force_cleanup*設定が*true*に設定されている場合、Historyサービスは指定された期間またはクリーンアップの完了のどちらか早い方の期間、一時停止されます。Historyサービスが一時停止している間、JOCコックピットではオーダーとタスクの実行に関する新しい履歴エントリは利用できません。Historyサービスの一時停止が終了すると、保留中の履歴はすべて処理されます。

### 設定： *history_pause_delay*, Default： *30*s

*force_cleanup*設定が*true*に設定され、履歴サービスの一時停止が終了すると、クリーンアップサービスは指定された遅延時間待機し、さらにデータベースの消去が必要な場合は再起動します。

## データベース接続設定

### 設定： *batch_size*, Default： *1000*

単一トランザクション内で消去されるレコード数を指定します。この値を大きくするとパフォーマンスが向上しますが、同時に、サービスがデータベース上で並行して動作している場合、同時実行トランザクションとの競合のリスクが高まります。

### 設定： *max_pool_size*, Default： *8*

サービスが使用する並列データベース接続の最大数を指定します。

## 保持期間の設定

### 設定： *order_history_age*, Default： *90*d

[オーダー履歴](/history-orders) および[タスク履歴](/history-tasks) の保存期間を指定します。指定された値より古い履歴エントリはすべて削除されます。

### 設定： *order_history_logs_age*, Default： *90*d

オーダーとタスクのログの保存期間を指定します。指定された値より古いログはすべて削除されます。この値が*cleanup_order_history_age*設定の値を超えないと、JOCコックピットGUIでログへのナビゲーションを提供できないことに注意してください。

### 設定： *file_transfer_history_age*, Default： *90*d

[ファイル転送履歴](/history-file-transfers) の保存期間を指定します。指定された値より古いエントリは消去されます。

### 設定： *audit_log_age*, Default： *90*d

[操作履歴](/audit-log) の保存期間を指定します。 指定された値より古いエントリは消去
されます。

### 設定： *daily_plan_history_age*, Default： *30*d

[Daily Planサービス](/daily-plan) の保存期間を指定します。 指定された値より古い履歴エントリは消去されます。

### 設定： *monitoring_history_age*, Default： *1*d

*モニター* ビューの保持期間を指定します。これは戦術的なビューであることを示唆するため、これより長い保持期間は推奨されません。

### 設定：*notification_history_age*, Default： *1*d

ジョブエラーや警告などに関する通知の保存期間を指定します。通知は通常その日のうちに処理されるため、これより長い保存期間は推奨されません。

### 設定： *profile_age*, Default： *365*d

未使用の[プロファイル](/profile) 、つまり指定された期間にログインしなかったユーザ・アカウントのプロファイルの保持期間を指定します。

### 設定： *failed_login_history*, Default： *90*d

失敗したログインの履歴の保存期間を指定します。指定された期間より前に発生した失敗したログインは消去されます。

### 設定： *reporting_age*, Default： *365*d

[レポート](/reports) の保存期間を指定します。

### 設定： *deployment_history_versions*, Default： *10*

デプロイされたオブジェクトごとに保持するバージョン数を指定します。バージョンは、以前の状態からオブジェクトを再デプロイするために使用できます。デプロイ済みオブジェクトの以前のデプロイ済みバージョンは削除されます。

## 参照

### コンテキストヘルプ

- [操作ログ](/audit-log)
- [実行計画](/daily-plan)
- [実行計画 - プロジェクション](/daily-plan-projections)
- [プロファイル](/profile)
- [レポート](/reports)
- [リソース - 通知ボード](/resources-notice-boards)
- [クリーンアップサービス](/service-cleanup)
- [設定](/settings)

###Product Knowledge Base

- [JS7 - Settings](https://kb.sos-berlin.com/display/JS7/JS7+-+Settings)

