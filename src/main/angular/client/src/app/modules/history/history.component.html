<div class="white box-shadow sub-header">
  <div class="row">
    <div class="col-md-12">
      <div class="padding">
        <div class="text-right ">
          <div class="pull-left">
            <app-breadcrumbs></app-breadcrumbs>
          </div>
          <div class="inline valign">
            <label nz-checkbox [(ngModel)]="historyFilters.current" name="current" (ngModelChange)="changeController()">
              {{'common.label.currentController' | translate}}
            </label>
          </div>
          <div class="hide" [ngClass]="{'show-block':historyFilters.type == 'ORDER'}">
            <div class="btn-group m-l-12 hidden-btn-group">
              <button [disabled]="savedHistoryFilter.selected" class="btn btn-grey btn-sm button-group-ellipsis"
                      (click)="loadHistory('STATE','ALL')"
                      [ngClass]="{'btn-primary': order.filter.historyStates=='ALL'}" translate>common.button.allStatus
              </button>
              <button [disabled]="savedHistoryFilter.selected" class="btn btn-grey btn-sm button-group-ellipsis"
                      (click)="loadHistory('STATE','SUCCESSFUL')"
                      [ngClass]="{'btn-primary': order.filter.historyStates=='SUCCESSFUL'}" translate>
                common.button.successful
              </button>
              <button [disabled]="savedHistoryFilter.selected" class="btn btn-grey btn-sm button-group-ellipsis"
                      (click)="loadHistory('STATE','FAILED')"
                      [ngClass]="{'btn-primary': order.filter.historyStates=='FAILED'}" translate>common.button.failed
              </button>
              <button [disabled]="savedHistoryFilter.selected" class="btn btn-grey btn-sm button-group-ellipsis"
                      (click)="loadHistory('STATE','INCOMPLETE')"
                      [ngClass]="{'btn-primary': order.filter.historyStates=='INCOMPLETE'}" translate>
                common.button.incomplete
              </button>
            </div>
            <div class="btn-group dropdown hidden-dropdown">
              <button class="btn btn-grey btn-sm m-l-12" nz-dropdown nzTrigger="click" [nzDropdownMenu]="state"
                      [nzPlacement]="'bottomRight'" translate>common.label.state
                <i nz-icon nzType="caret-down" nzTheme="outline" class="caretDownIcon"></i>
              </button>
              <nz-dropdown-menu #state="nzDropdownMenu">
                <ul nz-menu>
                  <li nz-menu-item
                      [ngClass]="{'ant-select-dropdown-menu-item-active': order.filter.historyStates=='ALL', 'disable-link':savedHistoryFilter.selected}">
                    <a (click)="loadHistory('STATE','ALL')"
                       translate>common.button.allStatus
                    </a>
                  </li>
                  <li nz-menu-item
                      [ngClass]="{'ant-select-dropdown-menu-item-active': order.filter.historyStates=='SUCCESSFUL', 'disable-link':savedHistoryFilter.selected}">
                    <a (click)="loadHistory('STATE','SUCCESSFUL')"
                       translate>common.button.successful
                    </a>
                  </li>
                  <li nz-menu-item
                      [ngClass]="{'ant-select-dropdown-menu-item-active': order.filter.historyStates=='FAILED', 'disable-link':savedHistoryFilter.selected}">
                    <a (click)="loadHistory('STATE','FAILED')"
                       translate>common.button.failed
                    </a>
                  </li>
                  <li nz-menu-item
                      [ngClass]="{'ant-select-dropdown-menu-item-active': order.filter.historyStates=='INCOMPLETE', 'disable-link':savedHistoryFilter.selected}">
                    <a (click)="loadHistory('STATE','INCOMPLETE')"
                       translate>common.button.incomplete
                    </a>
                  </li>
                </ul>
              </nz-dropdown-menu>
            </div>
          </div>
          <div class="inline break-line" *ngIf="historyFilters.type == 'ORDER'">
            <div class="btn-group m-l-12 hidden-btn-group">
              <ng-container *ngFor="let btn of filterBtn">
                <button [disabled]="savedHistoryFilter.selected" class="btn btn-grey btn-sm button-group-ellipsis"
                        [ngClass]="{'btn-primary': order.filter.date===btn.date}"
                        (click)="loadHistory('DATE', btn.date)" translate>filters.button.{{btn.text}}
                </button>
              </ng-container>
            </div>
            <div class="btn-group dropdown hidden-dropdown">
              <button class="btn btn-grey btn-sm m-l-12" nz-dropdown nzTrigger="click" [nzDropdownMenu]="anyDate"
                      [nzPlacement]="'bottomRight'" type="button" translate>
                common.label.anyDate
                <i nz-icon nzType="caret-down" nzTheme="outline" class="caretDownIcon"></i>
              </button>
              <nz-dropdown-menu #anyDate="nzDropdownMenu">
                <ul nz-menu>
                  <ng-container *ngFor="let btn of filterBtn">
                    <li nz-menu-item
                        [ngClass]="{'ant-select-dropdown-menu-item-active': order.filter.date==btn.date, 'disable-link':savedHistoryFilter.selected}">
                      <a (click)="loadHistory('DATE',btn.date)"
                         translate>filters.button.{{btn.text}}
                      </a>
                    </li>
                  </ng-container>
                </ul>
              </nz-dropdown-menu>
            </div>
            <div class="btn-group dropdown" *ngIf="permission.joc && permission.joc.administration.customization.view">
              <button class="btn btn-grey btn-sm m-l-12" [nz-tooltip]="selectedFiltered1.account" nz-dropdown
                      nzTrigger="click" [nzDropdownMenu]="customization" [nzPlacement]="'bottomRight'" type="button"
                      translate>{{'customization.label.customizations' | translate}}
                <span class="text-primary" [innerHtml]="selectedFiltered1.name"></span>
                <i nz-icon nzType="caret-down" nzTheme="outline" class="caretDownIcon"></i>
              </button>
              <nz-dropdown-menu #customization="nzDropdownMenu">
                <ul nz-menu>
                  <li nz-menu-item *ngIf="permission.joc && permission.joc.administration.customization.manage">
                    <a (click)="createCustomization()" translate>customization.label.createCustomization</a>
                  </li>
                  <li nz-menu-item *ngIf="orderHistoryFilterList && orderHistoryFilterList.length>0">
                    <a (click)="editFilters()" translate>customization.label.editExistingCustomizations</a>
                  </li>
                  <li nz-menu-divider *ngIf="orderHistoryFilterList && orderHistoryFilterList.length>0"></li>
                  <li nz-menu-item *ngFor="let filter of orderHistoryFilterList | orderBy: 'name'"
                      [ngClass]="{'ant-select-dropdown-menu-item-active': (savedHistoryFilter.selected == filter.id)}">
                    <a (click)="changeFilter(filter)">
                      <span [nz-tooltip]="filter.account">{{filter.name}}</span>
                      <i (click)="changeFilter(null);$event.stopPropagation();"
                         *ngIf="savedHistoryFilter.selected == filter.id" class="fa fa-times-circle-o remove"
                         [nz-tooltip]="'customization.tooltip.deactivateCustomization' | translate"></i>
                    </a>
                  </li>
                </ul>
              </nz-dropdown-menu>
            </div>
          </div>
          <div class="hide" [ngClass]="{'show-block':historyFilters.type == 'TASK'}">
            <div class="btn-group m-l-12 hidden-btn-group">
              <button [disabled]="savedJobHistoryFilter.selected" class="btn btn-grey btn-sm button-group-ellipsis"
                      (click)="loadHistory('STATE','ALL')"
                      [ngClass]="{'btn-primary': task.filter.historyStates=='ALL'}" translate>common.button.allStatus
              </button>
              <button [disabled]="savedJobHistoryFilter.selected" class="btn btn-grey btn-sm button-group-ellipsis"
                      (click)="loadHistory('STATE','SUCCESSFUL')"
                      [ngClass]="{'btn-primary': task.filter.historyStates=='SUCCESSFUL'}" translate>
                common.button.successful
              </button>
              <button [disabled]="savedJobHistoryFilter.selected" class="btn btn-grey btn-sm button-group-ellipsis"
                      (click)="loadHistory('STATE','FAILED')"
                      [ngClass]="{'btn-primary': task.filter.historyStates=='FAILED'}" translate>common.button.failed
              </button>
              <button [disabled]="savedJobHistoryFilter.selected" class="btn btn-grey btn-sm button-group-ellipsis"
                      (click)="loadHistory('STATE','INCOMPLETE')"
                      [ngClass]="{'btn-primary': task.filter.historyStates=='INCOMPLETE'}" translate>
                common.button.incomplete
              </button>
            </div>
            <div class="btn-group dropdown hidden-dropdown">
              <button class="btn btn-grey btn-sm m-l-12" nz-dropdown nzTrigger="click" [nzDropdownMenu]="state2"
                      [nzPlacement]="'bottomRight'" translate>common.label.state
                <i nz-icon nzType="caret-down" nzTheme="outline" class="caretDownIcon"></i>
              </button>
              <nz-dropdown-menu #state2="nzDropdownMenu">
                <ul nz-menu>
                  <li nz-menu-item
                      [ngClass]="{'ant-select-dropdown-menu-item-active': task.filter.historyStates=='ALL', 'disable-link':savedJobHistoryFilter.selected}">
                    <a (click)="loadHistory('STATE','ALL')"
                       translate>common.button.allStatus
                    </a>
                  </li>
                  <li nz-menu-item
                      [ngClass]="{'ant-select-dropdown-menu-item-active': task.filter.historyStates=='SUCCESSFUL', 'disable-link':savedJobHistoryFilter.selected}">
                    <a (click)="loadHistory('STATE','SUCCESSFUL')"
                       translate>common.button.successful
                    </a>
                  </li>
                  <li nz-menu-item
                      [ngClass]="{'ant-select-dropdown-menu-item-active': task.filter.historyStates=='FAILED', 'disable-link':savedJobHistoryFilter.selected}">
                    <a (click)="loadHistory('STATE','FAILED')"
                       translate>common.button.failed
                    </a>
                  </li>
                  <li nz-menu-item
                      [ngClass]="{'ant-select-dropdown-menu-item-active': task.filter.historyStates=='INCOMPLETE', 'disable-link':savedJobHistoryFilter.selected}">
                    <a (click)="loadHistory('STATE','INCOMPLETE')"
                       translate>common.button.incomplete
                    </a>
                  </li>
                </ul>
              </nz-dropdown-menu>
            </div>
          </div>
          <div class="inline break-line" *ngIf="historyFilters.type == 'TASK'">
            <div class="btn-group m-l-12 hidden-btn-group">
              <ng-container *ngFor="let btn of filterBtn">
                <button [disabled]="savedJobHistoryFilter.selected" class="btn btn-grey btn-sm button-group-ellipsis"
                        [ngClass]="{'btn-primary': task.filter.date===btn.date}"
                        (click)="loadHistory('DATE', btn.date)" translate>filters.button.{{btn.text}}
                </button>
              </ng-container>
            </div>
            <div class="btn-group dropdown hidden-dropdown">
              <button class="btn btn-grey btn-sm m-l-12" nz-dropdown nzTrigger="click" [nzDropdownMenu]="anyDate2"
                      [nzPlacement]="'bottomRight'" type="button" translate>
                common.label.anyDate
                <i nz-icon nzType="caret-down" nzTheme="outline" class="caretDownIcon"></i>
              </button>
              <nz-dropdown-menu #anyDate2="nzDropdownMenu">
                <ul nz-menu>
                  <ng-container *ngFor="let btn of filterBtn">
                    <li nz-menu-item
                        [ngClass]="{'ant-select-dropdown-menu-item-active': task.filter.date==btn.date, 'disable-link':savedJobHistoryFilter.selected}">
                      <a (click)="loadHistory('DATE',btn.date)"
                         translate>filters.button.{{btn.text}}
                      </a>
                    </li>
                  </ng-container>
                </ul>
              </nz-dropdown-menu>
            </div>
            <div class="btn-group dropdown" *ngIf="permission.joc && permission.joc.administration.customization.view">
              <button class="btn btn-grey btn-sm m-l-12" [nz-tooltip]="selectedFiltered2.account" nz-dropdown
                      nzTrigger="click" [nzDropdownMenu]="customization2" [nzPlacement]="'bottomRight'" type="button"
                      translate>
                {{'customization.label.customizations' | translate}} <span class="text-primary"
                                                                           [innerHtml]="selectedFiltered2.name"></span>
                <i nz-icon nzType="caret-down" nzTheme="outline" class="caretDownIcon"></i>
              </button>
              <nz-dropdown-menu #customization2="nzDropdownMenu">
                <ul nz-menu>
                  <li nz-menu-item *ngIf="permission.joc && permission.joc.administration.customization.manage">
                    <a (click)="createCustomization()" translate>customization.label.createCustomization</a>
                  </li>
                  <li nz-menu-item *ngIf="jobHistoryFilterList && jobHistoryFilterList.length>0">
                    <a (click)="editFilters()" translate>customization.label.editExistingCustomizations</a>
                  </li>
                  <li nz-menu-divider *ngIf="jobHistoryFilterList && jobHistoryFilterList.length>0"></li>
                  <li nz-menu-item *ngFor="let filter of jobHistoryFilterList | orderBy: 'name'"
                      [ngClass]="{'ant-select-dropdown-menu-item-active': (savedJobHistoryFilter.selected == filter.id)}">
                    <a (click)="changeFilter(filter)">
                      <span [nz-tooltip]="filter.account">{{filter.name}}</span>
                      <i (click)="changeFilter(null);$event.stopPropagation();"
                         *ngIf="savedJobHistoryFilter.selected == filter.id" class="fa fa-times-circle-o remove"
                         [nz-tooltip]="'customization.tooltip.deactivateCustomization' | translate"></i>
                    </a>
                  </li>
                </ul>
              </nz-dropdown-menu>
            </div>
          </div>
          <div class="hide" [ngClass]="{'show-block':historyFilters.type == 'YADE'}">
            <div class="btn-group m-l-12 hidden-btn-group">
              <button [disabled]="savedYadeHistoryFilter.selected" class="btn btn-grey btn-sm button-group-ellipsis"
                      (click)="loadHistory('STATE','ALL')"
                      [ngClass]="{'btn-primary': yade.filter.states=='ALL'}" translate>common.button.allStatus
              </button>
              <button [disabled]="savedYadeHistoryFilter.selected" class="btn btn-grey btn-sm button-group-ellipsis"
                      (click)="loadHistory('STATE','SUCCESSFUL')"
                      [ngClass]="{'btn-primary': yade.filter.states=='SUCCESSFUL'}" translate>common.button.successful
              </button>
              <button [disabled]="savedYadeHistoryFilter.selected" class="btn btn-grey btn-sm button-group-ellipsis"
                      (click)="loadHistory('STATE','FAILED')"
                      [ngClass]="{'btn-primary': yade.filter.states=='FAILED'}" translate>common.button.failed
              </button>
              <button [disabled]="savedYadeHistoryFilter.selected" class="btn btn-grey btn-sm button-group-ellipsis"
                      (click)="loadHistory('STATE','INCOMPLETE')"
                      [ngClass]="{'btn-primary': yade.filter.states=='INCOMPLETE'}" translate>common.button.incomplete
              </button>
            </div>
            <div class="btn-group dropdown hidden-dropdown">
              <button class="btn btn-grey btn-sm m-l-12" nz-dropdown nzTrigger="click" [nzDropdownMenu]="state3" [nzPlacement]="'bottomRight'" translate>label.state
                <i nz-icon nzType="caret-down" nzTheme="outline" class="caretDownIcon"></i>
              </button>
              <nz-dropdown-menu #state3="nzDropdownMenu" >
                <ul nz-menu>
                  <li nz-menu-item  [ngClass]="{'ant-select-dropdown-menu-item-active': yade.filter.states=='ALL', 'disable-link':savedYadeHistoryFilter.selected}">
                    <a (click)="loadHistory('STATE','ALL')"
                       translate>common.button.allStatus
                    </a>
                  </li>
                  <li nz-menu-item  [ngClass]="{'ant-select-dropdown-menu-item-active':yade.filter.states=='SUCCESSFUL', 'disable-link':savedYadeHistoryFilter.selected}">
                    <a (click)="loadHistory('STATE','SUCCESSFUL')"
                       translate>common.button.successful
                    </a>
                  </li>
                  <li nz-menu-item  [ngClass]="{'ant-select-dropdown-menu-item-active': yade.filter.states=='FAILED', 'disable-link':savedYadeHistoryFilter.selected}">
                    <a (click)="loadHistory('STATE','FAILED')"
                       translate>common.button.failed
                    </a>
                  </li>
                  <li nz-menu-item  [ngClass]="{'ant-select-dropdown-menu-item-active': yade.filter.states=='INCOMPLETE', 'disable-link':savedYadeHistoryFilter.selected}">
                    <a (click)="loadHistory('STATE','INCOMPLETE')"
                       translate>common.button.incomplete
                    </a>
                  </li>
                </ul>
              </nz-dropdown-menu>
            </div>
            <div class="btn-group m-l-12 hidden-btn-group">
              <ng-container *ngFor="let btn of filterBtn">
                <button [disabled]="savedYadeHistoryFilter.selected" class="btn btn-grey btn-sm button-group-ellipsis"
                        [ngClass]="{'btn-primary': yade.filter.date===btn.date}"
                        (click)="loadHistory('DATE', btn.date)" translate>filters.button.{{btn.text}}
                </button>
              </ng-container>
            </div>
            <div class="btn-group dropdown hidden-dropdown">
                  <button class="btn btn-grey btn-sm m-l-12" nz-dropdown nzTrigger="click" [nzDropdownMenu]="anyDate"
                          [nzPlacement]="'bottomRight'" type="button" translate>
                    common.label.anyDate
                    <i nz-icon nzType="caret-down" nzTheme="outline" class="caretDownIcon"></i>
                  </button>
                  <nz-dropdown-menu #anyDate="nzDropdownMenu">
                    <ul nz-menu>
                      <ng-container *ngFor="let btn of filterBtn">
                        <li nz-menu-item
                            [ngClass]="{'ant-select-dropdown-menu-item-active': yade.filter.date==btn.date, 'disable-link':savedYadeHistoryFilter.selected}">
                          <a (click)="loadHistory('DATE',btn.date)"
                             translate>filters.button.{{btn.text}}
                          </a>
                        </li>
                      </ng-container>
                    </ul>
                  </nz-dropdown-menu>
                </div>
          </div>
          <div class="inline break-line" *ngIf="historyFilters.type == 'YADE'">
             <div class="btn-group dropdown" *ngIf="permission.joc && permission.joc.administration.customization.view">
              <button class="btn btn-grey btn-sm m-l-12" [nz-tooltip]="selectedFiltered3.account" nz-dropdown
                      nzTrigger="click" [nzDropdownMenu]="customization3" [nzPlacement]="'bottomRight'" type="button"
                      translate>
                {{'customization.label.customizations' | translate}} <span class="text-primary"
                                                                           [innerHtml]="selectedFiltered3.name"></span>
                <i nz-icon nzType="caret-down" nzTheme="outline" class="caretDownIcon"></i>
              </button>
              <nz-dropdown-menu #customization3="nzDropdownMenu">
                <ul nz-menu>
                  <li nz-menu-item *ngIf="permission.joc && permission.joc.administration.customization.manage">
                    <a (click)="createCustomization()" translate>customization.label.createCustomization</a>
                  </li>
                  <li nz-menu-item *ngIf="yadeHistoryFilterList && yadeHistoryFilterList.length>0">
                    <a (click)="editFilters()" translate>customization.label.editExistingCustomizations</a>
                  </li>
                  <li nz-menu-divider *ngIf="yadeHistoryFilterList && yadeHistoryFilterList.length>0"></li>
                  <li nz-menu-item *ngFor="let filter of yadeHistoryFilterList | orderBy: 'name'"
                      [ngClass]="{'ant-select-dropdown-menu-item-active': (savedYadeHistoryFilter.selected == filter.id)}">
                    <a (click)="changeFilter(filter)">
                      <span [nz-tooltip]="filter.account">{{filter.name}}</span>
                      <i (click)="changeFilter(null);$event.stopPropagation();"
                         *ngIf="savedYadeHistoryFilter.selected == filter.id" class="fa fa-times-circle-o remove"
                         [nz-tooltip]="'customization.tooltip.deactivateCustomization' | translate"></i>
                    </a>
                  </li>
                </ul>
              </nz-dropdown-menu>
            </div>
          </div>
          <div class="hide" [ngClass]="{'show-block':historyFilters.type == 'DEPLOYMENT'}">
            <div class="btn-group m-l-12 hidden-btn-group">
              <button [disabled]="savedDeploymentHistoryFilter.selected"
                      class="btn btn-grey btn-sm button-group-ellipsis"
                      (click)="loadHistory('STATE','ALL')"
                      [ngClass]="{'btn-primary': deployment.filter.state=='ALL'}" translate>history.button.allState
              </button>
              <button [disabled]="savedDeploymentHistoryFilter.selected"
                      class="btn btn-grey btn-sm button-group-ellipsis"
                      (click)="loadHistory('STATE','DEPLOYED')"
                      [ngClass]="{'btn-primary': deployment.filter.state=='DEPLOYED'}" translate>history.button.deployed
              </button>
              <button [disabled]="savedDeploymentHistoryFilter.selected"
                      class="btn btn-grey btn-sm button-group-ellipsis"
                      (click)="loadHistory('STATE','NOT_DEPLOYED')"
                      [ngClass]="{'btn-primary': deployment.filter.state=='NOT_DEPLOYED'}" translate>
                history.button.notDeployed
              </button>
            </div>
            <div class="btn-group dropdown hidden-dropdown">
              <button class="btn btn-grey btn-sm m-l-12" nz-dropdown nzTrigger="click" [nzDropdownMenu]="state"
                      [nzPlacement]="'bottomRight'" translate>common.label.state
                <i nz-icon nzType="caret-down" nzTheme="outline" class="caretDownIcon"></i>
              </button>
              <nz-dropdown-menu #state="nzDropdownMenu">
                <ul nz-menu>
                  <li nz-menu-item
                      [ngClass]="{'ant-select-dropdown-menu-item-active': deployment.filter.state=='ALL', 'disable-link':savedDeploymentHistoryFilter.selected}">
                    <a (click)="loadHistory('STATE','ALL')"
                       translate>history.button.allState
                    </a>
                  </li>
                  <li nz-menu-item
                      [ngClass]="{'ant-select-dropdown-menu-item-active': deployment.filter.state=='DEPLOYED', 'disable-link':savedDeploymentHistoryFilter.selected}">
                    <a (click)="loadHistory('STATE','DEPLOYED')"
                       translate>history.button.deployed
                    </a>
                  </li>
                  <li nz-menu-item
                      [ngClass]="{'ant-select-dropdown-menu-item-active': deployment.filter.state=='NOT_DEPLOYED', 'disable-link':savedDeploymentHistoryFilter.selected}">
                    <a (click)="loadHistory('STATE','NOT_DEPLOYED')"
                       translate>history.button.notDeployed
                    </a>
                  </li>
                </ul>
              </nz-dropdown-menu>
            </div>
          </div>
          <div class="inline break-line" *ngIf="historyFilters.type == 'DEPLOYMENT'">
            <div class="btn-group m-l-12 hidden-btn-group">
              <ng-container *ngFor="let btn of filterBtn">
                <button [disabled]="savedDeploymentHistoryFilter.selected"
                        class="btn btn-grey btn-sm button-group-ellipsis"
                        [ngClass]="{'btn-primary': deployment.filter.date===btn.date}"
                        (click)="loadHistory('DATE', btn.date)" translate>filters.button.{{btn.text}}
                </button>
              </ng-container>
            </div>
            <div class="btn-group dropdown hidden-dropdown">
              <button class="btn btn-grey btn-sm m-l-12" nz-dropdown nzTrigger="click" [nzDropdownMenu]="anyDate"
                      [nzPlacement]="'bottomRight'" type="button" translate>
                common.label.anyDate
                <i nz-icon nzType="caret-down" nzTheme="outline" class="caretDownIcon"></i>
              </button>
              <nz-dropdown-menu #anyDate="nzDropdownMenu">
                <ul nz-menu>
                  <ng-container *ngFor="let btn of filterBtn">
                    <li nz-menu-item
                        [ngClass]="{'ant-select-dropdown-menu-item-active': deployment.filter.date==btn.date, 'disable-link':savedDeploymentHistoryFilter.selected}">
                      <a (click)="loadHistory('DATE',btn.date)"
                         translate>filters.button.{{btn.text}}
                      </a>
                    </li>
                  </ng-container>
                </ul>
              </nz-dropdown-menu>
            </div>
            <div class="btn-group dropdown" *ngIf="permission.joc && permission.joc.administration.customization.view">
              <button class="btn btn-grey btn-sm m-l-12" [nz-tooltip]="selectedFiltered4.account" nz-dropdown
                      nzTrigger="click" [nzDropdownMenu]="customization" [nzPlacement]="'bottomRight'" type="button"
                      translate>
                {{'customization.label.customizations' | translate}} <span class="text-primary"
                                                                           [innerHtml]="selectedFiltered4.name"></span>
                <i nz-icon nzType="caret-down" nzTheme="outline" class="caretDownIcon"></i>
              </button>
              <nz-dropdown-menu #customization="nzDropdownMenu">
                <ul nz-menu>
                  <li nz-menu-item *ngIf="permission.joc && permission.joc.administration.customization.manage">
                    <a (click)="createCustomization()" translate>customization.label.createCustomization</a>
                  </li>
                  <li nz-menu-item *ngIf="deploymentHistoryFilterList && deploymentHistoryFilterList.length>0">
                    <a (click)="editFilters()" translate>customization.label.editExistingCustomizations</a>
                  </li>
                  <li nz-menu-divider *ngIf="deploymentHistoryFilterList && deploymentHistoryFilterList.length>0"></li>
                  <li nz-menu-item *ngFor="let filter of deploymentHistoryFilterList | orderBy: 'name'"
                      [ngClass]="{'ant-select-dropdown-menu-item-active': (savedDeploymentHistoryFilter.selected == filter.id)}">
                    <a (click)="changeFilter(filter)">
                      <span [nz-tooltip]="filter.account">{{filter.name}}</span>
                      <i (click)="changeFilter(null);$event.stopPropagation();"
                         *ngIf="savedDeploymentHistoryFilter.selected == filter.id" class="fa fa-times-circle-o remove"
                         [nz-tooltip]="'customization.tooltip.deactivateCustomization' | translate"></i>
                    </a>
                  </li>
                </ul>
              </nz-dropdown-menu>
            </div>
          </div>
          <div class="hide" [ngClass]="{'show-block':historyFilters.type == 'SUBMISSION'}">
            <div class="btn-group m-l-12 hidden-btn-group">
              <button [disabled]="savedSubmissionHistoryFilter.selected"
                      class="btn btn-grey btn-sm button-group-ellipsis"
                      (click)="loadHistory('CATEGORY','ALL')"
                      [ngClass]="{'btn-primary': submission.filter.category=='ALL'}" translate>common.button.all
              </button>
              <button [disabled]="savedSubmissionHistoryFilter.selected"
                      class="btn btn-grey btn-sm button-group-ellipsis"
                      (click)="loadHistory('CATEGORY','SUBMITTED')"
                      [ngClass]="{'btn-primary': submission.filter.category=='SUBMITTED'}" translate>
                history.button.submitted
              </button>
              <button [disabled]="savedSubmissionHistoryFilter.selected"
                      class="btn btn-grey btn-sm button-group-ellipsis"
                      (click)="loadHistory('CATEGORY','NOT_SUBMITTED')"
                      [ngClass]="{'btn-primary': submission.filter.category=='NOT_SUBMITTED'}" translate>
                history.button.notSubmitted
              </button>
            </div>
            <div class="btn-group dropdown hidden-dropdown">
              <button class="btn btn-grey btn-sm m-l-12" nz-dropdown nzTrigger="click" [nzDropdownMenu]="state2"
                      [nzPlacement]="'bottomRight'" translate>common.label.type
                <i nz-icon nzType="caret-down" nzTheme="outline" class="caretDownIcon"></i>
              </button>
              <nz-dropdown-menu #state2="nzDropdownMenu">
                <ul nz-menu>
                  <li nz-menu-item
                      [ngClass]="{'ant-select-dropdown-menu-item-active': submission.filter.category=='ALL', 'disable-link':savedSubmissionHistoryFilter.selected}">
                    <a (click)="loadHistory('CATEGORY','ALL')"
                       translate>common.button.all
                    </a>
                  </li>
                  <li nz-menu-item
                      [ngClass]="{'ant-select-dropdown-menu-item-active': submission.filter.category=='SUBMITTED', 'disable-link':savedSubmissionHistoryFilter.selected}">
                    <a (click)="loadHistory('CATEGORY','SUBMITTED')"
                       translate>history.button.submitted
                    </a>
                  </li>
                  <li nz-menu-item
                      [ngClass]="{'ant-select-dropdown-menu-item-active': submission.filter.category=='NOT_SUBMITTED', 'disable-link':savedSubmissionHistoryFilter.selected}">
                    <a (click)="loadHistory('CATEGORY','NOT_SUBMITTED')"
                       translate>history.button.notSubmitted
                    </a>
                  </li>
                </ul>
              </nz-dropdown-menu>
            </div>
          </div>
          <div class="inline break-line" *ngIf="historyFilters.type == 'SUBMISSION'">
            <div class="btn-group m-l-12 hidden-btn-group">
              <ng-container *ngFor="let btn of subMissionFilterBtn">
                <button [disabled]="savedSubmissionHistoryFilter.selected"
                        class="btn btn-grey btn-sm button-group-ellipsis"
                        [ngClass]="{'btn-primary': submission.filter.date===btn.date}"
                        (click)="loadHistory('DATE', btn.date)" translate>filters.button.{{btn.text}}
                </button>
              </ng-container>
            </div>
            <div class="btn-group dropdown hidden-dropdown">
              <button class="btn btn-grey btn-sm m-l-12" nz-dropdown nzTrigger="click" [nzDropdownMenu]="anyDate"
                      [nzPlacement]="'bottomRight'" type="button" translate>
                common.label.anyDate
                <i nz-icon nzType="caret-down" nzTheme="outline" class="caretDownIcon"></i>
              </button>
              <nz-dropdown-menu #anyDate="nzDropdownMenu">
                <ul nz-menu>
                  <ng-container *ngFor="let btn of subMissionFilterBtn">
                    <li nz-menu-item
                        [ngClass]="{'ant-select-dropdown-menu-item-active': submission.filter.date==btn.date, 'disable-link':savedSubmissionHistoryFilter.selected}">
                      <a (click)="loadHistory('DATE',btn.date)"
                         translate>filters.button.{{btn.text}}
                      </a>
                    </li>
                  </ng-container>
                </ul>
              </nz-dropdown-menu>
            </div>
            <div class="btn-group dropdown" *ngIf="permission.joc && permission.joc.administration.customization.view">
              <button class="btn btn-grey btn-sm m-l-12" [nz-tooltip]="selectedFiltered5.account" nz-dropdown
                      nzTrigger="click" [nzDropdownMenu]="customization" [nzPlacement]="'bottomRight'" type="button"
                      translate>
                {{'customization.label.customizations' | translate}} <span class="text-primary"
                                                                           [innerHtml]="selectedFiltered5.name"></span>
                <i nz-icon nzType="caret-down" nzTheme="outline" class="caretDownIcon"></i>
              </button>
              <nz-dropdown-menu #customization="nzDropdownMenu">
                <ul nz-menu>
                  <li nz-menu-item *ngIf="permission.joc && permission.joc.administration.customization.manage">
                    <a (click)="createCustomization()" translate>customization.label.createCustomization</a>
                  </li>
                  <li nz-menu-item *ngIf="submissionHistoryFilterList && submissionHistoryFilterList.length>0">
                    <a (click)="editFilters()" translate>customization.label.editExistingCustomizations</a>
                  </li>
                  <li nz-menu-divider *ngIf="submissionHistoryFilterList && submissionHistoryFilterList.length>0"></li>
                  <li nz-menu-item *ngFor="let filter of submissionHistoryFilterList | orderBy: 'name'"
                      [ngClass]="{'ant-select-dropdown-menu-item-active': (savedSubmissionHistoryFilter.selected == filter.id)}">
                    <a (click)="changeFilter(filter)">
                      <span [nz-tooltip]="filter.account">{{filter.name}}</span>
                      <i (click)="changeFilter(null);$event.stopPropagation();"
                         *ngIf="savedSubmissionHistoryFilter.selected == filter.id" class="fa fa-times-circle-o remove"
                         [nz-tooltip]="'customization.tooltip.deactivateCustomization' | translate"></i>
                    </a>
                  </li>
                </ul>
              </nz-dropdown-menu>
            </div>
          </div>
          <div class="btn-group dropdown" *ngIf="historyFilters.type === 'ORDER' || historyFilters.type === 'TASK'">
            <button class="btn btn-grey btn-sm m-l-12" nz-dropdown nzTrigger="click" [nzDropdownMenu]="ignoreList"
                    [nzPlacement]="'bottomRight'">
              {{'history.label.ignoreList' | translate}}
              <span class="text-primary"
                    *ngIf="savedIgnoreList.isEnable"
                    [innerHtml]="'history.label.active' | translate"></span>
              <i nz-icon nzType="caret-down" nzTheme="outline" class="caretDownIcon"></i>
            </button>
            <nz-dropdown-menu #ignoreList="nzDropdownMenu">
              <ul nz-menu>
                <li nz-menu-item *ngIf="savedIgnoreList.workflows.length > 0 && historyFilters.type == 'ORDER'">
                  <a (click)="editIgnoreList()" translate>history.button.editIgnoreList</a>
                </li>
                <li nz-menu-item *ngIf="savedIgnoreList.jobs.length > 0 && historyFilters.type == 'TASK'">
                  <a (click)="editIgnoreList()" translate>history.button.editIgnoreList</a>
                </li>
                <li nz-menu-item *ngIf="!savedIgnoreList.isEnable">
                  <a (click)="enableDisableIgnoreList()" translate>history.button.enableIgnoreList</a>
                </li>
                <li nz-menu-item *ngIf="savedIgnoreList.isEnable">
                  <a (click)="enableDisableIgnoreList()" translate>history.button.disableIgnoreList</a>
                </li>
                <li nz-menu-item>
                  <a (click)="resetIgnoreList()" translate>history.button.resetIgnoreList</a>
                </li>
              </ul>
            </nz-dropdown-menu>
          </div>
          <button class="btn btn-grey btn-sm m-l-12" [disabled]="data.length === 0"
                  [nz-tooltip]="'common.tooltip.exportInXLS' | translate"
                  (click)="exportToExcel()"><i class="fa fa fa-share-square-o"></i></button>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="scroll-y max-ht">
  <div class="padding p-b-0">
    <div class="row m-b-12 m-t-xs">
      <div class="col-md-6 col-sm-6">
        <ul class="nav navbar-nav navbar-nav-inline nav-active-border nav-active-border2 b-primary">
          <li class="nav-item" *ngIf="permission.currentController && permission.currentController.orders.view">
            <a class="nav-link" [ngClass]="{'active': historyFilters.type=='ORDER'}" (click)="orderHistory(null,false)">
              <span class="nav-text text-dark p-b-sm"><span class="text" translate>history.tab.orders</span></span>
            </a>
          </li>
          <li class="nav-item dropdown-separator" *ngIf="permission.currentController && permission.currentController.orders.view">
            <span class="separator"></span>
          </li>
          <li class="nav-item" *ngIf="permission.currentController && permission.currentController.orders.view">
            <a class="nav-link" [ngClass]="{'active': historyFilters.type=='TASK'}" (click)="taskHistory(null, false)">
              <span class="nav-text text-dark p-b-sm"><span class="text" translate>history.tab.tasks</span></span>
            </a>
          </li>
          <li class="nav-item dropdown-separator" *ngIf="permission.currentController && permission.joc.fileTransfer.view && permission.currentController.orders.view">
            <span class="separator"></span>
          </li>
          <li class="nav-item" *ngIf="permission.currentController && permission.joc.fileTransfer.view">
            <a class="nav-link" [ngClass]="{'active': historyFilters.type=='YADE'}" (click)="yadeHistory(null, false)">
              <span class="nav-text text-dark p-b-sm"><span class="text" translate>history.tab.fileTransfers</span></span>
            </a>
          </li>
          <li class="nav-item dropdown-separator" *ngIf="permission.currentController && permission.currentController.deployments.view && (permission.joc.fileTransfer.view || permission.currentController.orders.view)">
            <span class="separator"></span>
          </li>
          <li class="nav-item" *ngIf="permission.currentController && permission.currentController.deployments.view">
            <a class="nav-link" [ngClass]="{'active': historyFilters.type=='DEPLOYMENT'}" (click)="deploymentHistory(null,false)">
              <span class="nav-text text-dark p-b-sm"><span class="text" translate>history.tab.deployments</span></span>
            </a>
          </li>
          <li class="nav-item dropdown-separator" *ngIf="permission.currentController && permission.joc.dailyPlan.view && (permission.currentController.deployments.view || permission.joc.fileTransfer.view || permission.currentController.orders.view)">
            <span class="separator"></span>
          </li>
          <li class="nav-item" *ngIf="permission.currentController && permission.joc.dailyPlan.view">
            <a class="nav-link" [ngClass]="{'active': historyFilters.type=='SUBMISSION'}" (click)="submissionHistory(null, false)">
              <span class="nav-text text-dark p-b-sm"><span class="text" translate>history.tab.dailyPlan</span></span>
            </a>
          </li>
        </ul>
      </div>
      <div class="col-md-6 col-sm-6">
        <button *ngIf="historyFilters.type !== 'ORDER'" class="btn btn-sm btn-grey m-l-12 pull-right" nz-tooltip="{{'common.tooltip.collapseDetails' | translate}}" (click)="collapseDetails()">
          <i class="fa fa-compress text"></i>
        </button>
        <button *ngIf="historyFilters.type !== 'ORDER'" class="btn btn-sm btn-grey m-l-12 pull-right" nz-tooltip="{{'common.tooltip.expandDetails' | translate}}" (click)="expandDetails()" >
          <i class="fa fa-expand text" ></i>
        </button>
        <button class="btn btn-sm inline pull-right m-l-12 btn-grey" (click)="advancedSearch()" *ngIf="!showSearchPanel">
          <span translate>common.button.advancedSearch</span>
          <i class="fa fa-caret-down p-l-xs"></i>
        </button>
        <button class="btn btn-sm inline pull-right m-l-12 btn-grey" (click)="cancel()" *ngIf="showSearchPanel">
          <span translate>common.button.advancedSearch</span>
          <i class="fa fa-caret-down p-l-xs"></i>
        </button>
        <div class="search-box-field pull-right">
          <label>
            <input *ngIf="historyFilters.type === 'ORDER'" type="search" placeholder="{{'common.placeholder.search' | translate}}"
                   [(ngModel)]="order.searchText" (keyup)="searchInResult()">
          </label>
          <i *ngIf="historyFilters.type === 'ORDER'" [hidden]="!order.searchText" class="fa fa-times search-close"
             (click)="order.searchText = '';searchInResult()"></i>
          <label>
            <input *ngIf="historyFilters.type === 'TASK'" type="search" placeholder="{{'common.placeholder.search' | translate}}"
                   [(ngModel)]="task.searchText" (keyup)="searchInResult()">
          </label>
          <i *ngIf="historyFilters.type === 'TASK'" [hidden]="!task.searchText" class="fa fa-times search-close"
             (click)="task.searchText = '';searchInResult()"></i>
           <label>
            <input *ngIf="historyFilters.type === 'YADE'" type="search" placeholder="{{'common.placeholder.search' | translate}}"
                   [(ngModel)]="yade.searchText" (keyup)="searchInResult()">
          </label>
          <i *ngIf="historyFilters.type === 'YADE'" [hidden]="!yade.searchText" class="fa fa-times search-close"
             (click)="yade.searchText = '';searchInResult()"></i>
          <label>
          <label>
            <input *ngIf="historyFilters.type === 'DEPLOYMENT'" type="search" placeholder="{{'common.placeholder.search' | translate}}"
                   [(ngModel)]="deployment.searchText" (keyup)="searchInResult()">
          </label>
          <i *ngIf="historyFilters.type === 'DEPLOYMENT'" [hidden]="!deployment.searchText" class="fa fa-times search-close"
             (click)="deployment.searchText = '';searchInResult()"></i>
          <label>
            <input *ngIf="historyFilters.type === 'SUBMISSION'" type="search" placeholder="{{'common.placeholder.search' | translate}}"
                   [(ngModel)]="submission.searchText" (keyup)="searchInResult()">
          </label>
          <i *ngIf="historyFilters.type === 'SUBMISSION'" [hidden]="!submission.searchText" class="fa fa-times search-close"
             (click)="submission.searchText = '';searchInResult()"></i>
          </label>
      </div>
      </div>
    </div>
    <div class="row m-b" *ngIf="showSearchPanel">
      <div class="col-md-12">
        <div class="box p-a m-b-xs">
          <div *ngIf="historyFilters.type === 'ORDER'">
            <app-order-form-template [filter]="orderSearch" [preferences]="preferences" [schedulerIds]="schedulerIds"
                                     [permission]="permission" [allFilter]="orderHistoryFilterList"
                                     [isSearch]="true" (onCancel)="cancel()"
                                     (onSearch)="search($event)"></app-order-form-template>
          </div>
          <div *ngIf="historyFilters.type === 'TASK'">
            <app-task-form-template [filter]="jobSearch" [preferences]="preferences" [schedulerIds]="schedulerIds"
                                    [permission]="permission" [allFilter]="jobHistoryFilterList"
                                    [isSearch]="true" (onCancel)="cancel()"
                                    (onSearch)="search($event)"></app-task-form-template>
          </div>
          <div *ngIf="historyFilters.type === 'YADE'">
            <app-file-transfer-form-template [filter]="yadeSearch" [preferences]="preferences" [schedulerIds]="schedulerIds"
                                    [permission]="permission" [allFilter]="yadeHistoryFilterList" [isHistory]="true"
                                    [isSearch]="true" (onCancel)="cancel()"
                                    (onSearch)="search($event)"></app-file-transfer-form-template>
          </div>
          <div *ngIf="historyFilters.type === 'DEPLOYMENT'">
            <app-deployment-form-template [filter]="deploymentSearch" [preferences]="preferences" [schedulerIds]="schedulerIds"
                                    [permission]="permission" [allFilter]="deploymentHistoryFilterList"
                                    [isSearch]="true" (onCancel)="cancel()"
                                    (onSearch)="search($event)"></app-deployment-form-template>
          </div>
          <div *ngIf="historyFilters.type === 'SUBMISSION'">
            <app-submission-form-template [filter]="submissionSearch" [preferences]="preferences" [schedulerIds]="schedulerIds"
                                          [permission]="permission" [allFilter]="submissionHistoryFilterList"
                                          [isSearch]="true" (onCancel)="cancel()"
                                          (onSearch)="search($event)"></app-submission-form-template>
          </div>
        </div>
      </div>
    </div>
    <div class="m-t-sm box p-a" *ngIf="historyFilters.type == 'ORDER'">
      <div class="table-responsive " id="orderTable">
        <nz-table
          #ajaxOrderTable
          [nzSize]="'small'"
          [nzPageSize]="order.entryPerPage || preferences.entryPerPage"
          [nzPageIndex]="order.currentPage"
          [nzBordered]="true"
          [nzShowPagination]="data.length > 0"
          [nzData]="data | orderBy: order.filter.sortBy:order.reverse"
          [nzLoading]="!isLoading"
          [nzShowSizeChanger]="true"
          (nzPageIndexChange)="pageIndexChange($event)"
          (nzPageSizeChange)="pageSizeChange($event)"
          [nzPageSizeOptions]="[10, 25, 50, 100 , preferences.maxEntryPerPage]"
        >
          <thead>
          <tr>
            <th class=" menu"><span translate>common.label.action</span></th>
            <th class="dynamic-thead-o" *ngIf="!historyFilters.current" (click)="sort('controllerId')">
              <a><span class="p-r-xs" translate>common.label.controllerId</span>
                <i *ngIf="order.filter.sortBy == 'controllerId' && !order.reverse"
                   class="fa fa-caret-up "></i>
                <i *ngIf="order.filter.sortBy == 'controllerId' && order.reverse"
                   class="fa fa-caret-down "></i></a>
            </th>
            <th class="dynamic-thead" (click)="sort('orderId')"><a><span class="p-r-xs" translate>history.label.orderId</span>
              <i *ngIf="order.filter.sortBy == 'orderId' && !order.reverse"
                 class="fa fa-caret-up "></i>
              <i *ngIf="order.filter.sortBy == 'orderId' && order.reverse"
                 class="fa fa-caret-down "></i></a>
            </th>
            <th class="dynamic-thead" (click)="sort('workflow')"><a><span class="p-r-xs" translate>history.label.workflow</span>
              <i *ngIf="order.filter.sortBy == 'workflow' && !order.reverse"
                 class="fa fa-caret-up "></i>
              <i *ngIf="order.filter.sortBy == 'workflow' && order.reverse"
                 class="fa fa-caret-down "></i></a>
            </th>
            <th class="dynamic-thead" (click)="sort('position')"><a><span class="p-r-xs" translate>history.label.position</span>
              <i *ngIf="order.filter.sortBy == 'position' && !order.reverse"
                 class="fa fa-caret-up "></i>
              <i *ngIf="order.filter.sortBy == 'position' && order.reverse"
                 class="fa fa-caret-down "></i></a>
            </th>
            <th class="dynamic-thead" (click)="sort('state._text')"><a><span class="p-r-xs" translate>history.label.status</span>
              <i *ngIf="order.filter.sortBy == 'state._text' && !order.reverse"
                 class="fa fa-caret-up "></i>
              <i *ngIf="order.filter.sortBy == 'state._text' && order.reverse"
                 class="fa fa-caret-down "></i></a>
            </th>
            <th class="dynamic-thead" (click)="sort('orderState._text')"><a><span class="p-r-xs" translate>history.label.orderState</span>
              <i *ngIf="order.filter.sortBy == 'orderState._text' && !order.reverse"
                 class="fa fa-caret-up "></i>
              <i *ngIf="order.filter.sortBy == 'orderState._text' && order.reverse"
                 class="fa fa-caret-down "></i></a>
            </th>
            <th class="dynamic-thead" (click)="sort('plannedTime')"><a><span class="p-r-xs" translate>history.label.plannedTime</span>
              <i *ngIf="order.filter.sortBy == 'plannedTime' && !order.reverse"
                 class="fa fa-caret-up "></i>
              <i *ngIf="order.filter.sortBy == 'plannedTime' && order.reverse"
                 class="fa fa-caret-down "></i></a>
            </th>
            <th class="dynamic-thead" (click)="sort('startTime')"><a><span class="p-r-xs" translate>history.label.startTime</span>
              <i *ngIf="order.filter.sortBy == 'startTime' && !order.reverse"
                 class="fa fa-caret-up "></i>
              <i *ngIf="order.filter.sortBy == 'startTime' && order.reverse"
                 class="fa fa-caret-down "></i></a>
            </th>
            <th class="dynamic-thead" (click)="sort('endTime')"><a><span class="p-r-xs" translate>history.label.endTime</span>
              <i *ngIf="order.filter.sortBy == 'endTime' && !order.reverse"
                 class="fa fa-caret-up "></i>
              <i *ngIf="order.filter.sortBy == 'endTime' && order.reverse"
                 class="fa fa-caret-down "></i></a>
            </th>
            <th class="dynamic-thead" (click)="sort('duration')">
              <a><span class="p-r-xs" translate>history.label.duration</span>
                <i *ngIf="order.filter.sortBy == 'duration' && !order.reverse"
                   class="fa fa-caret-up "></i>
                <i *ngIf="order.filter.sortBy == 'duration' && order.reverse"
                   class="fa fa-caret-down "></i></a>
            </th>
          </tr>
          </thead>
          <tbody>
          <ng-template ngFor let-history
                       [ngForOf]="ajaxOrderTable.data">
            <tr class="cursor" [ngClass]="{'light-bg':history.show}">
              <td>
                <div class="btn-group dropdown">
                  <button class="btn-drop more-option-h" nz-dropdown nzTrigger="click" [nzDropdownMenu]="exportMenu" type="button">
                    <i class="fa fa-ellipsis-h"></i>
                  </button>
                  <nz-dropdown-menu #exportMenu="nzDropdownMenu" role="menu" >
                    <ul nz-menu>
                      <li nz-menu-item >
                        <a [ngClass]="{'disable-link':(schedulerIds.selected != history.controllerId && history.controllerId)}"
                          (click)="addWorkflowToIgnoreList(history.workflow)"
                          translate>history.button.addWorkflowToIgnoreList</a>
                      </li>
                      <li nz-menu-item>
                        <a (click)="showAllPanelFuc(history)"
                           translate>history.button.expandAll</a>
                      </li>
                      <li nz-menu-item>
                        <a (click)="hideAllPanelFuc(history)"
                           translate>history.button.collapseAll</a>
                      </li>
                      <li nz-menu-item>
                        <a (click)="coreService.copyLink('order',history.orderId, history.workflow)" translate>common.button.copyLinkToObject</a>
                      </li>
                    </ul>
                  </nz-dropdown-menu>
                </div>
              </td>
              <td *ngIf="!historyFilters.current">
                <span class="show-in-single-line w-full"
                      (click)="coreService.showLogWindow(history,null,null,history.controllerId, null)">
                  <i class="cursor fa fa-caret-down fa-lg p-l-xs p-r-xs"
                     *ngIf="!history.show" (click)="showPanelFuc(history);$event.stopPropagation()"></i>
                  <i class="cursor fa fa-caret-up fa-lg p-l-xs p-r-xs"
                     *ngIf="history.show" (click)="hidePanelFuc(history);$event.stopPropagation()"></i>
                  <i class="cursor fa fa-download text-hover-primary p-r-xs"
                     (click)="downloadLog(history,history.controllerId);$event.stopPropagation()"></i>
                   <span [innerHtml]="history.controllerId | highlight : order.searchText"></span>
                   <span *ngIf="!history.controllerId" [innerHtml]="orderSearch.controllerId"></span>
                </span>
              </td>
              <td>
                <span class="show-in-single-line w-full"
                      (click)="coreService.showLogWindow(history,null,null,history.controllerId,null)">
                  <i class="cursor fa fa-caret-down fa-lg p-l-xs p-r-xs"
                     *ngIf="!history.show && historyFilters.current"
                     (click)="showPanelFuc(history);$event.stopPropagation()"></i>
                  <i class="cursor fa fa-caret-up fa-lg p-l-xs p-r-xs"
                     *ngIf="history.show && historyFilters.current"
                     (click)="hidePanelFuc(history);$event.stopPropagation()"></i>
                  <i *ngIf="historyFilters.current"
                     class="cursor fa fa-download text-hover-primary p-r-xs"
                     (click)="downloadLog(history,history.controllerId);$event.stopPropagation()"></i>
                  <span [innerHtml]="history.orderId | highlight : order.searchText"></span>
                </span>
              </td>
              <td (click)="coreService.showLogWindow(history,null, null, history.controllerId, null)">
                <span class="show-in-single-line w-full">
                  <i (click)="navToWorkflowTab(history.workflow);$event.stopPropagation()" class="cursor fa fa-pencil text-hover-primary p-r-xs"></i>
                  <span (click)="coreService.showWorkflow(history.workflow);$event.stopPropagation()"
                        class="text-hover-primary" [innerHtml]="history.workflow | highlight : order.searchText"></span>
                </span>
              </td>
              <td (click)="coreService.showLogWindow(history,null, null, history.controllerId, null)">
                <span [innerHtml]="history.position"></span>
              </td>
              <td (click)="coreService.showLogWindow(history,null, null, history.controllerId, null)">
                <span *ngIf="history.state" class="label" [ngClass]="coreService.getColor(history.state.severity,'bg')"
                      [innerHtml]="history.state._text | translate"></span>
              </td>
              <td (click)="coreService.showLogWindow(history,null, null, history.controllerId, null)">
                <span *ngIf="history.orderState" class="label" [ngClass]="coreService.getColor(history.orderState.severity,'bg')"
                      [innerHtml]="history.orderState._text | translate"></span>
              </td>
              <td (click)="coreService.showLogWindow(history,null, null, history.controllerId, null)"
                  [innerHtml]="history.plannedTime | stringToDate"></td>
              <td (click)="coreService.showLogWindow(history,null, null, history.controllerId, null)"
                  [innerHtml]="history.startTime | stringToDate"></td>
              <td (click)="coreService.showLogWindow(history,null, null, history.controllerId, null)"
                  [innerHtml]="history.endTime | stringToDate"></td>
              <td (click)="coreService.showLogWindow(history,null, null, history.controllerId, null)"
                  [innerHtml]="history.startTime | duration:history.endTime"></td>
            </tr>
            <tr *ngIf="history.show && history.arguments">
              <td></td>
              <td colspan="10">
                <app-order-variable [order]="history" [type]="'arguments'" [schedulerId]="schedulerIds.selected"></app-order-variable>
              </td>
            </tr>
            <tr *ngIf="history.show">
              <td colspan="11" style="padding:0 !important;">
              <app-order-history-template class="order-history-template0" style="display: block" [history]="history" [schedulerId]="schedulerIds.selected"
                                          [historyView]="historyFilters" [orderSearch]="orderSearch"
              ></app-order-history-template>
              </td>
            </tr>
          </ng-template>
          </tbody>
        </nz-table>
        <div class="w-half label-top" *ngIf="ajaxOrderTable.data.length >0">
          <span translate>common.label.total</span> {{data.length}}
          <span *ngIf="ajaxOrderTable.data.length >1" translate>history.label.historiesFound</span>
          <span *ngIf="ajaxOrderTable.data.length === 1" translate>history.label.historyFound</span>
        </div>
      </div>
    </div>
    <div class="m-t-sm box p-a" *ngIf="historyFilters.type == 'TASK'">
      <div class="table-responsive">
        <nz-table
          #ajaxTable
          [nzSize]="'small'"
          [nzPageSize]="task.entryPerPage || preferences.entryPerPage"
          [nzPageIndex]="task.currentPage"
          [nzBordered]="true"
          [nzShowPagination]="data.length > 0"
          [nzData]="data | orderBy: task.filter.sortBy:task.reverse"
          [nzLoading]="!isLoading"
          [nzShowSizeChanger]="true"
          (nzPageIndexChange)="pageIndexChange($event)"
          (nzPageSizeChange)="pageSizeChange($event)"
          [nzPageSizeOptions]="[10, 25, 50, 100 , preferences.maxEntryPerPage]"
        >
          <thead>
          <tr>
            <th class=" menu"><span translate>common.label.action</span></th>
            <th *ngIf="!historyFilters.current" (click)="sort1('controllerId')">
              <a><span class="p-r-xs" translate>common.label.controllerId</span>
                <i *ngIf="task.filter.sortBy == 'controllerId' && !task.reverse"
                   class="fa fa-caret-up "></i>
                <i *ngIf="task.filter.sortBy == 'controllerId' && task.reverse"
                   class="fa fa-caret-down "></i></a>
            </th>
            <th (click)="sort1('job')">
              <a><span class="p-r-xs" translate>history.label.job</span>
                <i *ngIf="task.filter.sortBy == 'job' && !task.reverse"
                   class="fa fa-caret-up "></i>
                <i *ngIf="task.filter.sortBy == 'job' && task.reverse"
                   class="fa fa-caret-down "></i></a>
            </th>
            <th (click)="sort1('workflow')">
              <a><span class="p-r-xs" translate>history.label.workflow</span>
                <i *ngIf="task.filter.sortBy == 'workflow' && !task.reverse"
                   class="fa fa-caret-up "></i>
                <i *ngIf="task.filter.sortBy == 'workflow' && task.reverse"
                   class="fa fa-caret-down "></i></a>
            </th>
            <th (click)="sort1('position')">
              <a><span class="p-r-xs" translate>history.label.position</span>
                <i *ngIf="task.filter.sortBy == 'position' && !task.reverse"
                   class="fa fa-caret-up "></i>
                <i *ngIf="task.filter.sortBy == 'position' && task.reverse"
                   class="fa fa-caret-down "></i></a>
            </th>
            <th (click)="sort1('state._text')">
              <a><span class="p-r-xs" translate>history.label.status</span>
                <i *ngIf="task.filter.sortBy == 'state._text' && !task.reverse"
                   class="fa fa-caret-up "></i>
                <i *ngIf="task.filter.sortBy == 'state._text' && task.reverse"
                   class="fa fa-caret-down "></i></a>
            </th>
            <th (click)="sort1('startTime')">
              <a><span class="p-r-xs" translate>history.label.startTime</span>
                <i *ngIf="task.filter.sortBy == 'startTime' && !task.reverse"
                   class="fa fa-caret-up "></i>
                <i *ngIf="task.filter.sortBy == 'startTime' && task.reverse"
                   class="fa fa-caret-down "></i></a>
            </th>
            <th (click)="sort1('endTime')">
              <a><span class="p-r-xs" translate>history.label.endTime</span>
                <i *ngIf="task.filter.sortBy == 'endTime' && !task.reverse"
                   class="fa fa-caret-up "></i>
                <i *ngIf="task.filter.sortBy == 'endTime' && task.reverse"
                   class="fa fa-caret-down "></i></a>
            </th>
            <th (click)="sort1('duration')">
              <a><span class="p-r-xs" translate>history.label.duration</span>
                <i *ngIf="task.filter.sortBy == 'duration' && !task.reverse"
                   class="fa fa-caret-up "></i>
                <i *ngIf="task.filter.sortBy == 'duration' && task.reverse"
                   class="fa fa-caret-down "></i></a>
            </th>
            <th (click)="sort1('criticality')">
              <a><span class="p-r-xs" translate>history.label.criticality</span>
                <i *ngIf="task.filter.sortBy == 'criticality' && !task.reverse"
                   class="fa fa-caret-up "></i>
                <i *ngIf="task.filter.sortBy == 'criticality' && task.reverse"
                   class="fa fa-caret-down "></i></a>
            </th>
            <th (click)="sort1('returnCode')">
              <a><span class="p-r-xs" translate>history.label.returnCode</span>
                <i *ngIf="task.filter.sortBy == 'returnCode' && !task.reverse"
                   class="fa fa-caret-up "></i>
                <i *ngIf="task.filter.sortBy == 'returnCode' && task.reverse"
                   class="fa fa-caret-down "></i></a>
            </th>
          </tr>
          </thead>
          <tbody>
          <ng-template ngFor let-jobHistory [ngForOf]="ajaxTable.data">
            <tr class="cursor" [ngClass]="{'light-bg':jobHistory.show}">
              <td>
                <div class="btn-group dropdown">
                  <button class="btn-drop more-option-h" nz-dropdown nzTrigger="click" [nzDropdownMenu]="export3" type="button">
                    <i class="fa fa-ellipsis-h"></i>
                  </button>
                  <nz-dropdown-menu #export3="nzDropdownMenu" role="menu" >
                    <ul nz-menu>
                      <li nz-menu-item >
                        <a [ngClass]="{'disable-link':(schedulerIds.selected != jobHistory.controllerId && jobHistory.controllerId)}"
                          (click)="addJobToIgnoreList(jobHistory.job, jobHistory.workflow)" translate>history.button.addJobToIgnoreList</a>
                      </li>
                      <li nz-menu-item >
                        <a [ngClass]="{'disable-link':(schedulerIds.selected != jobHistory.controllerId && jobHistory.controllerId)}"
                          (click)="addJobToIgnoreList(null, jobHistory.workflow)"
                          translate>history.button.addWorkflowToIgnoreList</a>
                      </li>
                    </ul>
                  </nz-dropdown-menu>
                </div>
              </td>
              <td *ngIf="!historyFilters.current"
                  (click)="coreService.showLogWindow(null,jobHistory,null,jobHistory.controllerId, null)">
                <span class="show-in-single-line">
                  <i class="cursor fa fa-caret-down fa-lg p-l-xs p-r-xs" [ngClass]="jobHistory.show ? 'fa-caret-up' : 'fa-caret-down'"
                     (click)="jobHistory.show=!jobHistory.show;;$event.stopPropagation()"></i>
                  <i class="cursor fa fa-download  text-hover-primary p-r-xs"
                     (click)="downloadLog(jobHistory,jobHistory.controllerId);$event.stopPropagation()"></i>
                  <span [innerHtml]="jobHistory.controllerId | highlight : task.searchText"></span>
                </span>
              </td>
              <td (click)="coreService.showLogWindow(null,jobHistory, null, jobHistory.controllerId, null)">
                <span class="show-in-single-line">
                  <i *ngIf="historyFilters.current" class="cursor fa fa-caret-down fa-lg p-l-xs p-r-xs" [ngClass]="jobHistory.show ? 'fa-caret-up' : 'fa-caret-down'"
                     (click)="jobHistory.show=!jobHistory.show;$event.stopPropagation()"></i>
                  <i *ngIf="historyFilters.current" class="cursor fa fa-download  text-hover-primary p-r-xs"
                     (click)="downloadLog(jobHistory,jobHistory.controllerId);$event.stopPropagation()"></i>
                  <span [innerHtml]="jobHistory.job | highlight : task.searchText"></span>
                </span>
              </td>
              <td (click)="coreService.showLogWindow(null,jobHistory, null, jobHistory.controllerId, null)">
                <span class="show-in-single-line w-full">
                  <i (click)="navToWorkflowTab(jobHistory.workflow);$event.stopPropagation()" class="cursor fa fa-pencil text-hover-primary p-r-xs"></i>
                  <span (click)="coreService.showWorkflow(jobHistory.workflow);$event.stopPropagation()"
                        class="text-hover-primary" [innerHtml]="jobHistory.workflow | highlight : task.searchText"></span>
                </span>
              </td>
              <td (click)="coreService.showLogWindow(null,jobHistory, null, jobHistory.controllerId, null)">
                <span [innerHtml]="jobHistory.position | highlight : task.searchText"></span>
              </td>
              <td (click)="coreService.showLogWindow(null,jobHistory,null,jobHistory.controllerId,null)">
                <span class="label"
                      [ngClass]="coreService.getColor(jobHistory.state.severity,'bg')"
                      [innerHtml]="jobHistory.state._text | translate"></span>
              </td>
              <td (click)="coreService.showLogWindow(null,jobHistory,null,jobHistory.controllerId,null)"
                  [innerHtml]="jobHistory.startTime | stringToDate"></td>
              <td (click)="coreService.showLogWindow(null,jobHistory,null,jobHistory.controllerId,null)"
                  [innerHtml]="jobHistory.endTime | stringToDate"></td>
              <td (click)="coreService.showLogWindow(null,jobHistory,null,jobHistory.controllerId,null)"
                  [innerHtml]="jobHistory.startTime | duration:jobHistory.endTime"></td>
              <td (click)="coreService.showLogWindow(null,jobHistory,null,jobHistory.controllerId,null)"
                  [innerHtml]="jobHistory.criticality | translate | highlight : task.searchText"></td>
              <td (click)="coreService.showLogWindow(null,jobHistory,null,jobHistory.controllerId,null)"
                  [innerHtml]="jobHistory.exitCode"></td>
            </tr>
            <tr *ngIf="jobHistory.show">
              <td></td>
              <td colspan="10">
                <app-order-variable [order]="jobHistory" [type]="'arguments'" [schedulerId]="schedulerIds.selected"></app-order-variable>
              </td>
            </tr>
          </ng-template>
          </tbody>
        </nz-table>
        <div class="w-half label-top" *ngIf="ajaxTable.data.length >0">
          <span translate>common.label.total</span> {{data.length}}
          <span *ngIf="ajaxTable.data.length >1" translate>history.label.historiesFound</span>
          <span *ngIf="ajaxTable.data.length === 1" translate>history.label.historyFound</span>
        </div>
      </div>
    </div>
    <div class="m-t-sm box p-a" *ngIf="historyFilters.type == 'YADE'">
      <div class="table-responsive" id="fileTransferMainTable">
        <nz-table
          #ajaxYadeTable
          [nzSize]="'small'"
          [nzPageSize]="yade.entryPerPage || preferences.entryPerPage"
          [nzPageIndex]="yade.currentPage"
          [nzBordered]="true"
          [nzShowPagination]="data.length > 0"
          [nzData]="data | orderBy: yade.filter.sortBy:yade.reverse"
          [nzLoading]="!isLoading"
          [nzShowSizeChanger]="true"
          (nzPageIndexChange)="pageIndexChange($event)"
          (nzPageSizeChange)="pageSizeChange($event)"
          [nzPageSizeOptions]="[10, 25, 50, 100 , preferences.maxEntryPerPage]"
        >
          <thead>
          <tr class="main-header-row">
            <th *ngIf="!historyFilters.current" (click)="sort2('controllerId')"><a><span
              translate>common.label.controllerId</span>
              <i *ngIf="yade.filter.sortBy == 'controllerId' && !yade.reverse"
                 class="fa fa-caret-up "></i>
              <i *ngIf="yade.filter.sortBy == 'controllerId' && yade.reverse"
                 class="fa fa-caret-down "></i></a>
            </th>
            <th (click)="sort2('state._text')"><a>
              <span class="p-r-xs" translate>fileTransfer.label.status</span>
              <i *ngIf="yade.filter.sortBy == 'state._text' && !yade.reverse"
                 class="fa fa-caret-up "></i>
              <i *ngIf="yade.filter.sortBy == 'state._text' && yade.reverse"
                 class="fa fa-caret-down "></i></a>
            </th>
            <th (click)="sort2('profile')"><a>
              <span class="p-r-xs" translate>fileTransfer.label.profileName</span>
              <i *ngIf="yade.filter.sortBy == 'profile' && !yade.reverse"
                 class="fa fa-caret-up "></i>
              <i *ngIf="yade.filter.sortBy == 'profile' && yade.reverse"
                 class="fa fa-caret-down "></i></a>
            </th>
            <th (click)="sort2('operation')"><a>
              <span class="p-r-xs" translate>fileTransfer.label.operation</span>
              <i *ngIf="yade.filter.sortBy == 'operation' && !yade.reverse"
                 class="fa fa-caret-up "></i>
              <i *ngIf="yade.filter.sortBy == 'operation' && yade.reverse"
                 class="fa fa-caret-down "></i></a>
            </th>
            <th (click)="sort2('workflow')"><a>
              <span class="p-r-xs" translate>fileTransfer.label.workflow</span>
              <i *ngIf="yade.filter.sortBy == 'workflow' && !yade.reverse"
                 class="fa fa-caret-up "></i>
              <i *ngIf="yade.filter.sortBy == 'workflow' && yade.reverse"
                 class="fa fa-caret-down "></i></a>
            </th>
            <th (click)="sort2('orderId')"><a>
              <span class="p-r-xs" translate>fileTransfer.label.order</span>
              <i *ngIf="yade.filter.sortBy == 'orderId' && !yade.reverse"
                 class="fa fa-caret-up "></i>
              <i *ngIf="yade.filter.sortBy == 'orderId' && yade.reverse"
                 class="fa fa-caret-down "></i></a>
            </th>
            <th nzWidth="65px" (click)="sort2('numOfFiles')"><a>
              <span class="p-r-xs" [nz-tooltip]="'fileTransfer.tooltip.totalNumberOfFiles' | translate" translate>fileTransfer.label.total</span>
              <i *ngIf="yade.filter.sortBy == 'numOfFiles' && !yade.reverse"
                 class="fa fa-caret-up "></i>
              <i *ngIf="yade.filter.sortBy == 'numOfFiles' && yade.reverse"
                 class="fa fa-caret-down "></i></a>

            </th>
            <th nzWidth="20%" style="width: 20% !important;" (click)="sort2('error.message')"><a>
              <span class="p-r-xs" translate>fileTransfer.label.lastErrorMessage</span>
              <i *ngIf="yade.filter.sortBy == 'error.message' && !yade.reverse"
                 class="fa fa-caret-up "></i>
              <i *ngIf="yade.filter.sortBy == 'error.message' && yade.reverse"
                 class="fa fa-caret-down "></i></a>
            </th>
            <th (click)="sort2('start')"><a>
              <span class="p-r-xs" translate>fileTransfer.label.startTime</span>
              <i *ngIf="yade.filter.sortBy == 'start' && !yade.reverse"
                 class="fa fa-caret-up "></i>
              <i *ngIf="yade.filter.sortBy == 'start' && yade.reverse"
                 class="fa fa-caret-down "></i></a>
            </th>
            <th (click)="sort2('end')"><a>
              <span class="p-r-xs" translate>fileTransfer.label.endTime</span>
              <i *ngIf="yade.filter.sortBy == 'end' && !yade.reverse"
                 class="fa fa-caret-up "></i>
              <i *ngIf="yade.filter.sortBy == 'end' && yade.reverse"
                 class="fa fa-caret-down "></i></a>
            </th>
            <th nzWidth="100px" (click)="sort2('duration')"><a>
              <span class="p-r-xs" translate>common.label.duration</span>
              <i *ngIf="yade.filter.sortBy == 'duration' && !yade.reverse"
                 class="fa fa-caret-up "></i>
              <i *ngIf="yade.filter.sortBy == 'duration' && yade.reverse"
                 class="fa fa-caret-down "></i></a>
            </th>
          </tr>
          </thead>
          <tbody>
          <ng-template ngFor let-transfer
                       [ngForOf]="ajaxYadeTable.data">
            <tr class="cursor" [ngClass]="{'light-bg':transfer.show}">
              <td (click)="coreService.showLogWindow(null, transfer,null,transfer.controllerId,true)" *ngIf="!historyFilters.current">
                <span class="show-in-single-line">
                <i class="cursor fa fa-caret-down fa-lg"
                   *ngIf="!transfer.show && !historyFilters.current"
                   (click)="showTransferFuc(transfer);$event.stopPropagation()"></i>
                <i class="cursor fa fa-caret-up fa-lg"
                   *ngIf="transfer.show && !historyFilters.current"
                   (click)="transfer.show = false;$event.stopPropagation()"></i>&nbsp;
                <span [innerHtml]="transfer.controllerId"></span>
                <span *ngIf="!transfer.controllerId" [innerHtml]="transfer.controllerId"></span>
                </span>
              </td>
              <td (click)="coreService.showLogWindow(null, transfer,null,transfer.controllerId,true)" noWrap>
                <span>
                <i class="cursor fa fa-caret-down fa-lg"
                   *ngIf="!transfer.show && historyFilters.current"
                   (click)="showTransferFuc(transfer);$event.stopPropagation()"></i>
                <i class="cursor fa fa-caret-up fa-lg"
                   *ngIf="transfer.show && historyFilters.current"
                   (click)="transfer.show = false;$event.stopPropagation()"></i>&nbsp;
                <span class="label" [ngClass]="coreService.getColor(transfer.state.severity,'bg')"
                      [innerHtml]="transfer.state._text | translate | highlight : yade.searchText"></span>
                </span>
              </td>
              <td (click)="coreService.showLogWindow(null, transfer,null,transfer.controllerId,true)"
                  [innerHtml]="transfer.profile | highlight : yade.searchText"></td>
              <td (click)="coreService.showLogWindow(null, transfer,null,transfer.controllerId,true)"
                  [innerHtml]="transfer._operation | highlight : yade.searchText"></td>
              <td (click)="coreService.showLogWindow(null, transfer,null,transfer.controllerId,true)">
                <span class="show-in-single-line w-full">
                  <i (click)="navToWorkflowTab(transfer.workflowPath);$event.stopPropagation()" class="cursor fa fa-pencil text-hover-primary p-r-xs"></i>
                  <span (click)="coreService.showWorkflow(transfer.workflowPath);$event.stopPropagation()"
                        class="text-hover-primary" [innerHtml]="transfer.workflowPath | highlight : yade.searchText"></span>
                </span>
              </td>
              <td (click)="coreService.showLogWindow(null, transfer,null,transfer.controllerId,true)">
                <span [innerHtml]="transfer.orderId | highlight : yade.searchText"></span>
              </td>
              <td (click)="coreService.showLogWindow(null, transfer,null,transfer.controllerId,true)"
                  [innerHtml]="transfer.numOfFiles | highlight : yade.searchText"></td>
              <td style="width: 20% !important;" (click)="coreService.showLogWindow(null, transfer,null,transfer.controllerId,true)" class="text-danger">
                <span *ngIf="transfer.error" [innerHtml]="transfer.error.message"></span>
              </td>
              <td (click)="coreService.showLogWindow(null, transfer,null,transfer.controllerId,true)"
                  [innerHtml]="transfer.start | stringToDate"></td>
              <td (click)="coreService.showLogWindow(null, transfer,null,transfer.controllerId,true)"
                  [innerHtml]="transfer.end | stringToDate"></td>
              <td (click)="coreService.showLogWindow(null, transfer,null,transfer.controllerId,true)"
                  [innerHtml]="transfer.start | duration:transfer.end"></td>
            </tr>
            <tr *ngIf="transfer.show">
              <td></td>
              <td colspan="10" style="padding: 0 !important;border-bottom: none!important;">
                <nz-table class="m-a-0 inner-table" id="fileTransferTable" nzSize="small" [nzData]="['']" [nzShowPagination]="false" [nzFrontPagination]="false">
                  <thead>
                    <tr>
                      <th class="order-history-template0" style="border-bottom: 1px solid #eee;" colspan="4"><span translate>fileTransfer.label.source</span></th>
                      <th class="order-history-template1" style="border-bottom: 1px solid #eee;" colspan="4"><span translate>fileTransfer.label.target</span></th>
                      <th class="order-history-template2" style="border-bottom: 1px solid #eee;" colspan="4"><span translate>fileTransfer.label.jump</span></th>
                    </tr>
                    <tr class="sub-header">
                      <th class="order-history-template0 dynamic-thead"><span translate>fileTransfer.label.host</span></th>
                      <th class="order-history-template0 dynamic-thead"><span translate>fileTransfer.label.account</span></th>
                      <th class="order-history-template0 dynamic-thead"><span translate>fileTransfer.label.port</span></th>
                      <th class="order-history-template0 dynamic-thead"><span translate>fileTransfer.label.protocol</span></th>
                      <th class="order-history-template1 dynamic-thead"><span translate>fileTransfer.label.host</span></th>
                      <th class="order-history-template1 dynamic-thead"><span translate>fileTransfer.label.account</span></th>
                      <th class="order-history-template1 dynamic-thead"><span translate>fileTransfer.label.port</span></th>
                      <th class="order-history-template1 dynamic-thead"><span translate>fileTransfer.label.protocol</span></th>
                      <th class="order-history-template2 dynamic-thead"><span translate>fileTransfer.label.host</span></th>
                      <th class="order-history-template2 dynamic-thead"><span translate>fileTransfer.label.account</span></th>
                      <th class="order-history-template2 dynamic-thead"><span translate>fileTransfer.label.port</span></th>
                      <th class="order-history-template2 dynamic-thead"><span translate>fileTransfer.label.protocol</span></th>
                    </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><span *ngIf="transfer.source" [innerHtml]="transfer.source.host"></span></td>
                    <td><span *ngIf="transfer.source" [innerHtml]="transfer.source.account"></span></td>
                    <td><span *ngIf="transfer.source" [innerHtml]="transfer.source.port"></span></td>
                    <td><span *ngIf="transfer.source" [innerHtml]="transfer.source.protocol"></span></td>
                    <td><span *ngIf="transfer.target" [innerHtml]="transfer.target.host"></span></td>
                    <td><span *ngIf="transfer.target" [innerHtml]="transfer.target.account"></span></td>
                    <td><span *ngIf="transfer.target" [innerHtml]="transfer.target.port"></span></td>
                    <td><span *ngIf="transfer.target" [innerHtml]="transfer.target.protocol"></span></td>
                    <td><span *ngIf="transfer.jump" [innerHtml]="transfer.jump.host"></span></td>
                    <td><span *ngIf="transfer.jump" [innerHtml]="transfer.jump.account"></span></td>
                    <td><span *ngIf="transfer.jump" [innerHtml]="transfer.jump.port"></span></td>
                    <td><span *ngIf="transfer.jump" [innerHtml]="transfer.jump.protocol"></span></td>
                  </tr>
                </tbody>
              </nz-table>
              <nz-table class="m-a-0 inner-table" #innerChildTable nzSize="small" [nzLoading]="transfer.loading" [nzWidthConfig]="transfer.widthArr"
                        [nzData]="transfer.files" [nzFrontPagination]="false" [nzShowPagination]="false">
                <thead>
                <tr>
                  <th><span translate>fileTransfer.label.sourceFileName</span></th>
                  <th><span translate>fileTransfer.label.sourceFilePath</span></th>
                  <th><span translate>fileTransfer.label.targetFileName</span></th>
                  <th><span translate>fileTransfer.label.targetFilePath</span></th>
                  <th><span translate>fileTransfer.label.status</span></th>
                  <th><span translate>fileTransfer.label.size</span></th>
                  <th><span translate>fileTransfer.label.integrityHash</span></th>
                </tr>
                </thead>
                <tbody>
                <ng-template ngFor let-file [ngForOf]="innerChildTable.data">
                  <tr>
                    <td>{{file.sourceName}}</td>
                    <td>{{file.sourcePath}}</td>
                    <td>{{file.targetName}}</td>
                    <td>{{file.targetPath}}</td>
                    <td><span *ngIf="file.state" class="label" [ngClass]="coreService.getColor(file.state.severity,'bg')"
                              [innerHtml]="file.state._text | translate"></span></td>
                    <td>{{file.size | byteToSize}}</td>
                    <td>{{file.integrityHash}}</td>
                  </tr>
                  <tr *ngIf="file.error">
                    <td colspan="7" class="text-danger"><span>{{file.error.message}}</span></td>
                  </tr>
                </ng-template>
                </tbody>
              </nz-table>
              </td>
            </tr>
          </ng-template>
          </tbody>
        </nz-table>
        <div class="w-half label-top" *ngIf="ajaxYadeTable.data.length >0">
          <span translate>common.label.total</span> {{data.length}}
          <span *ngIf="ajaxYadeTable.data.length >1" translate>history.label.historiesFound</span>
          <span *ngIf="ajaxYadeTable.data.length === 1" translate>history.label.historyFound</span>
        </div>
      </div>
    </div>
    <div class="m-t-sm box p-a" *ngIf="historyFilters.type == 'DEPLOYMENT'">
      <div class="table-responsive">
        <nz-table
          #ajaxTable
          [nzSize]="'small'"
          [nzPageSize]="deployment.entryPerPage || preferences.entryPerPage"
          [nzPageIndex]="deployment.currentPage"
          [nzBordered]="true"
          [nzShowPagination]="data.length > 0"
          [nzData]="data | orderBy: deployment.filter.sortBy:deployment.reverse"
          [nzLoading]="!isLoading"
          [nzShowSizeChanger]="true"
          (nzPageIndexChange)="pageIndexChange($event)"
          (nzPageSizeChange)="pageSizeChange($event)"
          [nzPageSizeOptions]="[10, 25, 50, 100 , preferences.maxEntryPerPage]"
        >
          <thead>
          <tr>
            <th nzWidth="20%" *ngIf="!historyFilters.current" (click)="sort3('controllerId')">
              <a><span class="p-r-xs" translate>common.label.controllerId</span>
                <i *ngIf="deployment.filter.sortBy == 'controllerId' && !deployment.reverse"
                   class="fa fa-caret-up "></i>
                <i *ngIf="deployment.filter.sortBy == 'controllerId' && deployment.reverse"
                   class="fa fa-caret-down "></i></a>
            </th>
            <th nzWidth="20%" (click)="sort3('deploymentDate')">
              <a><span class="p-r-xs" translate>history.label.deploymentDate</span>
                <i *ngIf="deployment.filter.sortBy == 'deploymentDate' && !deployment.reverse"
                   class="fa fa-caret-up "></i>
                <i *ngIf="deployment.filter.sortBy == 'deploymentDate' && deployment.reverse"
                   class="fa fa-caret-down "></i></a>
            </th>
            <th nzWidth="20%" (click)="sort3('account')">
              <a><span class="p-r-xs" translate>common.label.account</span>
                <i *ngIf="deployment.filter.sortBy == 'account' && !deployment.reverse"
                   class="fa fa-caret-up "></i>
                <i *ngIf="deployment.filter.sortBy == 'account' && deployment.reverse"
                   class="fa fa-caret-down "></i></a>
            </th>
            <th nzWidth="20%" (click)="sort3('state')">
              <a><span class="p-r-xs" translate>history.label.state</span>
                <i *ngIf="deployment.filter.sortBy == 'state' && !deployment.reverse"
                   class="fa fa-caret-up "></i>
                <i *ngIf="deployment.filter.sortBy == 'state' && deployment.reverse"
                   class="fa fa-caret-down "></i></a>
            </th>
            <th [nzWidth]="historyFilters.current ? '40%' : '20%'">
              <span translate>history.label.numberOfItems</span>
            </th>
          </tr>
          </thead>
          <tbody>
          <ng-template ngFor let-depHistory
                       [ngForOf]="ajaxTable.data">
            <tr [ngClass]="{'light-bg':depHistory.show}">
              <td *ngIf="!historyFilters.current">
                <span class="show-in-single-line w-full">
                  <i class="cursor fa fa-caret-down fa-lg p-l-xs p-r-xs"
                     *ngIf="!depHistory.show" (click)="showChildHistory(depHistory);"></i>
                  <i class="cursor fa fa-caret-up fa-lg p-l-xs p-r-xs"
                     *ngIf="depHistory.show" (click)="depHistory.show = false;"></i>
                   <span [innerHtml]="depHistory.controllerId | highlight : deployment.searchText"></span>
                   <span *ngIf="!depHistory.controllerId" [innerHtml]="deploymentSearch.controllerId"></span>
                </span>
              </td>
              <td>
                <span class="show-in-single-line w-full">
                  <i class="cursor fa fa-caret-down fa-lg p-l-xs p-r-xs"
                     *ngIf="!depHistory.show && historyFilters.current"
                     (click)="showChildHistory(depHistory);"></i>
                  <i class="cursor fa fa-caret-up fa-lg p-l-xs p-r-xs"
                     *ngIf="depHistory.show && historyFilters.current"
                     (click)="depHistory.show = false;"></i>
                  <span [innerHtml]="depHistory.deploymentDate | stringToDate | highlight : deployment.searchText"></span>
                </span>
              </td>
              <td><span [innerHtml]="depHistory.account | highlight : deployment.searchText"></span></td>
              <td><span class="label" [ngClass]="{'bg-dark-blue' : depHistory.state=== 'DEPLOYED', 'bg-orange' : depHistory.state=== 'NOT_DEPLOYED'}" [innerHtml]="depHistory.state | translate | highlight : deployment.searchText"></span></td>
              <td>
                <span class="p-r-sm" *ngIf="depHistory.workflowCount">
                  <span translate>Workflows</span>:
                  {{depHistory.workflowCount}}
                </span>
                <span class="p-r-sm" *ngIf="depHistory.fileOrderSourceCount">
                  <span translate>File Order Sources</span>:
                  {{depHistory.fileOrderSourceCount}}
                </span>
                <span class="p-r-sm" *ngIf="depHistory.jobResourceCount">
                  <span translate>Job Resources</span>:
                  {{depHistory.jobResourceCount}}
                </span>
                <span class="p-r-sm" *ngIf="depHistory.boardCount">
                  <span translate>Boards</span>:
                  {{depHistory.boardCount}}
                </span>
                <span *ngIf="depHistory.lockCount">
                  <span translate>Locks</span>:
                  {{depHistory.lockCount}}
                </span>
              </td>
            </tr>
            <tr *ngIf="depHistory.errorMessage && depHistory.show">
              <td colspan="5"><span class="text-danger">{{depHistory.errorMessage}}</span></td>
            </tr>
            <tr *ngIf="depHistory.show">
              <td colspan="5" style="padding:0 !important;" class="order-history-template0">
                <nz-table class="m-a-0 inner-table" #innerChildTable nzSize="small" [nzLoading]="depHistory.loading"
                          [nzData]="depHistory.children" [nzShowPagination]="false" [nzFrontPagination]="false">
                  <thead>
                  <tr>
                    <th nzWidth="19.95%"><span translate>history.label.deployType</span></th>
                    <th nzWidth="39.97%"><span translate>common.label.path</span></th>
                    <th nzWidth="19.95%"><span translate>history.label.operation</span></th>
                    <th nzWidth="19.95%"><span translate>history.label.date</span></th>
                  </tr>
                  </thead>
                  <tbody>
                  <tr *ngFor="let child of innerChildTable.data">
                    <td><span [innerHtml]="child.deployType | translate"></span></td>
                    <td>
                      <span class="show-in-single-line w-full">
                         <i *ngIf="child.operation === 'UPDATE'"
                            (click)="navToInventoryTab(child);$event.stopPropagation()"
                            class="cursor fa fa-pencil text-hover-primary p-r-xs"></i>
                        <span
                          [ngClass]="(child.deployType === 'Workflow' && child.operation === 'UPDATE') ? 'text-hover-primary' : ''"
                          (click)="coreService.showWorkflow(child.path);$event.stopPropagation()"
                          [innerHtml]="child.path"></span>

                      </span>
                    </td>
                    <td><span [innerHtml]="child.operation | translate"></span></td>
                    <td [innerHtml]="child.deploymentDate | stringToDate"></td>
                  </tr>
                  </tbody>
                </nz-table>
              </td>
            </tr>
          </ng-template>
          </tbody>
        </nz-table>
        <div class="w-half label-top" *ngIf="ajaxTable.data.length >0">
          <span translate>common.label.total</span> {{data.length}}
          <span *ngIf="ajaxTable.data.length >1" translate>history.label.historiesFound</span>
          <span *ngIf="ajaxTable.data.length === 1" translate>history.label.historyFound</span>
        </div>
      </div>
    </div>
    <div class="m-t-sm box p-a" *ngIf="historyFilters.type == 'SUBMISSION'">
      <div class="table-responsive">
        <nz-table
          #ajaxTable
          [nzSize]="'small'"
          [nzPageSize]="submission.entryPerPage || preferences.entryPerPage"
          [nzPageIndex]="submission.currentPage"
          [nzBordered]="true"
          [nzShowPagination]="data.length > 0"
          [nzData]="data | orderBy: submission.filter.sortBy:submission.reverse"
          [nzLoading]="!isLoading"
          [nzShowSizeChanger]="true"
          (nzPageIndexChange)="pageIndexChange($event)"
          (nzPageSizeChange)="pageSizeChange($event)"
          [nzPageSizeOptions]="[10, 25, 50, 100 , preferences.maxEntryPerPage]"
        >
          <thead>
          <tr>
            <th (click)="sort4('dailyPlanDate')">
              <a><span class="p-r-xs" translate>history.label.dailyPlanDate</span>
                <i *ngIf="submission.filter.sortBy == 'dailyPlanDate' && !submission.reverse"
                   class="fa fa-caret-up "></i>
                <i *ngIf="submission.filter.sortBy == 'dailyPlanDate' && submission.reverse"
                   class="fa fa-caret-down "></i></a>
            </th>
          </tr>
          </thead>
          <tbody>
          <ng-template ngFor let-submissionHistory
                       [ngForOf]="ajaxTable.data">
            <tr [ngClass]="{'light-bg':submissionHistory.show}">
              <td>
                <span class="show-in-single-line w-full">
                    <i class="cursor fa fa-caret-down fa-lg p-l-xs p-r-xs"
                       *ngIf="!submissionHistory.show"
                       (click)="expandDailyPlan(submissionHistory)"></i>
                    <i class="cursor fa fa-caret-up fa-lg p-l-xs p-r-xs"
                       *ngIf="submissionHistory.show"
                       (click)="submissionHistory.show = false;"></i>
                    <span [innerHtml]="submissionHistory.date | stringToDate1"></span>
                  </span>
              </td>
            </tr>
            <tr *ngIf="submissionHistory.show">
              <td style="padding:0 !important;">
                <nz-table class="m-a-0 inner-table" nzSize="small" #innerChildTable
                          [nzData]="submissionHistory.controllers" [nzShowPagination]="false" [nzFrontPagination]="false">
                  <tbody>
                    <ng-template ngFor let-controller
                                 [ngForOf]="innerChildTable.data">
                    <tr *ngIf="!historyFilters.current">
                      <td class="custom-th" colspan="6">
                        <span class="p-l" translate>common.label.controllerId</span>:
                        <span [innerHtml]="controller.controllerId"></span>
                      </td>
                    </tr>
                    <tr>
                      <td class="custom-th" colspan="6"><span class="p-l" [ngClass]="{'p-l-md' : !historyFilters.current }" translate>history.label.submission</span></td>
                    </tr>
                    <ng-container *ngFor="let child of controller.submissions" class="order-history-template0">
                      <tr>
                        <td colspan="6">
                          <span class="p-l" [ngClass]="{'p-l-md' : !historyFilters.current }">
                            <i class="cursor fa fa-caret-down fa-lg p-l-xs p-r-xs"
                               *ngIf="!child.show" (click)="loadSubmissionOrders(submissionHistory, controller, child);child.show = true"></i>
                            <i class="cursor fa fa-caret-up fa-lg p-l-xs p-r-xs"
                               *ngIf="child.show" (click)="child.show = false;"></i>
                            <span [innerHtml]="child.submissionTime | stringToDate"></span>
                          </span>
                        </td>
                      </tr>
                      <ng-container *ngIf="child.show" class="order-history-template0">
                        <ng-container  *ngIf="child.orderIds && child.orderIds.length > 0">
                          <tr>
                            <td colspan="2" class="custom-th">
                              <span class="p-l-md" [ngClass]="{'p-l-lg' : !historyFilters.current }" translate>history.label.orderId</span>
                            </td>
                            <td colspan="2" class="custom-th"><span translate>order.label.workflow</span></td>
                            <td class="custom-th"><span translate>order.label.scheduledFor</span></td>
                            <td class="custom-th"><span translate>common.label.status</span></td>
                          </tr>
                          <tr *ngFor="let order of child.orderIds | filter: submission.searchText: ['workflowPath', 'orderId'] | orderBy: 'scheduledFor': true">
                            <td colspan="2"><span class="p-l-md" [ngClass]="{'p-l-lg' : !historyFilters.current }"
                                                  [innerHtml]="order.orderId | highlight: submission.searchText"></span></td>
                            <td colspan="2">
                              <i (click)="navToWorkflowTab(order.workflowPath);$event.stopPropagation()" class="cursor fa fa-pencil text-hover-primary p-r-xs"></i>
                              <span (click)="coreService.showWorkflow(order.workflowPath);$event.stopPropagation()"
                                    class="text-hover-primary" [innerHtml]="order.workflowPath | highlight: submission.searchText"></span>
                            </td>
                            <td><span>{{order.scheduledFor | stringToDate}}</span></td>
                            <td>
                               <span class="label bg-orange" *ngIf="order.submitted" translate>{{'submitted' | translate}}</span>
                               <span class="label bg-red" *ngIf="!order.submitted" translate>{{'notSubmitted' | translate}}</span>
                            </td>
                          </tr>
                          <tr *ngIf="(child.orderIds | filter: submission.searchText : ['workflowPath', 'orderId']).length === 0">
                            <td colspan="6" class="text-center">
                              <span class="text-uppercase m-t-sm" translate>common.message.noDataMatched</span>
                            </td>
                          </tr>
                        </ng-container>
                        <tr *ngIf="child.warnMessages && child.warnMessages.length > 0">
                          <td colspan="6" class="custom-th"><span class="p-l-md" [ngClass]="{'p-l-lg' : !historyFilters.current }" translate>history.label.warnMessages</span></td>
                        </tr>
                        <tr *ngFor="let msg of child.warnMessages">
                          <td colspan="6"><span class="p-l-md text-warn" [ngClass]="{'p-l-lg' : !historyFilters.current }">{{msg}}</span></td>
                        </tr>
                        <tr *ngIf="child.errorMessages && child.errorMessages.length > 0">
                          <td colspan="6" class="custom-th"><span class="p-l-md" [ngClass]="{'p-l-lg' : !historyFilters.current }" translate>history.label.errorMessages</span></td>
                        </tr>
                        <tr *ngFor="let msg of child.errorMessages">
                          <td colspan="6"><span class="p-l-md text-danger" [ngClass]="{'p-l-lg' : !historyFilters.current }">{{msg}}</span></td>
                        </tr>
                      </ng-container>
                    </ng-container>
                    </ng-template>
                  </tbody>
                </nz-table>
              </td>
            </tr>
          </ng-template>
          </tbody>
        </nz-table>
        <div class="w-half label-top" *ngIf="ajaxTable.data.length >0">
          <span translate>common.label.total</span> {{data.length}}
          <span *ngIf="ajaxTable.data.length >1" translate>history.label.historiesFound</span>
          <span *ngIf="ajaxTable.data.length === 1" translate>history.label.historyFound</span>
        </div>
      </div>
    </div>
  </div>
</div>
<div *ngIf="!isLoading || reloadState == 'yes'">
  <div class="bottom-btn" (click)="reload()">
    <i *ngIf="reloadState == 'no'" class="fa fa-times"></i>
    <i *ngIf="reloadState == 'yes'" class="fa fa-refresh"></i>
  </div>
</div>
