<div class="row m-t-xs">
  <div class="col-lg-8 col-xl-9">
    <div class="box">
      <div class="box-header b-b">
        <h3>
          <span translate>monitor.label.statistics</span>
        </h3>
      </div>
      <div class="row m-b-sm box-tool" style="top:10px">
        <div class="col-md-12 container-fluid">
          <div class="timeline m-b">
            <div class="timeline-header inline">
              <div class="btn-group">
                <div class="btn btn-default btn-sm" (click)="prev('statistics')">
                  <i class="fa fa-angle-left text-md"></i>
                </div>
                <div class="btn btn-default btn-sm no-cursor">
                  <nz-week-picker *ngIf="filters.statistics.filter.view === 'Week'" [(ngModel)]="filters.statistics.filter.endDate" [nzAllowClear]="false" (ngModelChange)="onChange($event, 'statistics')" [nzDisabledDate]="disabledDate"></nz-week-picker>
                  <nz-month-picker *ngIf="filters.statistics.filter.view === 'Month'" [(ngModel)]="filters.statistics.filter.endDate" [nzAllowClear]="false" (ngModelChange)="onChange($event, 'statistics')" [nzDisabledDate]="disabledDate"></nz-month-picker>
                  {{filters.statistics.filter.startDate | date : dateFormat }} - {{filters.statistics.filter.endDate | date : dateFormat}}
                </div>
                <div class="btn btn-default btn-sm" (click)="next('statistics')">
                  <i class="fa fa-angle-right text-md"></i>
                </div>
              </div>
            </div>
            <div class="inline btn-group pull-right">
              <div class="btn btn-default btn-sm"
                   (click)="setView('Week',  'statistics')"
                   [class.primary]="filters.statistics.filter.view === 'Week'" translate>
                monitor.button.week
              </div>
              <div class="btn btn-default btn-sm"
                   (click)="setView('Month', 'statistics')"
                   [class.primary]="filters.statistics.filter.view === 'Month'" translate>
                monitor.button.month
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="box-body p-a scroll-class" #chartArea [hidden]="!isLoaded || statisticsData.length ===0">
        <div style="height: 260px">
          <ngx-charts-bar-vertical-2d
            [groupPadding]="groupPadding"
            [view]="view"
            [scheme]="colorScheme"
            [results]="statisticsData"
            [gradient]="gradient"
            [customColors]="customColors"
            [xAxis]="showXAxis"
            [roundDomains]="true"
            [noBarWhenZero]="false"
            [trimXAxisTicks]="false"
            [showYAxisLabel]="true"
            [yAxisLabel]="yAxisLabel"
            [yAxis]="showYAxis">
            <ng-template #tooltipTemplate let-model="model">
              <div class="p-a-sm text-center">
                <h6>{{model.name}}</h6>
                <div class="text-md"><i>{{model.value}}</i></div>
              </div>
            </ng-template>
          </ngx-charts-bar-vertical-2d>
        </div>
      </div>
      <div style="height: 291px;" class="hide text-center m-t-lg p-b-lg text-primary text" [ngClass]="{'show': !isLoaded}">
        <div><i class="fa fa-refresh fa-lg fa-spin"></i></div>
      </div>
      <div style="height: 291px;" *ngIf="isLoaded && statisticsData.length ===0" class="vert-middle">
        <div>
          <app-empty-data></app-empty-data>
        </div>
      </div>
    </div>
  </div>
  <div class="col-lg-4 col-xl-3">
    <div class="box">
      <div class="box-header b-b">
        <h3>
          <span translate>monitor.label.runningTime</span>
        </h3>
      </div>
      <div class="row m-b-sm box-tool" style="top:10px">
        <div class="col-md-12 container-fluid">
          <div class="pull-right">
            <nz-range-picker [nzDisabledDate]="disabledDate" [(ngModel)]="filters.runningTime.filter.dateRange" (ngModelChange)="getRunningTime()"></nz-range-picker>
          </div>
        </div>
      </div>
      <div class="box-body p-a" style="height: 292px">
        <div class="row">
          <div class="col-sm-12 col-md-6 text-center" [ngClass]="{'col-md-12' : runningTime.length === 1}" *ngFor="let item of runningTime">
              <div class="text-dark _600 m-t">{{item.controllerId}}</div>
              <div style="display: flex;justify-content: center">
                <mwl-gauge
                  [dialStartAngle]="-90"
                  [dialEndAngle]="-90.001"
                  [value]="item.value"
                  [label]="getValue"
                  [color]="getColor"
                  [animated]="true"
                  [animationDuration]="1"
                >
                </mwl-gauge>
              </div>
              <i class="text-muted" style="position: relative;top:-12px" >{{'common.label.total' | translate}} {{item.hours}}</i>
          </div>
          <div class="col-md-12 text-center" *ngIf="!isLoaded">
            <div class="vert-middle text-primary text">
              <div><i class="fa fa-refresh fa-lg fa-spin"></i></div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-md-12">
    <div class="box">
      <div class="box-header b-b">
        <h3>
          <span translate>monitor.label.overview</span>
        </h3>
      </div>
      <div class="row m-b-sm box-tool" style="top:10px">
        <div class="col-md-12 container-fluid">
          <div class="timeline m-b">
            <div class="timeline-header inline">
              <div class="btn-group">
                <div class="btn btn-default btn-sm" (click)="prev('overview')">
                  <i class="fa fa-angle-left text-md"></i>
                </div>
                <div class="btn btn-default btn-sm no-cursor">
                  <nz-week-picker *ngIf="filters.overview.filter.view === 'Week'" [(ngModel)]="filters.overview.filter.endDate" [nzAllowClear]="false" (ngModelChange)="onChange($event, 'overview')" [nzDisabledDate]="disabledDate"></nz-week-picker>
                  <nz-month-picker *ngIf="filters.overview.filter.view === 'Month'" [(ngModel)]="filters.overview.filter.endDate" [nzAllowClear]="false" (ngModelChange)="onChange($event, 'overview')" [nzDisabledDate]="disabledDate"></nz-month-picker>
                  {{filters.overview.filter.startDate | date : dateFormat }} - {{filters.overview.filter.endDate | date : dateFormat}}
                </div>
                <div class="btn btn-default btn-sm" (click)="next('overview')">
                  <i class="fa fa-angle-right text-md"></i>
                </div>
              </div>
            </div>
            <div class="inline btn-group pull-right">
              <div class="btn btn-default btn-sm"
                   (click)="setView('Week',  'overview')"
                   [class.primary]="filters.overview.filter.view === 'Week'" translate>
                monitor.button.week
              </div>
              <div class="btn btn-default btn-sm"
                   (click)="setView('Month', 'overview')"
                   [class.primary]="filters.overview.filter.view === 'Month'" translate>
                monitor.button.month
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="box-body p-a overview" [hidden]="!isLoaded && ganttData.length === 0">
        <app-gantt-chart
          [dayStart]="'00:00'"
          [dayEnd]="'23:00'"
          [tasks]="ganttData"
        ></app-gantt-chart>
      </div>
      <div [hidden]="ganttData.length>0" class="hide text-center m-t-lg p-b-lg text-primary text"
           [ngClass]="{'show': !isLoaded}">
        <div><i class="fa fa-refresh fa-lg fa-spin"></i></div>
      </div>
      <div *ngIf="ganttData.length==0 && isLoaded" class="p-b">
        <div>
          <app-empty-data></app-empty-data>
        </div>
      </div>
    </div>
  </div>
</div>
