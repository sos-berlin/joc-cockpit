<div class="row m-t-n-xxs">
  <div class="col-md-12">
    <div class="timeline m-b-12">
      <div class="inline btn-group pull-right">
        <div class="btn btn-default btn-sm"
             (click)="setView('Week')"
             [class.primary]="filters.filter.view === 'Week'" translate>
          monitor.button.week
        </div>
        <div class="btn btn-default btn-sm"
             (click)="setView('Month')"
             [class.primary]="filters.filter.view === 'Month'" translate>
          monitor.button.month
        </div>
        <div class="btn btn-default btn-sm"
             (click)="setView('Custom')"
             [class.primary]="filters.filter.view === 'Custom'" translate>
          monitor.button.custom
        </div>
      </div>
      <nz-range-picker [nzAllowClear]="false" class="pull-right m-r-12" *ngIf="filters.filter.view === 'Custom'" [nzDisabledDate]="disabledDate" [(ngModel)]="filters.filter.dateRange" (ngModelChange)="onChangeDate()"></nz-range-picker>
      <div class="timeline-header pull-right inline m-l-12" *ngIf="filters.filter.view !== 'Custom'">
        <div class="btn-group">
          <div class="btn btn-default btn-sm" (click)="prev()">
            <i class="fa fa-angle-left text-md"></i>
          </div>
          <div class="btn btn-default btn-sm no-cursor">
            <nz-week-picker *ngIf="filters.filter.view === 'Week'" [(ngModel)]="filters.filter.endDate" [nzAllowClear]="false" (ngModelChange)="onChange($event )" [nzDisabledDate]="disabledDate"></nz-week-picker>
            <nz-month-picker *ngIf="filters.filter.view === 'Month'" [(ngModel)]="filters.filter.endDate" [nzAllowClear]="false" (ngModelChange)="onChange($event)" [nzDisabledDate]="disabledDate"></nz-month-picker>
            {{filters.filter.startDate | date : dateFormat }} - {{filters.filter.endDate | date : dateFormat}}
          </div>
          <div class="btn btn-default btn-sm" (click)="next()">
            <i class="fa fa-angle-right text-md"></i>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-lg-4 col-xl-3">
    <div class="box">
      <div class="box-header b-b">
        <h3>
          <span translate>monitor.label.runningTime</span>
        </h3>
      </div>
      <div class="box-body p-a ht-292 text-overflow">
        <div class="row">
          <div class="col-sm-12 col-md-6 text-center" [ngClass]="{'col-md-12' : runningTime.length === 1}" *ngFor="let item of runningTime">
            <div class="text-dark _600 m-t">{{item.agentId}}</div>
            <div class="flex-center">
              <mwl-gauge
                [dialStartAngle]="-90"
                [dialEndAngle]="-90.001"
                [value]="item.value"
                [label]="getValue"
                [color]="getColor"
                [animated]="true"
                [animationDuration]="1"
              >
              </mwl-gauge>
            </div>
            <i class="text-muted pos-rel t-n-12">{{'common.label.total' | translate}} <i translate [translateParams]="{count: item.hours}">monitor.label.totalDays</i></i>
          </div>
          <div class="col-md-12 text-center" *ngIf="!isLoaded">
            <div class="loading-center text-primary text ht-260">
              <div><i class="fa fa-refresh fa-lg fa-spin"></i></div>
            </div>
          </div>
          <div *ngIf="isLoaded && runningTime.length ===0" class="col-md-12 vert-middle">
            <div class="p-t-96">
              <app-empty-data></app-empty-data>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="col-lg-8 col-xl-9">
    <div class="box">
      <div class="box-header b-b">
        <h3>
          <span translate>monitor.label.statistics</span>
        </h3>
      </div>
      <div class="box-body p-a scroll-class" #chartArea [hidden]="!isLoaded || statisticsData.length ===0">
        <div class="ht-260">
          <ngx-charts-bar-vertical-2d
            [groupPadding]="groupPadding"
            [view]="view"
            [scheme]="colorScheme"
            [results]="statisticsData"
            [customColors]="customColors"
            [gradient]="true"
            [xAxis]="true"
            [noBarWhenZero]="false"
            [trimXAxisTicks]="false"
            [showYAxisLabel]="true"
            [yAxisLabel]="yAxisLabel"
            [yAxis]="true">
            <ng-template #tooltipTemplate let-model="model">
              <div class="p-a-sm text-center">
                <h6>{{model.name}}</h6>
                <div class="text-md"><i>{{model.value1}}</i></div>
              </div>
            </ng-template>
          </ngx-charts-bar-vertical-2d>
        </div>
      </div>
      <div *ngIf="!isLoaded" class="loading-center text-primary text ht-291">
        <div><i class="fa fa-refresh fa-lg fa-spin"></i></div>
      </div>
      <div *ngIf="isLoaded && statisticsData.length ===0" class="vert-middle ht-291">
        <div>
          <app-empty-data></app-empty-data>
        </div>
      </div>
    </div>
  </div>
  <div class="col-md-12">
    <div class="box">
      <div class="box-header b-b">
        <h3 translate>monitor.label.overview</h3>
      </div>
      <div class="box-tool t-9">
        <div class="inline">
          <label class="m-r pos-rel">{{'monitor.button.groupBy' | translate}}:</label>
        </div>
        <div class="inline">
          <div class="pos-rel">
            <nz-select class="select-box" [(ngModel)]="filters.filter.groupBy" (ngModelChange)="groupBy()">
              <nz-option [nzLabel]="'Controller ID'" [nzValue]="'CONTROLLERID'"></nz-option>
              <nz-option [nzLabel]="'Date'" [nzValue]="'DATE'"></nz-option>
            </nz-select>
          </div>
        </div>
      </div>
      <div class="box-body overview">
        <div class="row overflow-y" [hidden]="!isLoaded && agents.length === 0">
          <div class="col-md-12">
            <app-gantt-chart
              [dayStart]="'00:00'"
              [dayEnd]="'23:00'"
              [tasks]="agents"
              [groupBy]="filters.filter.groupBy"
              [isAgent]="true"
            ></app-gantt-chart>
          </div>
        </div>
        <div *ngIf="!isLoaded && agents.length === 0" class="loading-center text-primary text min-ht-150">
          <div><i class="fa fa-refresh fa-lg fa-spin"></i></div>
        </div>
        <div *ngIf="agents.length==0 && isLoaded" class="p-t-lg">
          <div>
            <app-empty-data></app-empty-data>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
