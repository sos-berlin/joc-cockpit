<div class="operation-status-info" *ngIf="isProcessing">
  <div id='prog-bar-cont'>
    <div id="prog-bar">
      <div id="background"></div>
    </div>
  </div>
</div>
<div>
  <div appResizable class="resizable" [height]="workflowFilters.panelSize" [workflowTab]="workflowFilters"
       id="workflowGraphId">
    <div class="overflow-y h-full">
      <div class="graph-container" [ngClass]="{'graph2': isModal}">
        <div class="inline" id="toolbar-icons">
          <ul class="nav navbar-nav navbar-nav-inline nav-active-border3 ">
            <li class="nav-item">
              <a class="nav-link" [nz-tooltip]="'workflow.button.zoomIn' | translate"
                 (click)="zoomIn()">
                <span class="nav-text"> <i nz-icon nzType="zoom-in" nzTheme="outline"></i></span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link"
                 [nz-tooltip]="'workflow.button.zoomOut' | translate" (click)="zoomOut()">
                <span class="nav-text"> <i nz-icon nzType="zoom-out" nzTheme="outline"></i></span>
              </a>
            </li>
            <li class="nav-item dropdown-separator">
              <span class="separator"></span>
            </li>
            <li class="nav-item">
              <a class="nav-link" [nz-tooltip]="'workflow.button.actual' | translate"
                 (click)="actual()">
                <span class="nav-text"> <i nz-icon nzType="fullscreen-exit" nzTheme="outline"></i></span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" [nz-tooltip]="'workflow.button.fit' | translate"
                 (click)="fit()">
                <span class="nav-text"> <i nz-icon nzType="column-width" nzTheme="outline"></i></span>
              </a>
            </li>
            <li class="nav-item dropdown-separator">
              <span class="separator"></span>
            </li>
            <li class="nav-item">
              <a class="nav-link" [nz-tooltip]="'common.button.expandDetails' | translate"
                 (click)="expandAll()">
                <span class="nav-text"> <i nz-icon nzType="plus" nzTheme="outline"></i></span>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link" [nz-tooltip]="'common.button.collapseDetails' | translate"
                 (click)="collapseAll()">
                <span class="nav-text"> <i nz-icon nzType="minus" nzTheme="outline"></i></span>
              </a>
            </li>
            <li class="nav-item dropdown-separator">
              <span class="separator"></span>
            </li>
            <li class="nav-item" [nz-tooltip]="'workflow.button.exportInPng' | translate">
              <a class="nav-link"
                 (click)="workflowService.exportInPng(workFlowJson.name, isModal)">
                <span class="nav-text">  <i nz-icon nzType="export" nzTheme="outline"></i></span>
              </a>
            </li>
          </ul>
        </div>
        <div #graph id="graph"></div>
        <!-- Creates a container for the outline -->
        <div #outlineContainer id="outlineContainer"></div>
      </div>
      <nz-dropdown-menu #menu="nzDropdownMenu">
        <ul nz-menu *ngIf="order">
          <li (click)="cancelOrder()" nz-menu-item *ngIf="permission && permission.controllerDefaults && permission.controllerDefaults.orders.cancel && order.state && (order.state._text !== 'FINISHED' && order.state._text !== 'CANCELLED')">
            <a translate>order.button.cancel</a>
          </li>
          <li nz-menu-item *ngIf="permission && permission.controllerDefaults && permission.controllerDefaults.orders.cancel && order.state && (order.state._text !== 'FINISHED' && order.state._text !== 'CANCELLED' && order.state._text !== 'SCHEDULED' && order.state._text !== 'PENDING')">
            <a (click)="cancelOrderWithKill()" translate>order.button.cancelAndKillTask</a>
          </li>
          <li (click)="suspendOrder()" nz-menu-item *ngIf="permission && permission.controllerDefaults && permission.controllerDefaults.orders.suspendResume && (order.state._text === 'RUNNING' || order.state._text === 'SCHEDULED' || order.state._text === 'PENDING' || order.state._text === 'INPROGRESS' || order.state._text === 'WAITING')">
            <a translate>order.button.suspend</a>
          </li>
          <li (click)="suspendOrderWithKill()" nz-menu-item *ngIf="permission && permission.controllerDefaults && permission.controllerDefaults.orders.suspendResume && (order.state._text === 'RUNNING' || order.state._text === 'INPROGRESS' || order.state._text === 'WAITING')">
            <a translate>order.button.suspendAndKillTask</a>
          </li>
          <li nz-menu-item *ngIf="permission && permission.controllerDefaults && permission.controllerDefaults.orders.suspendResume && (order.state._text === 'SUSPENDED' || order.state._text === 'FAILED')">
            <a (click)="resumeOrder()">{{'order.button.resume' | translate}} ..</a>
          </li>
          <li (click)="resumeOrder(true)" nz-menu-item *ngIf="permission && permission.controllerDefaults && permission.controllerDefaults.orders.suspendResume && (order.state._text === 'SUSPENDED' || order.state._text === 'FAILED')">
            <a>{{'order.button.resumeParametrized' | translate}} ..</a>
          </li>
          <li (click)="modifyOrder()" nz-menu-item *ngIf="permission && permission.controllerDefaults && permission.controllerDefaults.orders.modify && order.state && (order.state._text === 'SCHEDULED' || order.state._text === 'PENDING' || order.state._text === 'BLOCKED')">
            <a>{{'dailyPlan.button.setStartTime' | translate}} ..</a>
          </li>
          <li (click)="changeParameter()" nz-menu-item *ngIf="permission && permission.controllerDefaults && permission.controllerDefaults.orders.modify && order.state && (order.state._text === 'SCHEDULED' || order.state._text === 'PENDING' || order.state._text === 'BLOCKED')">
            <a>{{'dailyPlan.button.setParameters' | translate}} ..</a>
          </li>
          <li (click)="removeWhenTerminated()" nz-menu-item *ngIf="permission && permission.controllerDefaults && permission.controllerDefaults.orders.cancel
             && order.state && (order.state._text === 'FINISHED' || order.state._text === 'CANCELLED') && (order.positionString && !order.positionString.match('/fork'))">
            <a translate>order.button.leaveWorkflow</a>
          </li>
          <li (click)="confirmOrder()" nz-menu-item *ngIf="permission && permission.controllerDefaults && permission.controllerDefaults.orders.modify && order.state && (order.state._text === 'PROMPTING')">
            <a>{{'order.button.confirm' | translate}} ..</a>
          </li>
        </ul>
        <ul nz-menu *ngIf="job">
          <li nz-menu-item>
            <a (click)="showConfiguration(job);">
              <span translate>common.button.showConfiguration</span>
            </a>
          </li>
          <li nz-menu-item [nzDisabled]="!job.documentationName" *ngIf="job.jobName">
            <a (click)="coreService.showDocumentation(job.documentationName, preferences)">
              <span translate>common.button.viewDocumentation</span>
            </a>
          </li>
        </ul>
      </nz-dropdown-menu>
      <div [hidden]="isModal" class="rg-bottom"><span></span></div>
    </div>
  </div>
</div>
<!-- BEGIN SLIDER -->
<nz-drawer [nzVisible]="sideBar.isVisible" nzPlacement="right" (nzOnClose)="sideBar.isVisible = false">
  <ng-container *nzDrawerContent>
    <div class="close-btn" (click)="sideBar.isVisible = false"></div>
    <div class="p-l-sm p-r-sm">
      <app-order-list-sidebar [permission]="permission" [preferences]="preferences" [orderPreparation]="orderPreparation" [schedulerId]="controllerId" [orders]="sideBar.orders"></app-order-list-sidebar>
    </div>
  </ng-container>
</nz-drawer>
<!-- END SLIDER -->
