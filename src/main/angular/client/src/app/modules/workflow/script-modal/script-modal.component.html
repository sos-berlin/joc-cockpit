<div class="modal-header" [hidden]="noticeBoardNames">
  <h4 class="modal-title" >
    <span class="drag-text" translate>workflow.label.showConfiguration</span>
    @if (jobName) {
      <i>:</i>
    }
    {{jobName}}
  </h4>
  <a class="max-btn" appMaximum [codeEditor]="cm">
    <i class="fa fa-window-maximize"></i>
  </a>
  <button type="button" class="close" aria-label="Close"
          (click)="activeModal.destroy()">
    <span aria-hidden="true" class="fa fa-times-circle"></span>
  </button>
</div>
<form spellcheck="false">
  <div class="modal-body p-a" style="min-height: 112px">
    @if (this.duration) {
      <div class="col-lg-12">
        <div class="form-group row">
          <label [nzTooltipMouseEnterDelay]="0.5" [nz-tooltip]="!preferences.showTooltipInfo ? ('inventory.tooltips.workflow.duration' | translate) : ''"

                 class="col-lg-3 form-control-label" translate>workflow.label.duration
          </label>
          <div class="col-lg-8">
            <input nz-input [(ngModel)]="duration" name="name" readonly />
          </div>
        </div>
      </div>
    }
    @if (noticeBoardNames) {
      <div class="row">
        <div class="col-sm-12 text-center">
          <b class="b-b p-b-xs m-b-sm">{{type | translate}}</b>
          @if (type === 'PostNotices') {
            <div class="m-t-md">
              @for (board of noticeBoardNames; track board) {
                <div class="text-muted">
                  @if (permission.joc && permission.joc.inventory.view) {
                    <i (click)="coreService.navToInventoryTab(board, 'NOTICEBOARD');"
                       class="cursor fa fa-pencil text-hover-primary p-l-sm p-r-xs"></i>
                  }
                  <a class="text-hover-primary" (click)="coreService.showBoard(board);" >{{board}}</a>
                </div>
              }
            </div>
          }
          @if (type === 'ExpectNotices') {
            <div class="m-t-md">
              <span [innerHTML]="coreService.getHtml(noticeBoardNames, permission, workflowPath) | safeHtml"></span>
            </div>
          }
        </div>
      </div>
    }
    @if (!noticeBoardNames) {
      <div class="row">
        @if (agentName) {
          <div class="col-sm-12 m-b-10">
            <span class="_600" translate>agent.label.agentName</span>:&nbsp;
            {{agentName}}
            @if (subagentClusterId) {
              <span>
                <span class="m-l _600" translate>agent.label.subagentClusterId</span>:&nbsp;
                {{subagentClusterId}}
              </span>
            }
          </div>
        }
        @if (isScript) {
          <div class="col-md-12">
            @if (!predicate) {
              <label class="_600 m-b-xs" translate>workflow.label.script</label>
            }
            @if (predicate) {
              <label class="_600 m-b-xs" translate>workflow.label.predicate</label>
            }
            @if (permission && permission.joc.inventory.view) {
              <a class="text-hover-primary p-l-sm" (click)="navToConfig()"><i class="fa fa-pencil"></i></a>
            }
            <div class="b-a" id="resizable">
              <app-codemirror-editor #codeEditor [options]="cmOption"></app-codemirror-editor>
              <div class="rg-right" style="background: transparent; margin-right: -16px"><span style="top:48%"></span></div>
              <div class="rg-bottom" style="bottom: -16px;background: transparent"><span></span></div>
            </div>
          </div>
        }
        @if (!isScript && data) {
          <div class="col-md-12">
            <div class="form-group row">
              <label class="col-sm-3 form-control-label">{{'workflow.label.className' | translate}}
                @if (permission && permission.joc.inventory.view) {
                  <a class="text-hover-primary p-l-sm" (click)="navToConfig()"><i class="fa fa-pencil"></i></a>
                }</label>
              <div class=" col-sm-8">
                <input nz-input name="data" [(ngModel)]="data" readonly>
              </div>
            </div>
          </div>
        }
        @if (periodList.length > 0) {
          <div class="col-sm-3" translate>workflow.label.workflowTimeZone</div>
        }
        @if (periodList.length > 0) {
          <div class="col-sm-8">
            {{timezone}}
          </div>
        }
        @if (schedule) {
          <div class="col-md-12 m-t-sm">
            <label class="_600 m-b-xs" translate>workflow.label.listOfSchemes</label>
            @if (permission && permission.joc.inventory.view) {
              <a class="text-hover-primary p-l-sm" (click)="navToConfig()"><i class="fa fa-pencil"></i></a>
            }
            <div class="table-responsive">
              <table class="table table-hover table-bordered ">
                <thead>
                <tr>
                  <th style="border-right: none"><span translate>workflow.admissionTime.label.frequency</span></th>
                  <th style="border-left: none"><span translate>workflow.admissionTime.label.period</span></th>
                  <th><span translate>workflow.label.repeat</span></th>
                </tr>
                </thead>
                <tbody >
                  @for (list of schemeList; track list) {
                    <tr>
                      <td colspan="2">
                        @for (item of list.periodList; track item) {
                          <div>
                            <div class="row">
                              <div class="col-sm-5">
                                @if (item.frequency) {
                                  <span><span translate>workflow.admissionTime.label.on</span> {{item.frequency}}</span>
                                }
                                @if (!item.frequency) {
                                  <span translate>workflow.admissionTime.label.everyDay</span>
                                }
                              </div>
                              <div class="col-sm-7">
                                @for (p of item.periods; track p) {
                                  <div>
                                    <span>{{p.text}}</span>
                                  </div>
                                }
                              </div>
                            </div>
                          </div>
                        }
                      </td>
                      <td>
                        <span>{{list.repeat.text}}</span>
                      </td>
                    </tr>
                  }
                </tbody>
              </table>
            </div>
          </div>
        }
        @if (periodList.length > 0) {
          <div class="col-md-12 m-t-sm">
            <label class="_600 m-b-xs" translate>workflow.label.admissionTime</label>
            <div class="table-responsive">
              <table class="table table-hover table-bordered">
                <thead>
                <tr>
                  <th><span translate>workflow.admissionTime.label.frequency</span></th>
                  <th><span translate>workflow.admissionTime.label.period</span></th>
                </tr>
                </thead>
                <tbody>
                  @for (item of periodList; track item) {
                    <tr>
                      <td><span>On {{item.frequency}}</span></td>
                      <td>
                        @for (p of item.periods; track p) {
                          <div>
                            <span>{{p.text}}</span>
                          </div>
                        }
                      </td>
                    </tr>
                  }
                </tbody>
              </table>
            </div>
          </div>
        }
        @if (periodList.length > 0 || schemeList.length > 0) {
          <div class="col-md-12">
            @if (tempPeriodList.length === 0) {
              <button type="button" class="btn btn-default btn-sm"
                      (click)="showConvertTime()" translate>workflow.button.convertAdmissionTime
              </button>
            }
            @if (tempPeriodList.length > 0) {
              <button type="button" class="btn btn-default btn-sm"
                      (click)="showOriginalTime()" translate>workflow.button.originalAdmissionTime
              </button>
            }
          </div>
        }
      </div>
    }
  </div>
  <div class="modal-footer" [hidden]="noticeBoardNames">
    <button type="button" class="btn btn-grey btn-sm"
            (click)="activeModal.destroy()" translate>
      common.button.close
    </button>
    @if (data) {
      <button type="button" class="btn btn-default btn-sm"
              (click)="copyToClipboard()" translate>log.button.copyToClipboard
      </button>
    }
  </div>
</form>
