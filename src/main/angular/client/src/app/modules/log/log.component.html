<div class="white box-shadow sub-header">
  <div class="row">
    <div class="col-md-12">
      <div class="padding">
        <div class="text-right">
          <div class="pull-left">
                        <span class="text-md _600 pos-rel t-xs" translate>
                          log.label.logs
                        </span>
          </div>
          <button (click)="copy()" class="btn btn-sm btn-grey m-l-12" translate type="button">
            <i class="fa fa-copy"></i>&nbsp;
            log.button.copyToClipboard
          </button>
          <button (click)="downloadLog()" class="btn btn-grey btn-sm m-l-12" type="button">
            <i class="fa fa-download"></i>&nbsp;
            <span translate>common.button.download</span>
          </button>
          <button (click)="reloadLog()" *ngIf="finished || isCancel" class="btn btn-grey btn-sm m-l-12" type="button">
            <i class="fa fa-refresh"></i>&nbsp;
            <span translate>workflow.button.reload</span>
          </button>
          <button (click)="cancel()" *ngIf="!isCancel && !finished" class="btn btn-grey btn-sm m-l-12" type="button">
            <i class="fa fa-times"></i>&nbsp;
            <span translate>common.button.cancel</span>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
<div id="log-body">
  <div class="padding p-b-0">
    <div class="row m-t-xs">
      <div class="col-md-12">
        <h5 class="_300 m-t-sm">
          <span *ngIf="orderId">{{workflow}} - <i class="text-muted">{{orderId}}</i></span>
          <span *ngIf="taskId"><span *ngIf="job">{{job}} </span> <span *ngIf="!job"
                                                                       translate>common.label.taskId </span> - <i
            class="text-muted">{{taskId}}</i></span>
        </h5>
      </div>
    </div>
    <div *ngIf="!error" class="row m-t-sm">
      <div class="col-sm-12">
        <span *ngIf="isExpandCollapse" class="m-r">
          <a (click)="expandAll();" [nz-tooltip]="'common.tooltip.expandAll' | translate" class="text">
            <i class="fa fa-angle-double-down fa-lg"></i>
          </a>
          <a (click)="collapseAll();" [nz-tooltip]="'common.tooltip.collapseAll' | translate" class="text m-l-sm">
            <i class="fa fa-angle-double-up fa-lg"></i>
          </a>
        </span>
        <label (ngModelChange)="checkLogLevel('MAIN')" [(ngModel)]="object.checkBoxs.main" class="m-r" nz-checkbox><span
          translate>log.label.main</span></label>
        <label (ngModelChange)="checkLogLevel('SUCCESS')" *ngIf="isStdSuccessLevel" [(ngModel)]="object.checkBoxs.success" class="m-r"
               nz-checkbox><span translate>log.label.success</span></label>
        <label (ngModelChange)="checkLogLevel('STDOUT')" [(ngModel)]="object.checkBoxs.stdout" class="m-r"
               nz-checkbox><span translate>log.label.stdout</span></label>
        <label (ngModelChange)="checkLogLevel('STDERR')" *ngIf="isStdErrLevel" [(ngModel)]="object.checkBoxs.stderr" class="m-r"
               nz-checkbox><span translate>log.label.stderr</span></label>
        <label (ngModelChange)="checkLogLevel('INFO')" *ngIf="isInfoLevel" [(ngModel)]="object.checkBoxs.info" class="m-r"
               nz-checkbox><span translate>log.label.info</span></label>
        <label (ngModelChange)="checkLogLevel('FATAL')" *ngIf="isFatalLevel" [(ngModel)]="object.checkBoxs.fatal" class="m-r"
               nz-checkbox><span translate>log.label.fatal</span></label>
        <label (ngModelChange)="checkLogLevel('ERROR')" *ngIf="isErrorLevel" [(ngModel)]="object.checkBoxs.error" class="m-r"
               nz-checkbox><span translate>log.label.error</span></label>
        <label (ngModelChange)="checkLogLevel('WARN')" *ngIf="isWarnLevel" [(ngModel)]="object.checkBoxs.warn" class="m-r"
               nz-checkbox><span translate>log.label.warn</span></label>
        <label (ngModelChange)="checkLogLevel('DEBUG')" [(ngModel)]="object.checkBoxs.debug" class="m-r"
               nz-checkbox><span translate>log.label.debug</span></label>
        <label (ngModelChange)="checkLogLevel('TRACE')" *ngIf="isTraceLevel" [(ngModel)]="object.checkBoxs.trace" class="m-r"
               nz-checkbox><span translate>log.label.trace</span></label>
        <label (ngModelChange)="checkLogLevel('DETAIL')" *ngIf="isDetailLevel" [(ngModel)]="object.checkBoxs.detail" class="m-r"
               nz-checkbox><span translate>log.label.detail</span></label>
      </div>
    </div>
    <div class="row m-t-sm">
      <div class="col-md-12">
        <div class="box white">
          <div class="box-body p-a-0">

            <pre #dataBody (scroll)="onScroll($event)" *ngIf="!error" class="log p-r-sm p-b-sm p-t-sm " id="logs"></pre>
            <div *ngIf="error" class="log text-center p-b-md">
              <div class="text-dark p-t text-38 m-b-n-8"><span [innerHtml]="errStatus"></span></div>
              <div *ngIf="errStatus" class="text-lg text-muted">{{'log.label.error' | translate}}!</div>
              <div [innerHtml]="error" class="text m-t"></div>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- BEGIN SLIDER -->
<div class="property-panel hidden-sm">
  <div class="sidebar-open">
    <i class="fa fa-caret-left"></i>
  </div>
  <div class="sidebar-close">
    <i class="fa fa-caret-right"></i>
  </div>
  <div class="sidebar sidebar-property-panel bg-white" id="property-panel">
    <div class="m-l-xs m-r-xs">
      <div style="padding: 12px">
        <div *ngIf="isChildren" class="m-l m-b-xs">
          <a (click)="expandAllTree();" class="text-primary-hover">
            <i class="fa fa-angle-double-down fa-lg"></i>
          </a>
          <a (click)="collapseAllTree();" class="m-l-sm text-primary-hover">
            <i class="fa fa-angle-double-up fa-lg"></i>
          </a>
        </div>
        <div class="fade-in">
          <nz-tree
            [nzData]="nodes"
            [nzShowExpand]="false"
            [nzTreeTemplate]="nzTreeTemplate"
          ></nz-tree>
          <ng-template #nzTreeTemplate let-node>
            <div class="node-wrapper" id="{{node.origin.key}}">
              <span (click)="openFolder(node)" *ngIf="(node.origin.children && node.origin.children.length > 0)"
                    [class.toggle-children-wrapper-collapsed]="!node.isExpanded"
                    [class.toggle-children-wrapper-expanded]="node.isExpanded"
                    class="cursor w-14 m-l-xxs m-t-n-1">
                  <i *ngIf="!node.isExpanded && !node.origin.loading" class="fa fa-caret-right"></i>
                  <i *ngIf="node.isExpanded && !node.origin.loading" class="fa fa-caret-down"></i>
              </span>
              <span *ngIf="node.origin.isLeaf || (!node.origin.children || node.origin.children.length === 0)"
                    class="w-16">
                  <span class="fa fa-lg p-r-sm"></span>
              </span>
              <div (click)="selectNode(node)" class="node-content-wrapper">
                <span *ngIf="node.origin.name">{{node.origin.name}}</span>
                <span *ngIf="node.origin.end" class="_600">{{node.origin.end | translate}}</span>
                <span *ngIf="!node.origin.end && !node.origin.name"
                      class="_600">{{node.origin.title | translate}}</span>
                <span *ngIf="!node.origin.end && !node.origin.name && !node.origin.title"
                      class="text-muted">{{node.origin.logEvent}}</span>
                <i *ngIf="node.origin.name1" class="text-primary">&nbsp;({{node.origin.name1}})</i>
                <i *ngIf="node.origin.retryCount > 1 && node.origin.title == 'Retry'" class="text-primary">&nbsp;(Total
                  Tries {{node.origin.retryCount}})</i>
                <span *ngIf="node.origin.logLevel == 'ERROR'">
                    - (<i class="text-sm log_error">Failed</i>)
                  </span>
              </div>
            </div>
          </ng-template>
        </div>

      </div>
    </div>
  </div>
</div>
<div *ngIf="loading || isLoading" class="spinner">
  <div class="cssload-inner cssload-one"></div>
  <div class="cssload-inner cssload-two"></div>
  <div class="cssload-inner cssload-three"></div>
</div>
