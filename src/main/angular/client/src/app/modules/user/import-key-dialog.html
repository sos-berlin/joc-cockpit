<div class="modal-header">
  <h4 class="modal-title">
    <span *ngIf="type !== 'certificate' && type !== 'encipherment' && (securityLevel !== 'HIGH' || (securityLevel ==='HIGH' && type === 'ca'))"
          translate>profile.keyManagement.label.importPrivateKey</span>
    <span *ngIf="type !== 'certificate' && type !== 'encipherment' && securityLevel ==='HIGH' && type !== 'ca'" translate>profile.keyManagement.label.importPublicKey</span>
    <span *ngIf="type === 'certificate'" translate>profile.keyManagement.label.importCertificate</span>
    <span *ngIf="type === 'encipherment'" translate>profile.encipherment.label.importCertificate</span>
  </h4>
  <button (click)="activeModal.destroy()" aria-label="Close" class="close" type="button">
    <span aria-hidden="true" class="fa fa-times-circle"></span>
  </button>
</div>
<form #myForm="ngForm">
  <div class="modal-body p-a min-ht-300">
    <div class="row">
      <div [ngClass]="{'show': display}" class="col-md-12 hide">
        <app-audit-log-input [comments]="comments" [sizeX]="3" [sizeY]="9"></app-audit-log-input>
      </div>
      <div *ngIf="type !== 'certificate' && type !== 'encipherment'" class="col-md-12">
        <div class="form-group row">
          <div class="col-md-4 col-lg-3" translate>profile.keyManagement.label.keyAlgorithm</div>
          <div class="col-md-8 col-lg-9">
            <nz-radio-group [(ngModel)]="key.keyAlg" name="alg">
              <label *ngIf="type === 'key'" nz-radio nzValue="PGP"><span
                translate>profile.keyManagement.label.pgp</span></label>
              <label *ngIf="type === 'key'" nz-radio nzValue="RSA"><span
                translate>profile.keyManagement.label.rsa</span></label>
              <label nz-radio nzValue="ECDSA"><span translate>profile.keyManagement.label.ecdsa</span></label>
            </nz-radio-group>
          </div>
        </div>
      </div>
    </div>
    <div *ngIf="type === 'encipherment'">
      <div [ngClass]="{'has-error' : ((certAlias.dirty || certAlias.touched) && certAlias.invalid)}"
          class="form-group row">
        <label class="col-sm-4 form-control-label" translate>profile.encipherment.label.certAlias
          <sup class="text-danger text-sm">*</sup>
        </label>
        <div class="col-sm-6">
          <input #certAlias="ngModel" [(ngModel)]="certificateObj.certAlias" [appAutofocus]="true" autocomplete="off" class="form-control"
                name="certAlias" required type="text"  placeholder="{{'profile.encipherment.placeholder.certAlias' | translate}}" (blur)="onFieldBlur()" />
          <div *ngIf="certAlias.invalid && (certAlias.dirty || certAlias.touched)" class="text-danger help-block">
            <div *ngIf="certAlias.errors.required">
              <div translate>common.message.requiredError</div>
            </div>
          </div>
        </div>
      </div>
      <div [ngClass]="{'has-error' : ((privateKeyPath.dirty || privateKeyPath.touched) && privateKeyPath.invalid)}"
          class="form-group row">
        <label class="col-sm-4 form-control-label" translate>profile.encipherment.label.privateKeyPath
        </label>
        <div class="col-sm-6">
          <input #privateKeyPath="ngModel" [(ngModel)]="certificateObj.privateKeyPath" autocomplete="off" class="form-control"
                name="privateKeyPath" type="text"  placeholder="{{'profile.encipherment.placeholder.privateKeyPath' | translate}}" (blur)="onFieldBlur()" />
          <div *ngIf="privateKeyPath.invalid && (privateKeyPath.dirty || privateKeyPath.touched)" class="text-danger help-block">
            <div *ngIf="privateKeyPath.errors.required">
              <div translate>common.message.requiredError</div>
            </div>
          </div>
        </div>
      </div>
      <div class="form-group row" [ngClass]="{'has-error' : ((jobResourceFolder.dirty || jobResourceFolder.touched) && jobResourceFolder.invalid)}">
        <label class="col-sm-4 form-control-label" translate>profile.encipherment.label.jobResourceFolder
          <sup class="text-danger text-sm">*</sup>
        </label>
        <div class="col-sm-6">
          <input #jobResourceFolder="ngModel" (click)="isTreeShow = true;" [(ngModel)]="certificateObj.jobResourceFolder" autocomplete="off" class="form-control"
          name="jobResourceFolder" type="text"  placeholder="{{'profile.encipherment.placeholder.jobResourceFolder' | translate}}">
          <div *ngIf="isTreeShow" [ngStyle]="{'margin-top': '-29px'}" class="z-index-9999 w-full">
            <app-search-input (onBlur)="onBlur();" (onSelect)="onChangeJobResource($event, certificateObj)" [isDisplay]="true"
            [nodes]="jobResourcesTree" [type]="'JOBRESOURCE'"></app-search-input>
          </div>
          <div *ngIf="jobResourceFolder.invalid && (jobResourceFolder.dirty || jobResourceFolder.touched)" class="text-danger help-block">
            <div *ngIf="jobResourceFolder.errors.required">
              <div translate>common.message.requiredError</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <nz-upload
      [(nzFileList)]="fileList"
      [nzBeforeUpload]="beforeUpload"
      [nzShowButton]="fileList.length === 0"
      [nzType]="fileList.length > 0 ? null : 'drag'"
      nzListType="picture"
      [nzMultiple]="true"
      [nzLimit]="2"
    >
      <div *ngIf="fileList.length === 0">
        <i class="icon-upload-icon"></i>
        <div class="upload-text" translate>common.button.dragAndDropFileToUpload</div>
      </div>
    </nz-upload>
    <div class="process-container" *ngIf="showProgressBar">
      <div class="upload-progress-bar">
        <div class="progress-bar-value" [ngClass]="{'success': !uploading}"></div>
      </div>
    </div>
    <nz-upload *ngIf="fileList.length === 0" [nzLimit]="2" [nzMultiple]="true"
               [nzBeforeUpload]="beforeUpload">
      <div class="p-t-sm">
        <button class="btn btn-default btn-sm" type="button">
          <i nz-icon nzTheme="outline" nzType="upload"></i>&nbsp;
          <span translate>common.button.chooseFileToUpload</span>
        </button>
      </div>
    </nz-upload>
  </div>
  <div *ngIf="fileList.length > 0 && !isEnciphermentForm" class="modal-footer">
    <button (click)="import()" [disabled]="submitted || uploading || (required && !comments.comment)"
            class="btn btn-primary btn-sm" type="submit">
      <i *ngIf="uploading" class="fa fa-spin fa-spinner p-r-xs"></i>
      {{'common.button.import' | translate}}
    </button>
    <button (click)="cancel()" class="btn btn-grey btn-sm" translate type="button">
      common.button.cancel
    </button>
  </div>
</form>
