<div class="btn-group dropdown">
  <button (nzVisibleChange)="change($event)" [disabled]="isDisabled" [nzDropdownMenu]="option" class="btn-drop more-option-h" nz-dropdown
          nzTrigger="click" type="button">
    <i class="fa fa-ellipsis-h"></i>
  </button>
  <nz-dropdown-menu #option="nzDropdownMenu" role="menu">
    <ul nz-menu>
      <li (click)="cancelOrder(order)" *ngIf="permission && permission.currentController && permission.currentController.orders.cancel && order.state && (order.state._text !== 'FINISHED' && order.state._text !== 'CANCELLED')"
          nz-menu-item>
        <a translate>order.button.cancel</a>
      </li>
      <li (click)="cancelOrderWithKill()" *ngIf="permission && permission.currentController && permission.currentController.orders.cancel && order.state && (order.state._text === 'RUNNING')"
          nz-menu-item>
        <a translate>order.button.cancelAndKillTask</a>
      </li>
      <li (click)="deepCancel()" *ngIf="order.hasChildOrders && permission && permission.currentController && permission.currentController.orders.cancel && order.state && (order.state._text !== 'FINISHED' && order.state._text !== 'CANCELLED')"
          nz-menu-item>
        <a translate>order.button.deepCancel</a>
      </li>
      <li (click)="cancelOrderWithKill(true)" *ngIf="order.hasChildOrders && permission && permission.currentController && permission.currentController.orders.cancel && order.state && (order.state._text !== 'FINISHED' && order.state._text !== 'CANCELLED')"
          nz-menu-item>
        <a translate>order.button.deepCancelAndKillTask</a>
      </li>
      <li (click)="suspendOrder(order)" *ngIf="permission && permission.currentController && permission.currentController.orders.suspendResume && (order.state._text === 'RUNNING' || order.state._text === 'SCHEDULED' || order.state._text === 'PENDING'
       || order.state._text === 'INPROGRESS' || order.state._text === 'PROMPTING' || order.state._text === 'WAITING')" nz-menu-item>
        <a translate>order.button.suspend</a>
      </li>
      <li (click)="suspendOrderWithKill()" *ngIf="permission && permission.currentController && permission.currentController.orders.suspendResume && (order.state._text === 'RUNNING')"
          nz-menu-item>
        <a translate>order.button.suspendAndKillTask</a>
      </li>
      <li (click)="deepSuspend()" *ngIf="order.hasChildOrders && permission && permission.currentController && permission.currentController.orders.suspendResume && (order.state._text === 'RUNNING' || order.state._text === 'SCHEDULED' || order.state._text === 'PENDING'
       || order.state._text === 'INPROGRESS' || order.state._text === 'PROMPTING' || order.state._text === 'WAITING')" nz-menu-item>
        <a translate>order.button.deepSuspend</a>
      </li>
      <li (click)="suspendOrderWithKill(true)" *ngIf="order.hasChildOrders && permission && permission.currentController && permission.currentController.orders.suspendResume && (order.state._text === 'RUNNING' || order.state._text === 'SCHEDULED' || order.state._text === 'PENDING'
       || order.state._text === 'INPROGRESS' || order.state._text === 'PROMPTING' || order.state._text === 'WAITING')" nz-menu-item>
        <a translate>order.button.deepSuspendAndKillTask</a>
      </li>
      <li (click)="resumeOrder()" *ngIf="permission && permission.currentController && permission.currentController.orders.suspendResume && (order.state._text === 'SUSPENDED' || order.state._text === 'FAILED')"
          nz-menu-item>
        <a>{{'order.button.resume' | translate}} ..</a>
      </li>
      <li (click)="modifyOrder(order)" *ngIf="!order.positionIsImplicitEnd && permission && permission.currentController && permission.currentController.orders.modify && order.state && (order.state._text === 'SCHEDULED' || order.state._text === 'PENDING' || order.state._text === 'BLOCKED')"
          nz-menu-item>
        <a>{{'dailyPlan.button.setStartTime' | translate}} ..</a>
      </li>
      <li (click)="changeParameter(order)" *ngIf="!order.positionIsImplicitEnd && permission && permission.currentController && permission.currentController.orders.modify && order.state && (order.state._text === 'SCHEDULED' || order.state._text === 'PENDING' || order.state._text === 'BLOCKED')"
          nz-menu-item>
        <a>{{'dailyPlan.button.setParameters' | translate}} ..</a>
      </li>
      <li (click)="removeWhenTerminated()" *ngIf="!order.positionIsImplicitEnd && permission && permission.currentController && permission.currentController.orders.cancel
       && order.state && (order.state._text === 'FINISHED' || order.state._text === 'CANCELLED') && (order.positionString && !order.positionString.match('/fork'))" nz-menu-item>
        <a translate>order.button.leaveWorkflow</a>
      </li>
      <li (click)="confirmOrder()" *ngIf="permission && permission.currentController && permission.currentController.orders.modify && order.state && (order.state._text === 'PROMPTING')"
          nz-menu-item>
        <a>{{'order.button.confirm' | translate}} ..</a>
      </li>
      <li *ngIf="order.state && (order.state._text !== 'SCHEDULED' && order.state._text !== 'PENDING')"
          nz-menu-divider></li>
      <li (click)="showLog(order)" *ngIf="order.state && (order.state._text !== 'SCHEDULED' && order.state._text !== 'PENDING')"
          nz-menu-item>
        <a>{{'order.button.showLog' | translate}}</a>
      </li>
      <li (click)="coreService.copyLink('order',order.orderId, order.workflowId.path)" nz-menu-item>
        <a translate>common.button.copyLinkToObject</a>
      </li>
    </ul>
  </nz-dropdown-menu>
</div>
